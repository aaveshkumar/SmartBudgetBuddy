{"file_contents":{"app/views/employer/jobs.php":{"content":"<?php\n$meta = generateMetaTags('My Jobs', 'View and manage your job postings');\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container\">\n    <h1 class=\"mb-4\">My Jobs</h1>\n    \n    <?php if ($success = getFlash('success')): ?>\n        <div class=\"alert alert-success\"><?= $success ?></div>\n    <?php endif; ?>\n    \n    <div class=\"card\">\n        <div class=\"card-body\">\n            <div class=\"table-responsive\">\n                <table class=\"table table-striped\">\n                    <thead>\n                        <tr>\n                            <th>Title</th>\n                            <th>Location</th>\n                            <th>Type</th>\n                            <th>Status</th>\n                            <th>Posted</th>\n                            <th>Actions</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <?php foreach ($jobs as $job): ?>\n                        <tr>\n                            <td><?= htmlspecialchars($job['title']) ?></td>\n                            <td><?= htmlspecialchars($job['location']) ?></td>\n                            <td><span class=\"badge bg-info\"><?= $job['type'] ?></span></td>\n                            <td>\n                                <span class=\"badge bg-<?= $job['status'] === 'Approved' ? 'success' : ($job['status'] === 'Pending' ? 'warning' : 'danger') ?>\">\n                                    <?= $job['status'] ?>\n                                </span>\n                            </td>\n                            <td><?= formatDate($job['created_at']) ?></td>\n                            <td>\n                                <a href=\"/employer/jobs/<?= $job['id'] ?>/applications\" class=\"btn btn-sm btn-primary\">Applications</a>\n                                <?php if ($job['status'] === 'Approved'): ?>\n                                    <a href=\"/jobs/<?= $job['id'] ?>\" class=\"btn btn-sm btn-info\" target=\"_blank\">View</a>\n                                <?php endif; ?>\n                                <form action=\"/employer/jobs/<?= $job['id'] ?>/delete\" method=\"POST\" class=\"d-inline\" onsubmit=\"return confirm('Are you sure?')\">\n                                    <?= csrfField() ?>\n                                    <button type=\"submit\" class=\"btn btn-sm btn-danger\">Delete</button>\n                                </form>\n                            </td>\n                        </tr>\n                        <?php endforeach; ?>\n                    </tbody>\n                </table>\n            </div>\n        </div>\n    </div>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":2667,"size_tokens":null},"config/constants.php":{"content":"<?php\n/**\n * Application Constants\n */\n\n// User Types\ndefine('USER_TYPE_JOBSEEKER', 'jobseeker');\ndefine('USER_TYPE_EMPLOYER', 'employer');\ndefine('USER_TYPE_ADMIN', 'admin');\n\n// Job Types\ndefine('JOB_TYPE_FULLTIME', 'Full-time');\ndefine('JOB_TYPE_PARTTIME', 'Part-time');\ndefine('JOB_TYPE_CONTRACT', 'Contract');\ndefine('JOB_TYPE_INTERNSHIP', 'Internship');\n\n// Job Status\ndefine('JOB_STATUS_PENDING', 'Pending');\ndefine('JOB_STATUS_APPROVED', 'Approved');\ndefine('JOB_STATUS_REJECTED', 'Rejected');\n\n// Pagination\ndefine('JOBS_PER_PAGE', 20);\ndefine('APPLICATIONS_PER_PAGE', 20);\n\n// SEO\ndefine('META_DESCRIPTION_LENGTH', 155);\ndefine('META_TITLE_LENGTH', 60);\n\n// Error Messages\ndefine('ERROR_INVALID_CREDENTIALS', 'Invalid email or password');\ndefine('ERROR_EMAIL_EXISTS', 'Email already registered');\ndefine('ERROR_UNAUTHORIZED', 'Unauthorized access');\ndefine('ERROR_INVALID_FILE', 'Invalid file type or size');\n\n// Success Messages\ndefine('SUCCESS_REGISTER', 'Registration successful! Please login.');\ndefine('SUCCESS_LOGIN', 'Login successful!');\ndefine('SUCCESS_JOB_POSTED', 'Job posted successfully and pending approval');\ndefine('SUCCESS_APPLICATION', 'Application submitted successfully');\n\n// Upload Paths (relative to public directory)\ndefine('RESUME_UPLOAD_PATH', __DIR__ . '/../public/uploads/resumes/');\ndefine('PROFILE_UPLOAD_PATH', __DIR__ . '/../public/uploads/profiles/');\ndefine('LOGO_UPLOAD_PATH', __DIR__ . '/../public/uploads/logos/');\n","path":null,"size_bytes":1462,"size_tokens":null},"app/controllers/AdminController.php":{"content":"<?php\n/**\n * Admin Controller\n */\n\nrequire_once __DIR__ . '/../../config/database.php';\nrequire_once __DIR__ . '/../../config/constants.php';\nrequire_once __DIR__ . '/../../includes/functions.php';\nrequire_once __DIR__ . '/../../includes/csrf.php';\nrequire_once __DIR__ . '/../../app/models/User.php';\nrequire_once __DIR__ . '/../../app/models/Job.php';\nrequire_once __DIR__ . '/../../app/models/Application.php';\nrequire_once __DIR__ . '/../../app/models/JobSeekerProfile.php';\nrequire_once __DIR__ . '/../../app/models/Notification.php';\nrequire_once __DIR__ . '/../../app/models/Report.php';\n\nclass AdminController {\n    private $userModel;\n    private $jobModel;\n    private $applicationModel;\n    private $profileModel;\n    private $reportModel;\n    \n    public function __construct() {\n        requireRole(USER_TYPE_ADMIN);\n        \n        $this->userModel = new User();\n        $this->jobModel = new Job();\n        $this->applicationModel = new Application();\n        $this->profileModel = new JobSeekerProfile();\n        $this->reportModel = new Report();\n    }\n    \n    // View and filter candidates\n    public function candidates() {\n        $filters = [];\n        \n        if (!empty($_GET['city'])) {\n            $filters['city'] = sanitize($_GET['city']);\n        }\n        \n        if (!empty($_GET['state'])) {\n            $filters['state'] = sanitize($_GET['state']);\n        }\n        \n        if (!empty($_GET['skill'])) {\n            $filters['skill'] = sanitize($_GET['skill']);\n        }\n        \n        if (!empty($_GET['min_experience'])) {\n            $filters['min_experience'] = (int)$_GET['min_experience'];\n        }\n        \n        if (!empty($_GET['max_experience'])) {\n            $filters['max_experience'] = (int)$_GET['max_experience'];\n        }\n        \n        if (!empty($_GET['availability'])) {\n            $filters['availability'] = sanitize($_GET['availability']);\n        }\n        \n        $candidates = $this->profileModel->searchCandidates($filters);\n        \n        require __DIR__ . '/../views/admin/candidates.php';\n    }\n    \n    // View candidate full profile\n    public function viewCandidate($userId) {\n        $user = $this->userModel->findById($userId);\n        \n        if (!$user || $user['type'] !== USER_TYPE_JOBSEEKER) {\n            setFlash('error', 'Candidate not found');\n            redirect('/admin/candidates');\n        }\n        \n        $data = $this->profileModel->getCompleteProfile($userId);\n        $data['user'] = $user;\n        \n        require __DIR__ . '/../views/admin/candidate_profile.php';\n    }\n    \n    // Admin dashboard\n    public function dashboard() {\n        $stats = [\n            'total_users' => $this->userModel->count(),\n            'jobseekers' => $this->userModel->count(['type' => USER_TYPE_JOBSEEKER]),\n            'employers' => $this->userModel->count(['type' => USER_TYPE_EMPLOYER]),\n            'total_jobs' => $this->jobModel->count(),\n            'pending_jobs' => $this->jobModel->count(['status' => JOB_STATUS_PENDING]),\n            'approved_jobs' => $this->jobModel->count(['status' => JOB_STATUS_APPROVED]),\n        ];\n        \n        $recentJobs = $this->jobModel->getAll(['limit' => 10]);\n        \n        require __DIR__ . '/../views/admin/dashboard.php';\n    }\n    \n    // Manage users\n    public function users() {\n        $page = isset($_GET['page']) ? (int)$_GET['page'] : 1;\n        $filters = [\n            'limit' => 20,\n            'offset' => ($page - 1) * 20\n        ];\n        \n        if (!empty($_GET['type'])) {\n            $filters['type'] = sanitize($_GET['type']);\n        }\n        \n        if (!empty($_GET['search'])) {\n            $filters['search'] = sanitize($_GET['search']);\n        }\n        \n        $users = $this->userModel->getAll($filters);\n        $totalUsers = $this->userModel->count($filters);\n        $pagination = paginate($totalUsers, 20, $page);\n        \n        require __DIR__ . '/../views/admin/users.php';\n    }\n    \n    // View user details\n    public function viewUser($id) {\n        $user = $this->userModel->findById($id);\n        \n        if (!$user) {\n            setFlash('error', 'User not found');\n            redirect('/admin/users');\n        }\n        \n        require __DIR__ . '/../views/admin/view_user.php';\n    }\n    \n    // Update user\n    public function updateUser($id) {\n        checkCSRF();\n        \n        $user = $this->userModel->findById($id);\n        if (!$user) {\n            setFlash('error', 'User not found');\n            redirect('/admin/users');\n        }\n        \n        $errors = [];\n        $data = [];\n        \n        // Validate name\n        if (empty($_POST['name'])) {\n            $errors[] = 'Name is required';\n        } else {\n            $data['name'] = sanitize($_POST['name']);\n        }\n        \n        // Validate email\n        if (empty($_POST['email'])) {\n            $errors[] = 'Email is required';\n        } else {\n            $email = sanitize($_POST['email']);\n            if (!filter_var($email, FILTER_VALIDATE_EMAIL)) {\n                $errors[] = 'Invalid email address';\n            } elseif ($this->userModel->emailExists($email, $id)) {\n                $errors[] = 'Email already exists';\n            } else {\n                $data['email'] = $email;\n            }\n        }\n        \n        // Update type if provided\n        if (!empty($_POST['type']) && in_array($_POST['type'], ['admin', 'employer', 'jobseeker'])) {\n            $data['type'] = sanitize($_POST['type']);\n        }\n        \n        // Update verified status if provided\n        if (isset($_POST['verified'])) {\n            $data['verified'] = (int)$_POST['verified'];\n        }\n        \n        // Update password if provided\n        if (!empty($_POST['password'])) {\n            if (strlen($_POST['password']) < 6) {\n                $errors[] = 'Password must be at least 6 characters';\n            } else {\n                $data['password'] = $_POST['password'];\n            }\n        }\n        \n        if (!empty($errors)) {\n            setFlash('error', implode(', ', $errors));\n            redirect(\"/admin/users/$id\");\n            return;\n        }\n        \n        if ($this->userModel->update($id, $data)) {\n            setFlash('success', 'User updated successfully');\n        } else {\n            setFlash('error', 'Failed to update user');\n        }\n        \n        redirect('/admin/users');\n    }\n    \n    // Delete user\n    public function deleteUser($id) {\n        checkCSRF();\n        \n        if ($this->userModel->delete($id)) {\n            setFlash('success', 'User deleted successfully');\n        } else {\n            setFlash('error', 'Failed to delete user');\n        }\n        \n        redirect('/admin/users');\n    }\n    \n    // Manage jobs\n    public function jobs() {\n        $page = isset($_GET['page']) ? (int)$_GET['page'] : 1;\n        $filters = [\n            'limit' => 20,\n            'offset' => ($page - 1) * 20\n        ];\n        \n        if (!empty($_GET['status'])) {\n            $filters['status'] = sanitize($_GET['status']);\n        }\n        \n        $jobs = $this->jobModel->getAll($filters);\n        $totalJobs = $this->jobModel->count($filters);\n        $pagination = paginate($totalJobs, 20, $page);\n        \n        require __DIR__ . '/../views/admin/jobs.php';\n    }\n    \n    // View single job (admin can view regardless of status)\n    public function viewJob($id) {\n        $job = $this->jobModel->findById($id);\n        \n        if (!$job) {\n            setFlash('error', 'Job not found');\n            redirect('/admin/jobs');\n        }\n        \n        require __DIR__ . '/../views/admin/view_job.php';\n    }\n    \n    // Approve job\n    public function approveJob($id) {\n        checkCSRF();\n        \n        if ($this->jobModel->update($id, ['status' => JOB_STATUS_APPROVED])) {\n            // Get job details for notification\n            $job = $this->jobModel->findById($id);\n            if ($job) {\n                // Send notification to all job seekers about the new job\n                $notificationModel = new Notification();\n                $jobSeekers = $notificationModel->getJobSeekersByRole();\n                $employer = $this->userModel->findById($job['employer_id']);\n                $companyName = $employer ? $employer['name'] : 'A company';\n                \n                foreach ($jobSeekers as $jobSeekerId) {\n                    $notificationModel->notifyNewJob($jobSeekerId, $job['id'], $job['title'], $companyName);\n                }\n            }\n            setFlash('success', 'Job approved successfully. All job seekers have been notified.');\n        } else {\n            setFlash('error', 'Failed to approve job');\n        }\n        \n        redirect('/admin/jobs');\n    }\n    \n    // Reject job\n    public function rejectJob($id) {\n        checkCSRF();\n        \n        if ($this->jobModel->update($id, ['status' => JOB_STATUS_REJECTED])) {\n            setFlash('success', 'Job rejected successfully');\n        } else {\n            setFlash('error', 'Failed to reject job');\n        }\n        \n        redirect('/admin/jobs');\n    }\n    \n    // Delete job\n    public function deleteJob($id) {\n        checkCSRF();\n        \n        if ($this->jobModel->delete($id)) {\n            setFlash('success', 'Job deleted successfully');\n        } else {\n            setFlash('error', 'Failed to delete job');\n        }\n        \n        redirect('/admin/jobs');\n    }\n    \n    // Show system notifications page\n    public function notifications() {\n        $notificationModel = new Notification();\n        $systemNotifications = $notificationModel->getSystemNotifications();\n        \n        $meta = generateMetaTags('System Notifications', 'Send notifications to users');\n        require __DIR__ . '/../views/admin/notifications.php';\n    }\n    \n    // Send system notification to employers\n    public function sendSystemNotification() {\n        checkCSRF();\n        \n        $title = sanitize($_POST['title'] ?? '');\n        $message = sanitize($_POST['message'] ?? '');\n        $targetRole = sanitize($_POST['target_role'] ?? 'employer');\n        \n        if (empty($title) || empty($message)) {\n            setFlash('error', 'Title and message are required');\n            redirect('/admin/notifications');\n        }\n        \n        $notificationModel = new Notification();\n        $count = 0;\n        \n        if ($targetRole === 'employer' || $targetRole === 'all') {\n            $employers = $notificationModel->getEmployersByRole();\n            foreach ($employers as $employerId) {\n                $notificationModel->notifySystemUpdate($employerId, $title, $message);\n                $count++;\n            }\n        }\n        \n        if ($targetRole === 'jobseeker' || $targetRole === 'all') {\n            $jobSeekers = $notificationModel->getJobSeekersByRole();\n            foreach ($jobSeekers as $jobSeekerId) {\n                $notificationModel->notifySystemUpdate($jobSeekerId, $title, $message);\n                $count++;\n            }\n        }\n        \n        setFlash('success', \"System notification sent to $count users successfully!\");\n        redirect('/admin/notifications');\n    }\n    \n    // Delete system notification\n    public function deleteSystemNotification() {\n        checkCSRF();\n        \n        $title = $_POST['title'] ?? '';\n        $message = $_POST['message'] ?? '';\n        \n        if (empty($title) || empty($message)) {\n            setFlash('error', 'Invalid notification data');\n            redirect('/admin/notifications');\n        }\n        \n        $notificationModel = new Notification();\n        if ($notificationModel->deleteSystemNotificationsByContent($title, $message)) {\n            setFlash('success', 'Notification deleted successfully');\n        } else {\n            setFlash('error', 'Failed to delete notification');\n        }\n        \n        redirect('/admin/notifications');\n    }\n    \n    // View all reports\n    public function reports() {\n        $status = sanitize($_GET['status'] ?? '');\n        $reports = $this->reportModel->getAll($status ?: null);\n        $statusCounts = $this->reportModel->getCountByStatus();\n        \n        $meta = generateMetaTags('Reports Management', 'View and manage reported content');\n        require __DIR__ . '/../views/admin/reports.php';\n    }\n    \n    // View single report with details\n    public function viewReport($id) {\n        $report = $this->reportModel->findById($id);\n        \n        if (!$report) {\n            setFlash('error', 'Report not found');\n            redirect('/admin/reports');\n        }\n        \n        if ($report['reported_type'] === 'job') {\n            $reportedItem = $this->reportModel->getReportedJobDetails($report['reported_id']);\n        } else {\n            $reportedItem = $this->reportModel->getReportedUserDetails($report['reported_id']);\n        }\n        \n        $meta = generateMetaTags('View Report', 'Report details');\n        require __DIR__ . '/../views/admin/view_report.php';\n    }\n    \n    // Update report status\n    public function updateReport($id) {\n        checkCSRF();\n        \n        $status = sanitize($_POST['status'] ?? '');\n        $adminNotes = sanitize($_POST['admin_notes'] ?? '');\n        \n        if (!in_array($status, ['pending', 'reviewed', 'resolved', 'dismissed'])) {\n            setFlash('error', 'Invalid status');\n            redirect('/admin/reports');\n        }\n        \n        if ($this->reportModel->updateStatus($id, $status, $adminNotes)) {\n            setFlash('success', 'Report status updated successfully');\n        } else {\n            setFlash('error', 'Failed to update report');\n        }\n        \n        redirect(\"/admin/reports/$id\");\n    }\n    \n    // Delete report\n    public function deleteReport($id) {\n        checkCSRF();\n        \n        if ($this->reportModel->delete($id)) {\n            setFlash('success', 'Report deleted successfully');\n        } else {\n            setFlash('error', 'Failed to delete report');\n        }\n        \n        redirect('/admin/reports');\n    }\n}\n","path":null,"size_bytes":14055,"size_tokens":null},"includes/functions.php":{"content":"<?php\n/**\n * Core Helper Functions\n */\n\n// Start session if not already started\nfunction initSession() {\n    if (session_status() === PHP_SESSION_NONE) {\n        session_start();\n    }\n}\n\n// Include CSRF functions (must be after initSession is defined)\nrequire_once __DIR__ . '/csrf.php';\n\n// Sanitize input\nfunction sanitize($data) {\n    return htmlspecialchars(strip_tags(trim($data)), ENT_QUOTES, 'UTF-8');\n}\n\n// Validate email\nfunction isValidEmail($email) {\n    return filter_var($email, FILTER_VALIDATE_EMAIL) !== false;\n}\n\n// Redirect helper\nfunction redirect($url) {\n    header(\"Location: $url\");\n    exit();\n}\n\n// Check if user is logged in\nfunction isLoggedIn() {\n    initSession();\n    return isset($_SESSION['user_id']);\n}\n\n// Get current user\nfunction getCurrentUser() {\n    initSession();\n    if (!isLoggedIn()) {\n        return null;\n    }\n    \n    require_once __DIR__ . '/../app/models/User.php';\n    $userModel = new User();\n    return $userModel->findById($_SESSION['user_id']);\n}\n\n// Check if user has specific role\nfunction hasRole($role) {\n    $user = getCurrentUser();\n    return $user && $user['type'] === $role;\n}\n\n// Require authentication\nfunction requireAuth() {\n    if (!isLoggedIn()) {\n        redirect('/login');\n    }\n}\n\n// Require specific role\nfunction requireRole($role) {\n    requireAuth();\n    if (!hasRole($role)) {\n        http_response_code(403);\n        die('Unauthorized access');\n    }\n}\n\n// Format date\nfunction formatDate($date, $format = 'M d, Y') {\n    return date($format, strtotime($date));\n}\n\n// Generate slug from string\nfunction generateSlug($string) {\n    $string = strtolower(trim($string));\n    $string = preg_replace('/[^a-z0-9-]/', '-', $string);\n    $string = preg_replace('/-+/', '-', $string);\n    return trim($string, '-');\n}\n\n// File upload validation\nfunction validateFileUpload($file, $allowedTypes = ALLOWED_RESUME_TYPES, $maxSize = MAX_FILE_SIZE) {\n    $errors = [];\n    \n    if ($file['error'] !== UPLOAD_ERR_OK) {\n        $errors[] = 'File upload failed';\n        return $errors;\n    }\n    \n    if ($file['size'] > $maxSize) {\n        $errors[] = 'File size exceeds maximum limit (' . ($maxSize / 1024 / 1024) . 'MB)';\n    }\n    \n    $ext = strtolower(pathinfo($file['name'], PATHINFO_EXTENSION));\n    if (!in_array($ext, $allowedTypes)) {\n        $errors[] = 'Invalid file type. Allowed: ' . implode(', ', $allowedTypes);\n    }\n    \n    return $errors;\n}\n\n// Upload file\nfunction uploadFile($file, $destination) {\n    $ext = strtolower(pathinfo($file['name'], PATHINFO_EXTENSION));\n    $filename = uniqid() . '_' . time() . '.' . $ext;\n    $filepath = $destination . $filename;\n    \n    if (move_uploaded_file($file['tmp_name'], $filepath)) {\n        return $filename;\n    }\n    \n    return false;\n}\n\n// Pagination helper\nfunction paginate($totalItems, $itemsPerPage, $currentPage = 1) {\n    $totalPages = ceil($totalItems / $itemsPerPage);\n    $currentPage = max(1, min($currentPage, $totalPages));\n    $offset = ($currentPage - 1) * $itemsPerPage;\n    \n    return [\n        'total_items' => $totalItems,\n        'total_pages' => $totalPages,\n        'current_page' => $currentPage,\n        'items_per_page' => $itemsPerPage,\n        'offset' => $offset\n    ];\n}\n\n// Flash messages\nfunction setFlash($key, $message) {\n    initSession();\n    $_SESSION['flash'][$key] = $message;\n}\n\nfunction getFlash($key) {\n    initSession();\n    if (isset($_SESSION['flash'][$key])) {\n        $message = $_SESSION['flash'][$key];\n        unset($_SESSION['flash'][$key]);\n        return $message;\n    }\n    return null;\n}\n\nfunction hasFlash($key) {\n    initSession();\n    return isset($_SESSION['flash'][$key]);\n}\n\n// Get client IP address\nfunction getClientIP() {\n    $ip = $_SERVER['REMOTE_ADDR'] ?? '0.0.0.0';\n    \n    if (!empty($_SERVER['HTTP_CLIENT_IP'])) {\n        $ip = $_SERVER['HTTP_CLIENT_IP'];\n    } elseif (!empty($_SERVER['HTTP_X_FORWARDED_FOR'])) {\n        $ips = explode(',', $_SERVER['HTTP_X_FORWARDED_FOR']);\n        $ip = trim($ips[0]);\n    }\n    \n    return $ip;\n}\n\n// Session fingerprint for security\nfunction getSessionFingerprint() {\n    $userAgent = $_SERVER['HTTP_USER_AGENT'] ?? '';\n    $ip = getClientIP();\n    return md5($userAgent . $ip);\n}\n\n// Verify session fingerprint\nfunction verifySessionFingerprint() {\n    initSession();\n    if (!isset($_SESSION['fingerprint'])) {\n        $_SESSION['fingerprint'] = getSessionFingerprint();\n        return true;\n    }\n    \n    return $_SESSION['fingerprint'] === getSessionFingerprint();\n}\n\n// Price formatting\nfunction formatSalary($salary) {\n    if (empty($salary)) {\n        return 'Not Disclosed';\n    }\n    return '₹' . $salary . ' per month';\n}\n\n// Truncate text\nfunction truncate($text, $length = 100, $suffix = '...') {\n    if (strlen($text) <= $length) {\n        return $text;\n    }\n    return substr($text, 0, $length) . $suffix;\n}\n\n// Get base URL\nfunction baseUrl($path = '') {\n    $protocol = isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] === 'on' ? 'https' : 'http';\n    $host = $_SERVER['HTTP_HOST'] ?? 'localhost:5000';\n    $baseUrl = $protocol . '://' . $host;\n    return $baseUrl . '/' . ltrim($path, '/');\n}\n\n// Asset URL helper\nfunction asset($path) {\n    return baseUrl('assets/' . ltrim($path, '/'));\n}\n","path":null,"size_bytes":5251,"size_tokens":null},"docs/setup.md":{"content":"# ConnectWith9 Job Portal - Setup Guide\n\n## Environment Setup\n\n### Database Configuration\n\nThe application uses a remote MySQL database hosted on Hostinger. For security, you should set database credentials as environment variables:\n\n#### Option 1: Using Environment Variables (Recommended for Production)\n\nSet the following environment variables:\n\n```bash\nexport DB_HOST=\"srv1642.hstgr.io\"\nexport DB_NAME=\"u647904474_connect9job\"\nexport DB_USER=\"u647904474_connect9job\"\nexport DB_PASS=\"Hostinger@1234#\"\n```\n\n#### Option 2: Default Configuration (Development)\n\nThe application will use the default credentials specified in `config/env.php` if environment variables are not set. \n\n**IMPORTANT**: Before deploying to production:\n1. Remove the default credential values from `config/env.php`\n2. Set all credentials as environment variables\n3. Never commit credentials to version control\n\n### Database Tables Setup\n\nRun the setup script to create all necessary tables and insert sample data:\n\n```bash\nphp scripts/setup_database.php\n```\n\nThis will create:\n- Users table\n- Categories table\n- Technologies table\n- Education levels table\n- Jobs table\n- Applications table\n- Saved jobs table\n- Blog table\n- SEO logs table\n- Login attempts table (for security)\n\n### IP Whitelisting\n\nIf you encounter \"Access denied\" errors when connecting to the remote database, you may need to whitelist your IP address:\n\n1. Log in to your Hostinger control panel\n2. Navigate to MySQL Databases → Remote MySQL\n3. Add your server's IP address to the allowed list\n\n### Default User Accounts\n\nAfter running the setup script, you can log in with these accounts:\n\n**Admin Account:**\n- Email: admin@connectwith9.com\n- Password: password123\n\n**Employer Account:**\n- Email: employer1@example.com\n- Password: password123\n\n**Job Seeker Account:**\n- Email: jobseeker1@example.com\n- Password: password123\n\n**IMPORTANT**: Change these passwords immediately in production!\n\n## Running the Application\n\nStart the PHP built-in development server:\n\n```bash\nphp -S 0.0.0.0:5000 -t public\n```\n\nAccess the application at: http://localhost:5000\n\n## File Permissions\n\nEnsure the uploads directory is writable:\n\n```bash\nchmod -R 755 public/uploads\nchmod -R 755 logs\n```\n\n## Optional Features Setup\n\n### reCAPTCHA (Spam Prevention)\n\n1. Get reCAPTCHA keys from https://www.google.com/recaptcha/admin\n2. Set environment variables:\n\n```bash\nexport RECAPTCHA_SITE_KEY=\"your_site_key_here\"\nexport RECAPTCHA_SECRET_KEY=\"your_secret_key_here\"\n```\n\n### Email Notifications\n\nTo enable email notifications (job applications, approvals, etc.):\n\n1. Set up SMTP credentials:\n\n```bash\nexport SMTP_HOST=\"smtp.gmail.com\"\nexport SMTP_USER=\"your-email@gmail.com\"\nexport SMTP_PASS=\"your-app-password\"\nexport SMTP_PORT=\"587\"\n```\n\n2. For Gmail, you'll need to create an \"App Password\":\n   - Go to Google Account settings\n   - Security → 2-Step Verification\n   - App passwords → Generate new password\n\n## Security Checklist\n\nBefore going to production:\n\n- [ ] Remove default credentials from config/env.php\n- [ ] Set all sensitive values as environment variables\n- [ ] Change all default user passwords\n- [ ] Enable HTTPS\n- [ ] Set APP_ENV to 'production'\n- [ ] Enable reCAPTCHA\n- [ ] Configure email notifications\n- [ ] Set up regular database backups\n- [ ] Review and update .htaccess security headers\n- [ ] Test file upload restrictions\n- [ ] Review and test CSRF protection\n- [ ] Test login throttling mechanism\n\n## Troubleshooting\n\n### Database Connection Failed\n\n**Error**: \"Database connection failed. Please try again later.\"\n\n**Solutions**:\n1. Verify database credentials are correct\n2. Check if your IP is whitelisted on Hostinger\n3. Ensure the database server is accessible\n4. Verify network connectivity\n\n### File Upload Errors\n\n**Error**: \"Failed to upload resume\"\n\n**Solutions**:\n1. Check `public/uploads/resumes/` directory exists and is writable\n2. Verify PHP upload settings in php.ini:\n   - `upload_max_filesize = 5M`\n   - `post_max_size = 8M`\n3. Ensure file types match allowed types (PDF, DOC, DOCX, TXT)\n\n### Clean URLs Not Working\n\n**Error**: 404 errors on all pages except homepage\n\n**Solutions**:\n1. Ensure Apache mod_rewrite is enabled\n2. Verify .htaccess files are being read\n3. Check Apache configuration allows .htaccess overrides\n4. Restart Apache after changes\n\n## Production Deployment\n\n### Recommended Hosting Requirements\n\n- PHP 7.4 or higher (8.2 recommended)\n- MySQL 5.7 or higher\n- Apache with mod_rewrite enabled\n- HTTPS support\n- Minimum 512MB RAM\n- 1GB disk space\n\n### Deployment Steps\n\n1. Upload all files except `.git/` directory\n2. Set environment variables on your hosting platform\n3. Run database setup script\n4. Set proper file permissions\n5. Configure SSL certificate\n6. Test all functionality\n7. Change all default passwords\n8. Enable error logging (disable display_errors in production)\n\n## Support\n\nFor issues or questions:\n- Check the main README.md documentation\n- Review error logs in `logs/` directory\n- Ensure all dependencies are properly installed\n","path":null,"size_bytes":5039,"size_tokens":null},"public/index.php":{"content":"<?php\n/**\n * Front Controller - Routes all requests\n */\n\n// Error reporting for development\nif (defined('APP_ENV') && APP_ENV === 'development') {\n    error_reporting(E_ALL);\n    ini_set('display_errors', 1);\n}\n\n// Load configuration and utilities\nrequire_once __DIR__ . '/../config/env.php';\nrequire_once __DIR__ . '/../config/constants.php';\nrequire_once __DIR__ . '/../config/database.php';\nrequire_once __DIR__ . '/../includes/functions.php';\nrequire_once __DIR__ . '/../includes/csrf.php';\nrequire_once __DIR__ . '/../includes/seo.php';\n\n// Initialize session\ninitSession();\n\n// Get the request URI and method\n$requestUri = $_SERVER['REQUEST_URI'] ?? '/';\n$requestMethod = $_SERVER['REQUEST_METHOD'] ?? 'GET';\n\n// Remove query string and trim slashes\n$path = strtok($requestUri, '?');\n$path = trim($path, '/');\n\n// Simple router\ntry {\n    // Homepage\n    if (empty($path) || $path === 'index.php') {\n        require_once __DIR__ . '/../app/models/Job.php';\n        require_once __DIR__ . '/../app/models/Category.php';\n        \n        $jobModel = new Job();\n        $categoryModel = new Category();\n        \n        $latestJobs = $jobModel->getLatest(6);\n        $categories = $categoryModel->getAll();\n        \n        require __DIR__ . '/../app/views/home.php';\n        exit;\n    }\n    \n    // Authentication routes\n    if ($path === 'login') {\n        require_once __DIR__ . '/../app/controllers/AuthController.php';\n        $controller = new AuthController();\n        \n        if ($requestMethod === 'POST') {\n            $controller->login();\n        } else {\n            $controller->showLogin();\n        }\n        exit;\n    }\n    \n    if ($path === 'register') {\n        require_once __DIR__ . '/../app/controllers/AuthController.php';\n        $controller = new AuthController();\n        \n        if ($requestMethod === 'POST') {\n            $controller->register();\n        } else {\n            $controller->showRegister();\n        }\n        exit;\n    }\n    \n    if ($path === 'logout') {\n        require_once __DIR__ . '/../app/controllers/AuthController.php';\n        $controller = new AuthController();\n        $controller->logout();\n        exit;\n    }\n    \n    if ($path === 'forgot-password') {\n        require_once __DIR__ . '/../app/controllers/AuthController.php';\n        $controller = new AuthController();\n        \n        if ($requestMethod === 'POST') {\n            $controller->requestPasswordReset();\n        } else {\n            $controller->showForgotPassword();\n        }\n        exit;\n    }\n    \n    if ($path === 'reset-password') {\n        require_once __DIR__ . '/../app/controllers/AuthController.php';\n        $controller = new AuthController();\n        \n        if ($requestMethod === 'POST') {\n            $controller->resetPassword();\n        } else {\n            $controller->showResetPassword();\n        }\n        exit;\n    }\n    \n    // Jobs routes\n    if ($path === 'jobs') {\n        require_once __DIR__ . '/../app/controllers/JobController.php';\n        $controller = new JobController();\n        $controller->index();\n        exit;\n    }\n    \n    if (preg_match('/^jobs\\/(\\d+)$/', $path, $matches)) {\n        require_once __DIR__ . '/../app/controllers/JobController.php';\n        $controller = new JobController();\n        $controller->show($matches[1]);\n        exit;\n    }\n    \n    if (preg_match('/^jobs\\/(\\d+)\\/apply$/', $path, $matches)) {\n        require_once __DIR__ . '/../app/controllers/JobController.php';\n        $controller = new JobController();\n        $controller->apply($matches[1]);\n        exit;\n    }\n    \n    // Notification routes\n    if (preg_match('/^notifications(.*)/', $path, $matches)) {\n        require_once __DIR__ . '/../app/controllers/NotificationController.php';\n        $controller = new NotificationController();\n        $action = trim($matches[1], '/');\n        \n        if (empty($action)) {\n            $controller->index();\n        } elseif ($action === 'count') {\n            $controller->getUnreadCount();\n        } elseif ($action === 'recent') {\n            $controller->getRecent();\n        } elseif ($action === 'poll') {\n            $controller->poll();\n        } elseif ($action === 'mark-all-read' && $requestMethod === 'POST') {\n            $controller->markAllAsRead();\n        } elseif (preg_match('/^(\\d+)\\/read$/', $action, $m) && $requestMethod === 'POST') {\n            $controller->markAsRead($m[1]);\n        } elseif (preg_match('/^(\\d+)\\/delete$/', $action, $m) && $requestMethod === 'POST') {\n            $controller->delete($m[1]);\n        }\n        exit;\n    }\n    \n    // Chat routes\n    if (preg_match('/^chat(.*)/', $path, $matches)) {\n        require_once __DIR__ . '/../app/controllers/ChatController.php';\n        $controller = new ChatController();\n        $action = trim($matches[1], '/');\n        \n        if (empty($action)) {\n            $controller->index();\n        } elseif ($action === 'unread-count') {\n            $controller->getUnreadCount();\n        } elseif (preg_match('/^start\\/(\\d+)$/', $action, $m)) {\n            $controller->startConversation($m[1]);\n        } elseif (preg_match('/^(\\d+)$/', $action, $m)) {\n            $controller->conversation($m[1]);\n        } elseif (preg_match('/^(\\d+)\\/send$/', $action, $m) && $requestMethod === 'POST') {\n            $controller->sendMessage($m[1]);\n        } elseif (preg_match('/^(\\d+)\\/messages$/', $action, $m)) {\n            $controller->getMessages($m[1]);\n        }\n        exit;\n    }\n    \n    // Report route\n    if ($path === 'report/submit' && $requestMethod === 'POST') {\n        require_once __DIR__ . '/../app/controllers/ReportController.php';\n        $controller = new ReportController();\n        $controller->submitReport();\n        exit;\n    }\n    \n    // Admin routes\n    if (preg_match('/^admin\\/(.+)/', $path, $matches)) {\n        require_once __DIR__ . '/../app/controllers/AdminController.php';\n        $controller = new AdminController();\n        $action = $matches[1];\n        \n        if ($action === 'dashboard') {\n            $controller->dashboard();\n        } elseif ($action === 'users') {\n            $controller->users();\n        } elseif (preg_match('/^users\\/(\\d+)$/', $action, $m)) {\n            $controller->viewUser($m[1]);\n        } elseif (preg_match('/^users\\/(\\d+)\\/update$/', $action, $m)) {\n            $controller->updateUser($m[1]);\n        } elseif (preg_match('/^users\\/(\\d+)\\/delete$/', $action, $m)) {\n            $controller->deleteUser($m[1]);\n        } elseif ($action === 'jobs') {\n            $controller->jobs();\n        } elseif (preg_match('/^jobs\\/(\\d+)$/', $action, $m)) {\n            $controller->viewJob($m[1]);\n        } elseif (preg_match('/^jobs\\/(\\d+)\\/approve$/', $action, $m)) {\n            $controller->approveJob($m[1]);\n        } elseif (preg_match('/^jobs\\/(\\d+)\\/reject$/', $action, $m)) {\n            $controller->rejectJob($m[1]);\n        } elseif (preg_match('/^jobs\\/(\\d+)\\/delete$/', $action, $m)) {\n            $controller->deleteJob($m[1]);\n        } elseif ($action === 'candidates') {\n            $controller->candidates();\n        } elseif (preg_match('/^candidates\\/(\\d+)$/', $action, $m)) {\n            $controller->viewCandidate($m[1]);\n        } elseif ($action === 'notifications') {\n            $controller->notifications();\n        } elseif ($action === 'notifications/send' && $requestMethod === 'POST') {\n            $controller->sendSystemNotification();\n        } elseif ($action === 'notifications/delete' && $requestMethod === 'POST') {\n            $controller->deleteSystemNotification();\n        } elseif ($action === 'reports') {\n            $controller->reports();\n        } elseif (preg_match('/^reports\\/(\\d+)$/', $action, $m)) {\n            $controller->viewReport($m[1]);\n        } elseif (preg_match('/^reports\\/(\\d+)\\/update$/', $action, $m) && $requestMethod === 'POST') {\n            $controller->updateReport($m[1]);\n        } elseif (preg_match('/^reports\\/(\\d+)\\/delete$/', $action, $m) && $requestMethod === 'POST') {\n            $controller->deleteReport($m[1]);\n        }\n        exit;\n    }\n    \n    // Employer routes\n    if (preg_match('/^employer\\/(.+)/', $path, $matches)) {\n        require_once __DIR__ . '/../app/controllers/EmployerController.php';\n        $controller = new EmployerController();\n        $action = $matches[1];\n        \n        if ($action === 'dashboard') {\n            $controller->dashboard();\n        } elseif ($action === 'jobs') {\n            $controller->jobs();\n        } elseif ($action === 'post-job') {\n            if ($requestMethod === 'POST') {\n                $controller->postJob();\n            } else {\n                $controller->showPostJob();\n            }\n        } elseif (preg_match('/^jobs\\/(\\d+)\\/applications$/', $action, $m)) {\n            $controller->applications($m[1]);\n        } elseif (preg_match('/^jobs\\/(\\d+)\\/applications\\/(\\d+)\\/select$/', $action, $m)) {\n            $controller->selectCandidate($m[1], $m[2]);\n        } elseif (preg_match('/^jobs\\/(\\d+)\\/delete$/', $action, $m)) {\n            $controller->deleteJob($m[1]);\n        } elseif ($action === 'candidates') {\n            $controller->candidates();\n        } elseif (preg_match('/^candidates\\/(\\d+)$/', $action, $m)) {\n            $controller->viewCandidate($m[1]);\n        }\n        exit;\n    }\n    \n    // Jobseeker routes\n    if (preg_match('/^jobseeker\\/(.+)/', $path, $matches)) {\n        require_once __DIR__ . '/../app/controllers/JobSeekerController.php';\n        $controller = new JobSeekerController();\n        $action = $matches[1];\n        \n        if ($action === 'dashboard') {\n            $controller->dashboard();\n        } elseif ($action === 'applications') {\n            $controller->applications();\n        } elseif ($action === 'profile') {\n            $controller->showProfile();\n        } elseif ($action === 'profile/edit') {\n            $controller->editProfile();\n        } elseif ($action === 'profile/update-basic' && $requestMethod === 'POST') {\n            $controller->updateBasicInfo();\n        } elseif ($action === 'profile/upload-picture' && $requestMethod === 'POST') {\n            $controller->uploadProfilePicture();\n        } elseif ($action === 'profile/upload-resume' && $requestMethod === 'POST') {\n            $controller->uploadResume();\n        } elseif ($action === 'profile/add-work-experience' && $requestMethod === 'POST') {\n            $controller->addWorkExperience();\n        } elseif ($action === 'profile/delete-work-experience' && $requestMethod === 'POST') {\n            $controller->deleteWorkExperience();\n        } elseif ($action === 'profile/add-education' && $requestMethod === 'POST') {\n            $controller->addEducation();\n        } elseif ($action === 'profile/delete-education' && $requestMethod === 'POST') {\n            $controller->deleteEducation();\n        } elseif ($action === 'profile/add-skill' && $requestMethod === 'POST') {\n            $controller->addSkill();\n        } elseif ($action === 'profile/delete-skill' && $requestMethod === 'POST') {\n            $controller->deleteSkill();\n        } elseif ($action === 'profile/add-certification' && $requestMethod === 'POST') {\n            $controller->addCertification();\n        } elseif ($action === 'profile/delete-certification' && $requestMethod === 'POST') {\n            $controller->deleteCertification();\n        } elseif ($action === 'profile/add-language' && $requestMethod === 'POST') {\n            $controller->addLanguage();\n        } elseif ($action === 'profile/delete-language' && $requestMethod === 'POST') {\n            $controller->deleteLanguage();\n        } elseif ($action === 'profile/add-project' && $requestMethod === 'POST') {\n            $controller->addProject();\n        } elseif ($action === 'profile/delete-project' && $requestMethod === 'POST') {\n            $controller->deleteProject();\n        }\n        exit;\n    }\n    \n    // 404 Not Found\n    http_response_code(404);\n    echo '<h1>404 - Page Not Found</h1>';\n    echo '<p><a href=\"/\">Return to homepage</a></p>';\n    \n} catch (Exception $e) {\n    http_response_code(500);\n    if (APP_ENV === 'development') {\n        echo '<h1>Error</h1>';\n        echo '<p>' . htmlspecialchars($e->getMessage()) . '</p>';\n        echo '<pre>' . htmlspecialchars($e->getTraceAsString()) . '</pre>';\n    } else {\n        echo '<h1>500 - Internal Server Error</h1>';\n        echo '<p>Something went wrong. Please try again later.</p>';\n    }\n}\n","path":null,"size_bytes":12468,"size_tokens":null},"includes/email.php":{"content":"<?php\n/**\n * Email Helper Functions\n */\n\n// Send email using PHP mail()\nfunction sendEmail($to, $subject, $message, $fromName = null) {\n    $fromName = $fromName ?? APP_NAME;\n    $fromEmail = SMTP_USER;\n    \n    $headers = \"From: $fromName <$fromEmail>\\r\\n\";\n    $headers .= \"Reply-To: $fromEmail\\r\\n\";\n    $headers .= \"MIME-Version: 1.0\\r\\n\";\n    $headers .= \"Content-Type: text/html; charset=UTF-8\\r\\n\";\n    \n    return mail($to, $subject, $message, $headers);\n}\n\n// Email template wrapper\nfunction emailTemplate($content, $title = '') {\n    $title = $title ?: APP_NAME;\n    \n    return <<<HTML\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>$title</title>\n    <style>\n        body { font-family: Arial, sans-serif; line-height: 1.6; color: #333; }\n        .container { max-width: 600px; margin: 0 auto; padding: 20px; }\n        .header { background: #007bff; color: white; padding: 20px; text-align: center; }\n        .content { padding: 20px; background: #f4f4f4; }\n        .footer { padding: 10px; text-align: center; font-size: 12px; color: #666; }\n        .button { display: inline-block; padding: 10px 20px; background: #007bff; color: white; text-decoration: none; border-radius: 5px; }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <h1>$title</h1>\n        </div>\n        <div class=\"content\">\n            $content\n        </div>\n        <div class=\"footer\">\n            <p>&copy; 2025 $title. All rights reserved.</p>\n        </div>\n    </div>\n</body>\n</html>\nHTML;\n}\n\n// Send welcome email\nfunction sendWelcomeEmail($userEmail, $userName, $userType) {\n    $subject = \"Welcome to \" . APP_NAME;\n    \n    $content = <<<HTML\n<h2>Welcome, $userName!</h2>\n<p>Thank you for registering as a <strong>$userType</strong> on our platform.</p>\n<p>You can now:</p>\n<ul>\nHTML;\n    \n    if ($userType === 'jobseeker') {\n        $content .= <<<HTML\n    <li>Browse thousands of job opportunities</li>\n    <li>Apply for jobs with one click</li>\n    <li>Save your favorite jobs</li>\n    <li>Track your applications</li>\nHTML;\n    } else {\n        $content .= <<<HTML\n    <li>Post job openings</li>\n    <li>View applications</li>\n    <li>Manage your job listings</li>\n    <li>Find the perfect candidates</li>\nHTML;\n    }\n    \n    $content .= <<<HTML\n</ul>\n<p style=\"text-align: center; margin-top: 30px;\">\n    <a href=\"{baseUrl('login')}\" class=\"button\">Login Now</a>\n</p>\nHTML;\n    \n    $message = emailTemplate($content, APP_NAME);\n    return sendEmail($userEmail, $subject, $message);\n}\n\n// Send job application notification\nfunction sendApplicationEmail($employerEmail, $jobTitle, $applicantName) {\n    $subject = \"New Application for $jobTitle\";\n    \n    $content = <<<HTML\n<h2>New Job Application Received</h2>\n<p>You have received a new application for the position: <strong>$jobTitle</strong></p>\n<p>Applicant: <strong>$applicantName</strong></p>\n<p style=\"text-align: center; margin-top: 30px;\">\n    <a href=\"{baseUrl('employer/applications')}\" class=\"button\">View Application</a>\n</p>\nHTML;\n    \n    $message = emailTemplate($content);\n    return sendEmail($employerEmail, $subject, $message);\n}\n\n// Send job approval notification\nfunction sendJobApprovalEmail($employerEmail, $jobTitle, $status) {\n    $subject = $status === 'Approved' ? \"Job Approved: $jobTitle\" : \"Job Status Update: $jobTitle\";\n    \n    $statusMessage = $status === 'Approved' \n        ? \"Your job posting has been approved and is now live!\"\n        : \"Your job posting status has been updated to: $status\";\n    \n    $content = <<<HTML\n<h2>Job Status Update</h2>\n<p>Job Title: <strong>$jobTitle</strong></p>\n<p>Status: <strong>$status</strong></p>\n<p>$statusMessage</p>\n<p style=\"text-align: center; margin-top: 30px;\">\n    <a href=\"{baseUrl('employer/jobs')}\" class=\"button\">View Your Jobs</a>\n</p>\nHTML;\n    \n    $message = emailTemplate($content);\n    return sendEmail($employerEmail, $subject, $message);\n}\n\n// Send password reset email\nfunction sendPasswordResetEmail($userEmail, $userName, $resetToken) {\n    $subject = \"Password Reset Request - \" . APP_NAME;\n    \n    $resetUrl = APP_URL . \"/reset-password?token=\" . $resetToken;\n    \n    $content = <<<HTML\n<h2>Password Reset Request</h2>\n<p>Hello $userName,</p>\n<p>We received a request to reset your password. Click the button below to create a new password:</p>\n<p style=\"text-align: center; margin: 30px 0;\">\n    <a href=\"$resetUrl\" class=\"button\">Reset Password</a>\n</p>\n<p>Or copy and paste this link into your browser:</p>\n<p style=\"word-break: break-all; background: #fff; padding: 10px; border: 1px solid #ddd;\">$resetUrl</p>\n<p><strong>This link will expire in 1 hour.</strong></p>\n<p>If you didn't request this password reset, please ignore this email. Your password will remain unchanged.</p>\n<p>For security reasons, never share this link with anyone.</p>\nHTML;\n    \n    $message = emailTemplate($content, APP_NAME . \" - Password Reset\");\n    return sendEmail($userEmail, $subject, $message);\n}\n","path":null,"size_bytes":5095,"size_tokens":null},"docs/hostinger_deployment.md":{"content":"# How to Deploy ConnectWith9 Job Portal to Hostinger\n\nThis guide will walk you through deploying your ConnectWith9 job portal to Hostinger hosting.\n\n## Prerequisites\n\n✅ You already have:\n- Hostinger hosting account\n- MySQL database created on Hostinger (srv1642.hstgr.io)\n- Database credentials configured\n\n## Deployment Methods\n\nYou can choose from three methods. **Method 1 (File Manager)** is the simplest for beginners.\n\n---\n\n## Method 1: Using Hostinger File Manager (Recommended for Beginners)\n\n### Step 1: Prepare Your Files\n\n1. **Download all project files from Replit**:\n   - Click the three dots (⋮) menu in Replit\n   - Select \"Download as zip\"\n   - OR download individual folders\n\n2. **Files to include**:\n   ```\n   ✅ app/ (all controllers, models, views)\n   ✅ config/ (database.php, env.php, constants.php)\n   ✅ includes/ (functions.php, csrf.php, seo.php, email.php)\n   ✅ public/ (index.php, .htaccess, assets/, uploads/)\n   ✅ docs/ (optional - for documentation)\n   \n   ❌ .git/ (exclude)\n   ❌ .replit, replit.nix (exclude - these are Replit-specific)\n   ❌ scripts/ (optional - only needed for initial setup)\n   ```\n\n### Step 2: Access Hostinger File Manager\n\n1. Log in to **hPanel** (https://hpanel.hostinger.com)\n2. Click **\"Websites\"** in the left sidebar\n3. Click **\"Manage\"** on your hosting plan\n4. In the left sidebar under **\"Files\"**, click **\"File Manager\"**\n\n### Step 3: Clear the public_html Directory\n\n1. Navigate to **public_html** folder (this is your web root)\n2. Delete the default files (index.html, etc.)\n3. Keep public_html open - we'll upload here\n\n### Step 4: Upload Your Application\n\n**Option A: Upload as ZIP (Recommended)**\n\n1. Create a ZIP file of your entire project\n2. In File Manager, click **\"Upload Files\"** (top-right corner)\n3. Select your ZIP file\n4. After upload completes, right-click the ZIP file\n5. Select **\"Extract\"**\n6. Delete the ZIP file after extraction\n\n**Option B: Upload Individual Files**\n\n1. Click **\"Upload Files\"** button\n2. Select files/folders from your computer\n3. Wait for upload to complete\n4. Note: File Manager has a 256MB per file limit\n\n### Step 5: Organize File Structure\n\nYour public_html should look like this:\n\n```\npublic_html/\n├── app/\n│   ├── controllers/\n│   ├── models/\n│   └── views/\n├── config/\n│   ├── database.php\n│   ├── env.php\n│   └── constants.php\n├── includes/\n│   ├── functions.php\n│   ├── csrf.php\n│   ├── seo.php\n│   └── email.php\n├── public/\n│   ├── assets/\n│   ├── uploads/\n│   ├── index.php\n│   └── .htaccess\n├── docs/\n└── scripts/\n```\n\n**IMPORTANT:** Move the contents of the `public/` folder to the root of `public_html`:\n\n```\npublic_html/\n├── app/\n├── config/\n├── includes/\n├── index.php          ← Moved from public/\n├── .htaccess          ← Moved from public/\n├── assets/            ← Moved from public/\n└── uploads/           ← Moved from public/\n```\n\n### Step 6: Update Configuration Files\n\n1. Click on **config/env.php** in File Manager\n2. Click **\"Edit\"** button\n3. Update the database settings (already correct, but verify):\n\n```php\n// Database Configuration\ndefine('DB_HOST', 'srv1642.hstgr.io');\ndefine('DB_NAME', 'u647904474_connect9job');\ndefine('DB_USER', 'u647904474_connect9job');\ndefine('DB_PASS', 'Hostinger@1234#');\n\n// Update APP_URL to your domain\ndefine('APP_URL', 'https://yourdomain.com');\ndefine('APP_ENV', 'production'); // Change to production\n```\n\n4. Click **\"Save\"**\n\n### Step 7: Set File Permissions\n\n1. Select the **uploads** folder\n2. Right-click → **\"Permissions\"**\n3. Set to **755** (or check: Owner: rwx, Group: r-x, Public: r-x)\n4. Click **\"Apply to subdirectories\"**\n5. Click **\"OK\"**\n\nRepeat for:\n- **uploads/resumes/** → 755\n- **uploads/logos/** → 755\n\n### Step 8: Database Setup\n\nYour database is already created! But if you need to import fresh data:\n\n1. In hPanel, go to **\"Databases\"** → **\"Management\"**\n2. Find your database: **u647904474_connect9job**\n3. Click **\"phpMyAdmin\"**\n4. Select your database from left sidebar\n5. Go to **\"Import\"** tab\n6. Click **\"Choose File\"** → Select `docs/sample_data.sql`\n7. Click **\"Import\"** at the bottom\n8. Wait for success message\n\n### Step 9: Enable SSL (HTTPS)\n\n1. In hPanel, go to **\"Security\"** → **\"SSL\"**\n2. Enable **\"Free SSL Certificate\"**\n3. Wait 5-10 minutes for SSL to activate\n4. Force HTTPS by adding to .htaccess (top of file):\n\n```apache\n# Force HTTPS\nRewriteEngine On\nRewriteCond %{HTTPS} off\nRewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]\n```\n\n### Step 10: Test Your Website\n\n1. Visit your domain: **https://yourdomain.com**\n2. Test these pages:\n   - Homepage: `/`\n   - Browse Jobs: `/jobs`\n   - Login: `/login`\n   - Register: `/register`\n\n3. Log in with:\n   - **Admin**: admin@connectwith9.com / password123\n   - **Employer**: employer1@example.com / password123\n   - **Job Seeker**: jobseeker1@example.com / password123\n\n---\n\n## Method 2: Using FTP (For Larger Files)\n\n### Step 1: Get FTP Credentials\n\n1. In hPanel, go to **\"Files\"** → **\"FTP Accounts\"**\n2. Note your **Master FTP Account** details:\n   - Hostname\n   - Username\n   - Port: 21 (FTP) or 22 (SFTP - more secure)\n\n### Step 2: Download FileZilla\n\n1. Download FileZilla from: https://filezilla-project.org/\n2. Install on your computer\n\n### Step 3: Connect to Hostinger\n\n1. Open FileZilla\n2. At the top, enter:\n   - **Host**: your FTP hostname\n   - **Username**: your FTP username\n   - **Password**: your FTP password\n   - **Port**: 21 or 22\n3. Click **\"Quickconnect\"**\n\n### Step 4: Upload Files\n\n1. **Left panel**: Navigate to your project folder on your computer\n2. **Right panel**: Navigate to **public_html** folder on server\n3. **Delete** default files in public_html\n4. **Drag and drop** all your project folders from left to right\n5. Wait for upload to complete (no size limit with FTP!)\n\n### Step 5: Reorganize Files\n\nSame as Method 1 - move contents of `public/` to root of `public_html`\n\n---\n\n## Method 3: Using Git (Advanced - For Updates)\n\n### Step 1: Enable SSH Access\n\n1. In hPanel, go to **\"Advanced\"** → **\"SSH Access\"**\n2. Enable SSH\n3. Set a password\n4. Note your SSH details (hostname, port 22, username)\n\n### Step 2: Connect via SSH\n\nUse Terminal (Mac/Linux) or PuTTY (Windows):\n\n```bash\nssh your_username@your_hostname -p 22\n```\n\n### Step 3: Navigate and Clone\n\n```bash\n# Go to web directory\ncd domains/yourdomain.com/public_html\n\n# Clone your repository (if you have one)\ngit clone https://github.com/yourusername/connectwith9.git .\n\n# Or upload files via SFTP\n```\n\n---\n\n## Post-Deployment Checklist\n\nAfter deployment, verify:\n\n- [ ] Website loads at your domain\n- [ ] Homepage displays job listings\n- [ ] Login page works\n- [ ] Register page works\n- [ ] Browse jobs shows all listings\n- [ ] Admin login works\n- [ ] SSL certificate is active (https://)\n- [ ] No PHP errors displayed\n- [ ] Images and CSS load correctly\n\n---\n\n## Security Checklist (Important!)\n\nBefore going live:\n\n- [ ] Change all default user passwords\n- [ ] Set `APP_ENV` to `'production'` in config/env.php\n- [ ] Disable error display:\n  ```php\n  // Remove or set to 0 in production\n  ini_set('display_errors', 0);\n  error_reporting(0);\n  ```\n- [ ] Set proper file permissions (755 for folders, 644 for files)\n- [ ] Enable SSL/HTTPS\n- [ ] Keep database credentials secure\n- [ ] Add reCAPTCHA keys (optional but recommended)\n\n---\n\n## Troubleshooting\n\n### \"Database connection failed\"\n**Solution**: Verify database credentials in config/env.php. For Hostinger, DB_HOST should be `localhost` if database is on the same server, or `srv1642.hstgr.io` for remote.\n\n### Blank white page\n**Solution**: \n1. Enable error display temporarily\n2. Check PHP version (should be 8.0+)\n3. Verify index.php is in the correct location\n\n### 404 errors on all pages\n**Solution**: \n1. Ensure .htaccess file is uploaded\n2. Check Apache mod_rewrite is enabled (it should be on Hostinger)\n3. Verify RewriteBase is set correctly\n\n### Images/CSS not loading\n**Solution**:\n1. Check file paths in your code\n2. Verify assets folder is uploaded\n3. Clear browser cache\n\n### 500 Internal Server Error\n**Solution**:\n1. Check .htaccess syntax\n2. Verify file permissions\n3. Check PHP error logs in File Manager\n\n---\n\n## Getting Help\n\n- **Hostinger Support**: 24/7 live chat available in hPanel\n- **Knowledge Base**: https://support.hostinger.com\n- **Community Forum**: Ask questions in Hostinger community\n\n---\n\n## Maintenance Tips\n\n1. **Regular Backups**: Use Hostinger's backup feature (Files → Backups)\n2. **Database Backups**: Export via phpMyAdmin regularly\n3. **Monitor Logs**: Check error logs in File Manager\n4. **Keep PHP Updated**: Use latest stable PHP version in hPanel\n5. **Security Updates**: Monitor and update your code regularly\n\n---\n\n## Your ConnectWith9 Job Portal is Ready! 🚀\n\nOnce deployed, your job portal will be live and accessible to users worldwide. Remember to:\n- Change all default passwords\n- Test all features thoroughly\n- Monitor performance and errors\n- Keep regular backups\n\nGood luck with your job portal!\n","path":null,"size_bytes":9211,"size_tokens":null},"scripts/add_jobseeker_profiles.php":{"content":"<?php\n/**\n * Add Comprehensive Job Seeker Profile Tables\n * Run this to enable advanced job seeker profile features\n */\n\nrequire_once __DIR__ . '/../config/database.php';\n\ntry {\n    $db = getDB();\n    \n    echo \"Creating job seeker profile tables...\\n\\n\";\n    \n    // 1. Main jobseeker profiles table\n    echo \"1. Creating jobseeker_profiles table...\\n\";\n    $sql = \"CREATE TABLE IF NOT EXISTS jobseeker_profiles (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        user_id INT NOT NULL UNIQUE,\n        headline VARCHAR(200),\n        summary TEXT,\n        phone VARCHAR(20),\n        address TEXT,\n        city VARCHAR(100),\n        state VARCHAR(100),\n        country VARCHAR(100) DEFAULT 'India',\n        postal_code VARCHAR(20),\n        date_of_birth DATE,\n        gender ENUM('male', 'female', 'other', 'prefer_not_to_say'),\n        profile_picture VARCHAR(255),\n        resume_file VARCHAR(255),\n        linkedin_url VARCHAR(255),\n        github_url VARCHAR(255),\n        portfolio_url VARCHAR(255),\n        total_experience_years INT DEFAULT 0,\n        current_salary DECIMAL(10,2),\n        expected_salary DECIMAL(10,2),\n        notice_period VARCHAR(50),\n        availability ENUM('immediate', '15_days', '1_month', '2_months', '3_months') DEFAULT 'immediate',\n        willing_to_relocate BOOLEAN DEFAULT FALSE,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n        FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n        INDEX idx_city (city),\n        INDEX idx_experience (total_experience_years),\n        INDEX idx_availability (availability)\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\";\n    $db->exec($sql);\n    echo \"   ✓ jobseeker_profiles table created\\n\";\n    \n    // 2. Work experience table\n    echo \"2. Creating work_experiences table...\\n\";\n    $sql = \"CREATE TABLE IF NOT EXISTS work_experiences (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        user_id INT NOT NULL,\n        job_title VARCHAR(200) NOT NULL,\n        company_name VARCHAR(200) NOT NULL,\n        location VARCHAR(200),\n        employment_type ENUM('full_time', 'part_time', 'contract', 'internship', 'freelance') DEFAULT 'full_time',\n        start_date DATE NOT NULL,\n        end_date DATE,\n        is_current BOOLEAN DEFAULT FALSE,\n        description TEXT,\n        achievements TEXT,\n        display_order INT DEFAULT 0,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n        INDEX idx_user (user_id)\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\";\n    $db->exec($sql);\n    echo \"   ✓ work_experiences table created\\n\";\n    \n    // 3. Education table\n    echo \"3. Creating education table...\\n\";\n    $sql = \"CREATE TABLE IF NOT EXISTS education (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        user_id INT NOT NULL,\n        degree VARCHAR(200) NOT NULL,\n        field_of_study VARCHAR(200),\n        institution VARCHAR(200) NOT NULL,\n        location VARCHAR(200),\n        start_date DATE,\n        end_date DATE,\n        grade VARCHAR(50),\n        description TEXT,\n        display_order INT DEFAULT 0,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n        INDEX idx_user (user_id)\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\";\n    $db->exec($sql);\n    echo \"   ✓ education table created\\n\";\n    \n    // 4. Skills table\n    echo \"4. Creating skills table...\\n\";\n    $sql = \"CREATE TABLE IF NOT EXISTS skills (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        user_id INT NOT NULL,\n        skill_name VARCHAR(100) NOT NULL,\n        proficiency ENUM('beginner', 'intermediate', 'advanced', 'expert') DEFAULT 'intermediate',\n        years_of_experience INT DEFAULT 0,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n        INDEX idx_user (user_id),\n        INDEX idx_skill_name (skill_name)\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\";\n    $db->exec($sql);\n    echo \"   ✓ skills table created\\n\";\n    \n    // 5. Certifications table\n    echo \"5. Creating certifications table...\\n\";\n    $sql = \"CREATE TABLE IF NOT EXISTS certifications (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        user_id INT NOT NULL,\n        certification_name VARCHAR(200) NOT NULL,\n        issuing_organization VARCHAR(200) NOT NULL,\n        issue_date DATE,\n        expiry_date DATE,\n        credential_id VARCHAR(200),\n        credential_url VARCHAR(255),\n        description TEXT,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n        INDEX idx_user (user_id)\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\";\n    $db->exec($sql);\n    echo \"   ✓ certifications table created\\n\";\n    \n    // 6. Languages table\n    echo \"6. Creating languages table...\\n\";\n    $sql = \"CREATE TABLE IF NOT EXISTS languages (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        user_id INT NOT NULL,\n        language_name VARCHAR(100) NOT NULL,\n        proficiency ENUM('basic', 'conversational', 'professional', 'native') DEFAULT 'professional',\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n        INDEX idx_user (user_id)\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\";\n    $db->exec($sql);\n    echo \"   ✓ languages table created\\n\";\n    \n    // 7. Projects table\n    echo \"7. Creating projects table...\\n\";\n    $sql = \"CREATE TABLE IF NOT EXISTS projects (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        user_id INT NOT NULL,\n        project_name VARCHAR(200) NOT NULL,\n        project_url VARCHAR(255),\n        description TEXT,\n        technologies_used TEXT,\n        start_date DATE,\n        end_date DATE,\n        is_ongoing BOOLEAN DEFAULT FALSE,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE CASCADE,\n        INDEX idx_user (user_id)\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\";\n    $db->exec($sql);\n    echo \"   ✓ projects table created\\n\";\n    \n    echo \"\\n✅ All job seeker profile tables created successfully!\\n\";\n    echo \"\\nJob seekers can now create comprehensive profiles with:\\n\";\n    echo \"  • Personal information & contact details\\n\";\n    echo \"  • Work experience history\\n\";\n    echo \"  • Educational background\\n\";\n    echo \"  • Skills with proficiency levels\\n\";\n    echo \"  • Certifications & credentials\\n\";\n    echo \"  • Language proficiencies\\n\";\n    echo \"  • Projects & portfolio\\n\";\n    echo \"  • Resume file upload (PDF/DOCX)\\n\";\n    echo \"  • Profile picture upload\\n\";\n    \n} catch (Exception $e) {\n    die(\"Error: \" . $e->getMessage() . \"\\n\");\n}\n","path":null,"size_bytes":7037,"size_tokens":null},"app/views/admin/dashboard.php":{"content":"<?php\n$meta = generateMetaTags('Admin Dashboard', 'Admin panel for ConnectWith9');\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container\">\n    <h1 class=\"mb-4\">Admin Dashboard</h1>\n    \n    <?php if ($success = getFlash('success')): ?>\n        <div class=\"alert alert-success\"><?= $success ?></div>\n    <?php endif; ?>\n    \n    <div class=\"row mb-4\">\n        <div class=\"col-md-3\">\n            <div class=\"card text-white bg-primary\">\n                <div class=\"card-body\">\n                    <h5 class=\"card-title\">Total Users</h5>\n                    <p class=\"display-4\"><?= $stats['total_users'] ?></p>\n                </div>\n            </div>\n        </div>\n        <div class=\"col-md-3\">\n            <div class=\"card text-white bg-success\">\n                <div class=\"card-body\">\n                    <h5 class=\"card-title\">Job Seekers</h5>\n                    <p class=\"display-4\"><?= $stats['jobseekers'] ?></p>\n                </div>\n            </div>\n        </div>\n        <div class=\"col-md-3\">\n            <div class=\"card text-white bg-info\">\n                <div class=\"card-body\">\n                    <h5 class=\"card-title\">Employers</h5>\n                    <p class=\"display-4\"><?= $stats['employers'] ?></p>\n                </div>\n            </div>\n        </div>\n        <div class=\"col-md-3\">\n            <div class=\"card text-white bg-warning\">\n                <div class=\"card-body\">\n                    <h5 class=\"card-title\">Total Jobs</h5>\n                    <p class=\"display-4\"><?= $stats['total_jobs'] ?></p>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <div class=\"row mb-4\">\n        <div class=\"col-md-6\">\n            <div class=\"card\">\n                <div class=\"card-body\">\n                    <h5 class=\"card-title\">Pending Jobs</h5>\n                    <p class=\"display-6\"><?= $stats['pending_jobs'] ?></p>\n                    <a href=\"/admin/jobs?status=Pending\" class=\"btn btn-warning\">Review Jobs</a>\n                </div>\n            </div>\n        </div>\n        <div class=\"col-md-6\">\n            <div class=\"card\">\n                <div class=\"card-body\">\n                    <h5 class=\"card-title\">Approved Jobs</h5>\n                    <p class=\"display-6\"><?= $stats['approved_jobs'] ?></p>\n                    <a href=\"/admin/jobs?status=Approved\" class=\"btn btn-success\">View Jobs</a>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <div class=\"row\">\n        <div class=\"col-md-12\">\n            <div class=\"card\">\n                <div class=\"card-header\">\n                    <h5 class=\"mb-0\">Quick Actions</h5>\n                </div>\n                <div class=\"card-body\">\n                    <a href=\"/admin/users\" class=\"btn btn-primary me-2\"><i class=\"fas fa-users\"></i> Manage Users</a>\n                    <a href=\"/admin/jobs\" class=\"btn btn-primary me-2\"><i class=\"fas fa-briefcase\"></i> Manage Jobs</a>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <div class=\"row mt-4\">\n        <div class=\"col-md-12\">\n            <div class=\"card\">\n                <div class=\"card-header\">\n                    <h5 class=\"mb-0\">Recent Jobs</h5>\n                </div>\n                <div class=\"card-body\">\n                    <div class=\"table-responsive\">\n                        <table class=\"table table-hover\">\n                            <thead>\n                                <tr>\n                                    <th>Title</th>\n                                    <th>Employer</th>\n                                    <th>Location</th>\n                                    <th>Status</th>\n                                    <th>Posted</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                <?php foreach ($recentJobs as $job): ?>\n                                <tr>\n                                    <td><?= htmlspecialchars($job['title']) ?></td>\n                                    <td><?= htmlspecialchars($job['employer_name']) ?></td>\n                                    <td><?= htmlspecialchars($job['location']) ?></td>\n                                    <td>\n                                        <span class=\"badge bg-<?= $job['status'] === 'Approved' ? 'success' : ($job['status'] === 'Pending' ? 'warning' : 'danger') ?>\">\n                                            <?= $job['status'] ?>\n                                        </span>\n                                    </td>\n                                    <td><?= formatDate($job['created_at']) ?></td>\n                                </tr>\n                                <?php endforeach; ?>\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":4959,"size_tokens":null},"docs/security.md":{"content":"# Security Documentation\n\n## Overview\n\nConnectWith9 Job Portal implements multiple layers of security to protect user data and prevent common web vulnerabilities.\n\n## Implemented Security Features\n\n### 1. Authentication & Authorization\n\n#### Password Security\n- **Hashing Algorithm**: bcrypt via PHP's `password_hash()` function\n- **Cost Factor**: Default (currently 10)\n- **Verification**: Using `password_verify()` for constant-time comparison\n- **Minimum Length**: 6 characters (configurable in validation)\n\n#### Session Management\n- **Session Fingerprinting**: Combines user IP and user agent\n- **Session Regeneration**: On login\n- **Session Timeout**: 1 hour (configurable in config/constants.php)\n- **Secure Flags**: Should enable `session.cookie_secure` in production\n\n#### Login Throttling\n- **Maximum Attempts**: 5 failed attempts\n- **Lockout Duration**: 15 minutes\n- **Tracking Method**: IP-based with database logging\n- **Cleanup**: Old attempts auto-expire after lockout period\n\n### 2. Input Validation & Sanitization\n\nAll user inputs are sanitized using:\n\n```php\nfunction sanitize($data) {\n    return htmlspecialchars(strip_tags(trim($data)), ENT_QUOTES, 'UTF-8');\n}\n```\n\n#### Sanitization Locations\n- All form inputs before processing\n- All data before display (XSS prevention)\n- Email validation using `filter_var()`\n- File upload validation (type, size, extension)\n\n### 3. CSRF Protection\n\n#### Implementation\n- **Token Generation**: 32-byte random token via `random_bytes()`\n- **Storage**: PHP session\n- **Validation**: Hash comparison using `hash_equals()`\n- **Requirement**: All POST requests must include valid CSRF token\n\n#### Usage in Forms\n```php\n<?= csrfField() ?>\n```\n\nThis renders:\n```html\n<input type=\"hidden\" name=\"csrf_token\" value=\"[token]\">\n```\n\n### 4. SQL Injection Prevention\n\n#### Prepared Statements\nAll database queries use PDO prepared statements:\n\n```php\n$sql = \"SELECT * FROM users WHERE email = :email\";\n$stmt = $this->db->prepare($sql);\n$stmt->execute([':email' => $email]);\n```\n\n#### Parameter Binding\n- Named parameters for clarity\n- Proper type hinting with PDO::PARAM_INT\n- No string concatenation in queries\n\n### 5. File Upload Security\n\n#### Resume Upload Restrictions\n- **Allowed Types**: PDF, DOC, DOCX, TXT\n- **Maximum Size**: 5MB\n- **Validation**: MIME type and extension checking\n- **Storage**: Outside web root (recommended) or with .htaccess protection\n- **Filename**: Randomized with `uniqid()` and timestamp\n\n#### Implementation\n```php\nfunction validateFileUpload($file, $allowedTypes, $maxSize) {\n    // Check upload errors\n    // Verify file size\n    // Validate extension\n    // Could add MIME type checking\n}\n```\n\n### 6. XSS (Cross-Site Scripting) Prevention\n\n#### Output Escaping\nAll dynamic content is escaped before display:\n\n```php\n<?= htmlspecialchars($user['name'], ENT_QUOTES, 'UTF-8') ?>\n```\n\n#### Content Security\n- No `eval()` or similar dangerous functions\n- No inline JavaScript with user data\n- Proper content-type headers\n\n### 7. Security Headers\n\nImplemented in `.htaccess`:\n\n```apache\nHeader set X-XSS-Protection \"1; mode=block\"\nHeader set X-Frame-Options \"SAMEORIGIN\"\nHeader set X-Content-Type-Options \"nosniff\"\n```\n\nAdditional headers to consider for production:\n- `Strict-Transport-Security` (HSTS)\n- `Content-Security-Policy` (CSP)\n- `Referrer-Policy`\n- `Permissions-Policy`\n\n### 8. Access Control\n\n#### Role-Based Access\n- **Admin**: Full system access\n- **Employer**: Job posting and application viewing\n- **Job Seeker**: Job browsing and application submission\n\n#### Authorization Checks\n```php\nrequireRole(USER_TYPE_ADMIN);  // Enforces admin access\nhasRole($role);                // Checks specific role\nrequireAuth();                 // Enforces any authenticated user\n```\n\n### 9. Directory Protection\n\n- `.htaccess` disables directory listing\n- Sensitive directories should be outside web root\n- `uploads/` directory should have execute permissions disabled\n\n## Security Best Practices\n\n### For Production Deployment\n\n1. **Environment Variables**\n   - Move all credentials to environment variables\n   - Never commit `.env` files to version control\n   - Use different credentials for dev/staging/production\n\n2. **HTTPS/SSL**\n   - Enable HTTPS for all pages\n   - Set secure and httponly flags on cookies\n   - Enable HSTS header\n\n3. **Error Handling**\n   - Disable `display_errors` in php.ini\n   - Enable error logging to files\n   - Show generic error messages to users\n\n4. **Database Security**\n   - Use separate database user with minimal privileges\n   - Enable MySQL query logging for auditing\n   - Regular backups with encryption\n\n5. **File Permissions**\n   ```bash\n   # Directories\n   find . -type d -exec chmod 755 {} \\;\n   \n   # Files\n   find . -type f -exec chmod 644 {} \\;\n   \n   # Uploads (no execute)\n   chmod 755 public/uploads\n   ```\n\n6. **Regular Updates**\n   - Keep PHP updated\n   - Monitor security advisories\n   - Update dependencies regularly\n\n### Additional Security Measures to Implement\n\n#### Rate Limiting\n- Limit API requests per IP\n- Throttle form submissions\n- Protect against DDoS\n\n#### Two-Factor Authentication\n- SMS or email verification\n- TOTP (Time-based One-Time Password)\n- Backup codes\n\n#### Audit Logging\n- Log all admin actions\n- Track job posting changes\n- Monitor failed login attempts\n- IP address tracking\n\n#### Content Security Policy\n```apache\nHeader set Content-Security-Policy \"default-src 'self'; script-src 'self' cdn.jsdelivr.net; style-src 'self' cdn.jsdelivr.net cdnjs.cloudflare.com; img-src 'self' data:;\"\n```\n\n## Common Vulnerabilities Mitigated\n\n✅ **SQL Injection**: Prepared statements\n✅ **XSS**: Output escaping\n✅ **CSRF**: Token validation\n✅ **Brute Force**: Login throttling\n✅ **Session Hijacking**: Fingerprinting\n✅ **File Upload**: Type and size validation\n✅ **Directory Traversal**: Proper path handling\n✅ **Clickjacking**: X-Frame-Options header\n\n## Security Testing Checklist\n\n- [ ] Test SQL injection on all inputs\n- [ ] Test XSS on all user-generated content\n- [ ] Verify CSRF tokens on all forms\n- [ ] Test file upload restrictions\n- [ ] Verify login throttling works\n- [ ] Check authorization on all admin/employer routes\n- [ ] Test session timeout\n- [ ] Verify password hashing\n- [ ] Check for sensitive data exposure\n- [ ] Test HTTPS enforcement\n- [ ] Review error messages for information leakage\n- [ ] Scan for known vulnerabilities\n\n## Incident Response\n\nIf a security breach is discovered:\n\n1. **Immediate Actions**\n   - Take affected systems offline if necessary\n   - Change all passwords and API keys\n   - Review logs for unauthorized access\n   - Identify the vulnerability\n\n2. **Investigation**\n   - Determine scope of breach\n   - Identify compromised data\n   - Document timeline of events\n\n3. **Remediation**\n   - Patch the vulnerability\n   - Restore from clean backups if needed\n   - Notify affected users\n   - Report to authorities if required\n\n4. **Prevention**\n   - Implement additional safeguards\n   - Update security procedures\n   - Conduct security training\n\n## Compliance Considerations\n\n### Data Protection\n- Implement user data deletion\n- Provide data export functionality\n- Maintain privacy policy\n- Get explicit consent for data collection\n\n### Password Policy\n- Enforce minimum complexity\n- Implement password expiration\n- Prevent password reuse\n- Offer password reset functionality\n\n## Contact\n\nFor security issues or vulnerabilities:\n- **DO NOT** create public issues\n- Email security concerns privately\n- Include detailed reproduction steps\n- Allow reasonable time for fixes before disclosure\n","path":null,"size_bytes":7585,"size_tokens":null},"scripts/add_password_reset.php":{"content":"<?php\n/**\n * Add Password Reset Tokens Table\n * Run this to enable password reset functionality\n */\n\nrequire_once __DIR__ . '/../config/database.php';\n\ntry {\n    $db = getDB();\n    \n    echo \"Creating password_reset_tokens table...\\n\";\n    \n    $sql = \"CREATE TABLE IF NOT EXISTS password_reset_tokens (\n        id INT AUTO_INCREMENT PRIMARY KEY,\n        email VARCHAR(100) NOT NULL,\n        token VARCHAR(100) NOT NULL UNIQUE,\n        expires_at DATETIME NOT NULL,\n        created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n        INDEX idx_email (email),\n        INDEX idx_token (token),\n        INDEX idx_expires (expires_at)\n    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\";\n    \n    $db->exec($sql);\n    \n    echo \"✓ Table created successfully!\\n\";\n    echo \"\\nPassword reset functionality is now enabled.\\n\";\n    echo \"Users can request password resets at: /forgot-password\\n\";\n    \n} catch (Exception $e) {\n    die(\"Error: \" . $e->getMessage() . \"\\n\");\n}\n","path":null,"size_bytes":985,"size_tokens":null},"app/models/User.php":{"content":"<?php\n/**\n * User Model\n */\n\nrequire_once __DIR__ . '/../../config/database.php';\nrequire_once __DIR__ . '/../../config/constants.php';\n\nclass User {\n    private $db;\n    \n    public function __construct() {\n        $this->db = getDB();\n    }\n    \n    // Create new user\n    public function create($data) {\n        $sql = \"INSERT INTO users (name, email, password, type, mobile_no, verified) \n                VALUES (:name, :email, :password, :type, :mobile_no, :verified)\";\n        \n        $stmt = $this->db->prepare($sql);\n        $hashedPassword = password_hash($data['password'], PASSWORD_DEFAULT);\n        \n        $stmt->execute([\n            ':name' => $data['name'],\n            ':email' => $data['email'],\n            ':password' => $hashedPassword,\n            ':type' => $data['type'] ?? USER_TYPE_JOBSEEKER,\n            ':mobile_no' => $data['mobile_no'] ?? null,\n            ':verified' => $data['verified'] ?? 0\n        ]);\n        \n        return $this->db->lastInsertId();\n    }\n    \n    // Find user by email\n    public function findByEmail($email) {\n        $sql = \"SELECT * FROM users WHERE email = :email LIMIT 1\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':email' => $email]);\n        return $stmt->fetch();\n    }\n    \n    // Find user by ID\n    public function findById($id) {\n        $sql = \"SELECT * FROM users WHERE id = :id LIMIT 1\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':id' => $id]);\n        return $stmt->fetch();\n    }\n    \n    // Verify login credentials\n    public function verifyCredentials($email, $password) {\n        $user = $this->findByEmail($email);\n        \n        if ($user && password_verify($password, $user['password'])) {\n            return $user;\n        }\n        \n        return false;\n    }\n    \n    // Get all users (for admin)\n    public function getAll($filters = []) {\n        $sql = \"SELECT id, name, email, mobile_no, type, verified, created_at FROM users WHERE 1=1\";\n        $params = [];\n        \n        if (!empty($filters['type'])) {\n            $sql .= \" AND type = :type\";\n            $params[':type'] = $filters['type'];\n        }\n        \n        if (!empty($filters['search'])) {\n            $sql .= \" AND (name LIKE :search1 OR email LIKE :search2)\";\n            $params[':search1'] = '%' . $filters['search'] . '%';\n            $params[':search2'] = '%' . $filters['search'] . '%';\n        }\n        \n        $sql .= \" ORDER BY created_at DESC\";\n        \n        if (!empty($filters['limit'])) {\n            $sql .= \" LIMIT :limit OFFSET :offset\";\n        }\n        \n        $stmt = $this->db->prepare($sql);\n        \n        foreach ($params as $key => $value) {\n            $stmt->bindValue($key, $value);\n        }\n        \n        if (!empty($filters['limit'])) {\n            $stmt->bindValue(':limit', (int)$filters['limit'], PDO::PARAM_INT);\n            $stmt->bindValue(':offset', (int)($filters['offset'] ?? 0), PDO::PARAM_INT);\n        }\n        \n        $stmt->execute();\n        return $stmt->fetchAll();\n    }\n    \n    // Count users\n    public function count($filters = []) {\n        $sql = \"SELECT COUNT(*) as total FROM users WHERE 1=1\";\n        $params = [];\n        \n        if (!empty($filters['type'])) {\n            $sql .= \" AND type = :type\";\n            $params[':type'] = $filters['type'];\n        }\n        \n        $stmt = $this->db->prepare($sql);\n        $stmt->execute($params);\n        $result = $stmt->fetch();\n        return $result['total'];\n    }\n    \n    // Update user\n    public function update($id, $data) {\n        $fields = [];\n        $params = [':id' => $id];\n        \n        foreach ($data as $key => $value) {\n            if ($key === 'password') {\n                $fields[] = \"$key = :$key\";\n                $params[\":$key\"] = password_hash($value, PASSWORD_DEFAULT);\n            } elseif (in_array($key, ['name', 'email', 'type', 'verified', 'mobile_no'])) {\n                $fields[] = \"$key = :$key\";\n                $params[\":$key\"] = $value;\n            }\n        }\n        \n        if (empty($fields)) {\n            return false;\n        }\n        \n        $sql = \"UPDATE users SET \" . implode(', ', $fields) . \" WHERE id = :id\";\n        $stmt = $this->db->prepare($sql);\n        return $stmt->execute($params);\n    }\n    \n    // Delete user\n    public function delete($id) {\n        $sql = \"DELETE FROM users WHERE id = :id\";\n        $stmt = $this->db->prepare($sql);\n        return $stmt->execute([':id' => $id]);\n    }\n    \n    // Check email exists\n    public function emailExists($email, $excludeId = null) {\n        $sql = \"SELECT COUNT(*) as count FROM users WHERE email = :email\";\n        $params = [':email' => $email];\n        \n        if ($excludeId) {\n            $sql .= \" AND id != :id\";\n            $params[':id'] = $excludeId;\n        }\n        \n        $stmt = $this->db->prepare($sql);\n        $stmt->execute($params);\n        $result = $stmt->fetch();\n        return $result['count'] > 0;\n    }\n}\n","path":null,"size_bytes":4992,"size_tokens":null},"app/views/common/footer.php":{"content":"    </main>\n    \n    <footer class=\"bg-dark text-white mt-5 py-4\">\n        <div class=\"container\">\n            <div class=\"row\">\n                <div class=\"col-md-4\">\n                    <h5><i class=\"fas fa-briefcase\"></i> ConnectWith9</h5>\n                    <p>Your trusted job portal connecting job seekers with employers.</p>\n                </div>\n                <div class=\"col-md-4\">\n                    <h5>Quick Links</h5>\n                    <ul class=\"list-unstyled\">\n                        <li><a href=\"/jobs\" class=\"text-white-50\">Browse Jobs</a></li>\n                        <?php if (isset($currentUser) && $currentUser): ?>\n                            <li><a href=\"/logout\" class=\"text-white-50\">Logout</a></li>\n                        <?php else: ?>\n                            <li><a href=\"/register\" class=\"text-white-50\">Register</a></li>\n                            <li><a href=\"/login\" class=\"text-white-50\">Login</a></li>\n                        <?php endif; ?>\n                    </ul>\n                </div>\n                <div class=\"col-md-4\">\n                    <h5>Contact</h5>\n                    <p class=\"text-white-50\">\n                        Email: info@connectwith9.com<br>\n                        Phone: +91 1234567890\n                    </p>\n                </div>\n            </div>\n            <hr class=\"bg-secondary\">\n            <div class=\"text-center\">\n                <p class=\"mb-0\">&copy; 2025 ConnectWith9. All rights reserved.</p>\n            </div>\n        </div>\n    </footer>\n    \n    <?php if (isset($currentUser) && $currentUser && ($currentUser['status'] ?? 'active') === 'active' && ($currentUser['type'] ?? '') !== USER_TYPE_ADMIN): ?>\n    <div class=\"modal fade\" id=\"reportModal\" tabindex=\"-1\" aria-labelledby=\"reportModalLabel\" aria-hidden=\"true\">\n        <div class=\"modal-dialog\">\n            <div class=\"modal-content\">\n                <div class=\"modal-header\">\n                    <h5 class=\"modal-title\" id=\"reportModalLabel\"><i class=\"fas fa-flag text-danger\"></i> Report</h5>\n                    <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\" aria-label=\"Close\"></button>\n                </div>\n                <div class=\"modal-body\">\n                    <input type=\"hidden\" id=\"reportType\" value=\"\">\n                    <input type=\"hidden\" id=\"reportId\" value=\"\">\n                    <input type=\"hidden\" id=\"reportCsrfToken\" value=\"<?= getCSRFToken() ?>\">\n                    <div class=\"mb-3\">\n                        <label for=\"reportMessage\" class=\"form-label\">Why are you reporting this?</label>\n                        <textarea class=\"form-control\" id=\"reportMessage\" rows=\"4\" placeholder=\"Please describe the issue in detail (at least 10 characters)...\" required></textarea>\n                    </div>\n                    <div id=\"reportError\" class=\"alert alert-danger d-none\"></div>\n                    <div id=\"reportSuccess\" class=\"alert alert-success d-none\"></div>\n                </div>\n                <div class=\"modal-footer\">\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\n                    <button type=\"button\" class=\"btn btn-danger\" id=\"submitReportBtn\" onclick=\"submitReport()\">\n                        <i class=\"fas fa-flag\"></i> Submit Report\n                    </button>\n                </div>\n            </div>\n        </div>\n    </div>\n    <?php endif; ?>\n    \n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js\"></script>\n    <script src=\"<?= asset('js/app.js') ?>\"></script>\n    <script>\n        // Inject animation styles for button loader and page loader\n        if (!document.getElementById('spinner-styles')) {\n            var style = document.createElement('style');\n            style.id = 'spinner-styles';\n            style.innerHTML = `\n                @keyframes spinLoader {\n                    0% { transform: rotate(0deg); }\n                    100% { transform: rotate(360deg); }\n                }\n                .btn-loader-spinner {\n                    display: inline-block;\n                    width: 16px;\n                    height: 16px;\n                    border: 3px solid rgba(255, 255, 255, 0.2);\n                    border-top-color: white;\n                    border-right-color: white;\n                    border-radius: 50%;\n                    animation: spinLoader 0.8s linear infinite;\n                    margin-right: 10px;\n                    vertical-align: middle;\n                }\n                \n                /* Page Loader Overlay Styles */\n                .page-loader-overlay {\n                    position: fixed;\n                    top: 0;\n                    left: 0;\n                    width: 100%;\n                    height: 100%;\n                    background: transparent;\n                    z-index: 9999;\n                    display: flex;\n                    justify-content: center;\n                    align-items: center;\n                }\n                .page-loader-content {\n                    text-align: center;\n                }\n                .page-loader-spinner {\n                    width: 50px;\n                    height: 50px;\n                    border: 4px solid rgba(13, 110, 253, 0.3);\n                    border-top-color: #0d6efd;\n                    border-radius: 50%;\n                    animation: spinLoader 0.8s linear infinite;\n                    margin: 0 auto 10px;\n                }\n                .page-loader-text {\n                    color: #0d6efd;\n                    font-size: 14px;\n                    font-weight: 600;\n                    margin: 0;\n                }\n            `;\n            document.head.appendChild(style);\n        }\n        \n        // Determine loader text based on button\n        function getLoaderText(btn) {\n            if (!btn) return 'Processing...';\n            \n            var btnText = btn.textContent.trim().toLowerCase();\n            var classList = btn.className;\n            \n            // Check button class for action\n            if (classList.includes('btn-danger')) return 'Deleting...';\n            if (classList.includes('btn-warning')) return 'Updating...';\n            if (classList.includes('btn-success')) return 'Saving...';\n            if (classList.includes('btn-info')) return 'Loading...';\n            \n            // Check button text for action\n            if (btnText.includes('search')) return 'Searching...';\n            if (btnText.includes('delete')) return 'Deleting...';\n            if (btnText.includes('save')) return 'Saving...';\n            if (btnText.includes('update')) return 'Updating...';\n            if (btnText.includes('submit')) return 'Submitting...';\n            if (btnText.includes('register')) return 'Registering...';\n            if (btnText.includes('login')) return 'Loading...';\n            if (btnText.includes('approve')) return 'Approving...';\n            if (btnText.includes('reject')) return 'Rejecting...';\n            if (btnText.includes('apply')) return 'Applying...';\n            if (btnText.includes('post')) return 'Posting...';\n            if (btnText.includes('publish')) return 'Publishing...';\n            if (btnText.includes('cancel')) return 'Canceling...';\n            if (btnText.includes('confirm')) return 'Confirming...';\n            \n            return 'Processing...';\n        }\n        \n        // Add loader on form submission\n        document.addEventListener('submit', function(e) {\n            // Skip forms with no-loader class (like chat)\n            if (e.target.classList.contains('no-loader')) {\n                return;\n            }\n            \n            var btn = e.target.querySelector('button[type=\"submit\"]');\n            \n            if (!btn) return;\n            \n            // Check if already has loader\n            if (btn.querySelector('.btn-loader-spinner')) {\n                return;\n            }\n            \n            // Create and add spinner\n            var spinner = document.createElement('span');\n            spinner.className = 'btn-loader-spinner';\n            var loaderText = getLoaderText(btn);\n            \n            // Save original content\n            var originalHTML = btn.innerHTML;\n            btn.dataset.loaderOriginal = originalHTML;\n            \n            // Replace with spinner + text\n            btn.innerHTML = '';\n            btn.appendChild(spinner);\n            btn.appendChild(document.createTextNode(' ' + loaderText));\n            btn.disabled = true;\n        }, true);\n        \n        // Page loader for navigation links\n        (function() {\n            var pageLoader = document.getElementById('pageLoader');\n            var loaderText = pageLoader ? pageLoader.querySelector('.page-loader-text') : null;\n            \n            function showPageLoader(text) {\n                if (pageLoader) {\n                    if (loaderText) loaderText.textContent = text || 'Loading...';\n                    pageLoader.style.display = 'flex';\n                }\n            }\n            \n            function hidePageLoader() {\n                if (pageLoader) {\n                    pageLoader.style.display = 'none';\n                }\n            }\n            \n            // Hide loader when page loads (for back/forward navigation)\n            window.addEventListener('pageshow', hidePageLoader);\n            \n            // Get loader text based on link text\n            function getNavLoaderText(linkText) {\n                var text = linkText.toLowerCase().trim();\n                if (text.includes('dashboard')) return 'Loading Dashboard...';\n                if (text.includes('jobs') || text.includes('browse jobs')) return 'Loading Jobs...';\n                if (text.includes('candidates')) return 'Loading Candidates...';\n                if (text.includes('profile')) return 'Loading Profile...';\n                if (text.includes('applications')) return 'Loading Applications...';\n                if (text.includes('login')) return 'Loading...';\n                if (text.includes('register')) return 'Loading...';\n                if (text.includes('logout')) return 'Logging out...';\n                if (text.includes('home')) return 'Loading...';\n                if (text.includes('post job')) return 'Loading...';\n                if (text.includes('users')) return 'Loading Users...';\n                return 'Loading...';\n            }\n            \n            // Add click handler to navbar and footer links\n            document.addEventListener('click', function(e) {\n                var link = e.target.closest('a');\n                \n                if (!link) return;\n                \n                // Skip if it's a dropdown toggle, hash link, or external link\n                if (link.getAttribute('data-bs-toggle') === 'dropdown') return;\n                if (link.getAttribute('href') === '#') return;\n                if (link.getAttribute('target') === '_blank') return;\n                \n                var href = link.getAttribute('href');\n                if (!href || href.startsWith('#') || href.startsWith('javascript:')) return;\n                \n                // Check if link is in navbar or footer quick links\n                var isNavLink = link.closest('.navbar') !== null;\n                var isFooterLink = link.closest('footer') !== null;\n                var isDropdownItem = link.classList.contains('dropdown-item');\n                \n                if (isNavLink || isFooterLink || isDropdownItem) {\n                    var linkText = link.textContent.trim();\n                    showPageLoader(getNavLoaderText(linkText));\n                }\n            }, true);\n        })();\n        \n        // Button loader for specific action buttons to prevent double-click\n        (function() {\n            var loadingButtons = [\n                'manage users', 'manage jobs', 'review jobs', 'view jobs',\n                'browse jobs', 'register now', 'view details', 'view all jobs'\n            ];\n            \n            function shouldShowButtonLoader(btnText) {\n                var text = btnText.toLowerCase().trim();\n                return loadingButtons.some(function(loadBtn) {\n                    return text === loadBtn || text.includes(loadBtn);\n                });\n            }\n            \n            document.addEventListener('click', function(e) {\n                var btn = e.target.closest('a.btn, button.btn');\n                \n                if (!btn) return;\n                \n                // Skip if already loading\n                if (btn.classList.contains('btn-loading')) return;\n                if (btn.querySelector('.btn-loader-spinner')) return;\n                \n                var btnText = btn.textContent.trim();\n                \n                if (shouldShowButtonLoader(btnText)) {\n                    // Prevent double click\n                    btn.classList.add('btn-loading');\n                    \n                    // Save original content\n                    var originalHTML = btn.innerHTML;\n                    btn.dataset.loaderOriginal = originalHTML;\n                    \n                    // Create spinner\n                    var spinner = document.createElement('span');\n                    spinner.className = 'btn-loader-spinner';\n                    \n                    // Replace content\n                    btn.innerHTML = '';\n                    btn.appendChild(spinner);\n                    btn.appendChild(document.createTextNode(' Loading...'));\n                    \n                    // Disable pointer events\n                    btn.style.pointerEvents = 'none';\n                    btn.style.opacity = '0.7';\n                }\n            }, true);\n            \n            // Reset buttons when page shows (for back/forward navigation)\n            window.addEventListener('pageshow', function() {\n                document.querySelectorAll('.btn-loading').forEach(function(btn) {\n                    if (btn.dataset.loaderOriginal) {\n                        btn.innerHTML = btn.dataset.loaderOriginal;\n                        delete btn.dataset.loaderOriginal;\n                    }\n                    btn.classList.remove('btn-loading');\n                    btn.style.pointerEvents = '';\n                    btn.style.opacity = '';\n                });\n            });\n        })();\n        \n        // Report functionality\n        function openReportModal(type, id) {\n            document.getElementById('reportType').value = type;\n            document.getElementById('reportId').value = id;\n            document.getElementById('reportMessage').value = '';\n            document.getElementById('reportError').classList.add('d-none');\n            document.getElementById('reportSuccess').classList.add('d-none');\n            document.getElementById('submitReportBtn').disabled = false;\n            var modal = new bootstrap.Modal(document.getElementById('reportModal'));\n            modal.show();\n        }\n        \n        function submitReport() {\n            var type = document.getElementById('reportType').value;\n            var id = document.getElementById('reportId').value;\n            var message = document.getElementById('reportMessage').value.trim();\n            var csrfToken = document.getElementById('reportCsrfToken').value;\n            var errorDiv = document.getElementById('reportError');\n            var successDiv = document.getElementById('reportSuccess');\n            var btn = document.getElementById('submitReportBtn');\n            \n            errorDiv.classList.add('d-none');\n            successDiv.classList.add('d-none');\n            \n            if (message.length < 10) {\n                errorDiv.textContent = 'Please provide at least 10 characters describing the issue.';\n                errorDiv.classList.remove('d-none');\n                return;\n            }\n            \n            btn.disabled = true;\n            btn.innerHTML = '<span class=\"btn-loader-spinner\"></span> Submitting...';\n            \n            var formData = new FormData();\n            formData.append('reported_type', type);\n            formData.append('reported_id', id);\n            formData.append('message', message);\n            formData.append('csrf_token', csrfToken);\n            \n            fetch('/report/submit', {\n                method: 'POST',\n                body: formData\n            })\n            .then(function(response) { \n                if (!response.ok) {\n                    throw new Error('Network response was not ok');\n                }\n                return response.json(); \n            })\n            .then(function(data) {\n                if (data.error) {\n                    errorDiv.textContent = data.error;\n                    errorDiv.classList.remove('d-none');\n                    btn.disabled = false;\n                    btn.innerHTML = '<i class=\"fas fa-flag\"></i> Submit Report';\n                } else {\n                    successDiv.textContent = data.message;\n                    successDiv.classList.remove('d-none');\n                    setTimeout(function() {\n                        bootstrap.Modal.getInstance(document.getElementById('reportModal')).hide();\n                    }, 2000);\n                }\n            })\n            .catch(function(err) {\n                console.error('Report error:', err);\n                errorDiv.textContent = 'An error occurred. Please try again.';\n                errorDiv.classList.remove('d-none');\n                btn.disabled = false;\n                btn.innerHTML = '<i class=\"fas fa-flag\"></i> Submit Report';\n            });\n        }\n        \n        <?php if (isset($currentUser) && $currentUser && $currentUser['type'] !== USER_TYPE_ADMIN): ?>\n        // Notification and Chat polling (for non-admin users only)\n        (function() {\n            var notificationBadge = document.getElementById('notificationBadge');\n            var notificationBadgeMobile = document.getElementById('notificationBadgeMobile');\n            var chatBadge = document.getElementById('chatBadge');\n            var chatBadgeMobile = document.getElementById('chatBadgeMobile');\n            var notificationList = document.getElementById('notificationList');\n            var notificationListMobile = document.getElementById('notificationListMobile');\n            var lastPollTime = new Date().toISOString().slice(0, 19).replace('T', ' ');\n            \n            function updateNotificationBadge(count) {\n                var badges = [notificationBadge, notificationBadgeMobile];\n                badges.forEach(function(badge) {\n                    if (badge) {\n                        if (count > 0) {\n                            badge.textContent = count > 99 ? '99+' : count;\n                            badge.style.display = 'inline-block';\n                        } else {\n                            badge.style.display = 'none';\n                        }\n                    }\n                });\n            }\n            \n            function updateChatBadge(count) {\n                var badges = [chatBadge, chatBadgeMobile];\n                badges.forEach(function(badge) {\n                    if (badge) {\n                        if (count > 0) {\n                            badge.textContent = count > 99 ? '99+' : count;\n                            badge.style.display = 'inline-block';\n                        } else {\n                            badge.style.display = 'none';\n                        }\n                    }\n                });\n            }\n            \n            function formatTimeAgo(dateString) {\n                var date = new Date(dateString);\n                var now = new Date();\n                var seconds = Math.floor((now - date) / 1000);\n                \n                if (seconds < 60) return 'Just now';\n                if (seconds < 3600) return Math.floor(seconds / 60) + 'm ago';\n                if (seconds < 86400) return Math.floor(seconds / 3600) + 'h ago';\n                if (seconds < 604800) return Math.floor(seconds / 86400) + 'd ago';\n                return date.toLocaleDateString();\n            }\n            \n            function getNotificationIcon(type) {\n                switch(type) {\n                    case 'job_selected': return 'fa-trophy text-success';\n                    case 'new_job': return 'fa-briefcase text-primary';\n                    case 'chat_message': return 'fa-comment text-info';\n                    case 'system': return 'fa-cog text-warning';\n                    default: return 'fa-bell text-secondary';\n                }\n            }\n            \n            function renderNotifications(notifications, unreadCount) {\n                var lists = [notificationList, notificationListMobile];\n                \n                lists.forEach(function(list) {\n                    if (!list) return;\n                    \n                    if (notifications.length === 0) {\n                        list.innerHTML = '<div class=\"text-center py-3 text-muted\">No notifications yet</div>';\n                        return;\n                    }\n                    \n                    var html = '';\n                    notifications.slice(0, 5).forEach(function(n) {\n                        var iconClass = getNotificationIcon(n.type);\n                        var readClass = n.is_read == 0 ? 'bg-light' : '';\n                        html += '<div class=\"dropdown-item ' + readClass + '\" style=\"white-space: normal; padding: 10px 15px; cursor: pointer;\">';\n                        html += '<div class=\"d-flex align-items-start\">';\n                        html += '<i class=\"fas ' + iconClass + ' me-2 mt-1\"></i>';\n                        html += '<div class=\"flex-grow-1\">';\n                        html += '<strong style=\"font-size: 0.9rem;\">' + escapeHtml(n.title) + '</strong>';\n                        html += '<p class=\"mb-0 text-muted\" style=\"font-size: 0.8rem;\">' + escapeHtml(n.message).substring(0, 50) + '...</p>';\n                        html += '<small class=\"text-muted\">' + formatTimeAgo(n.created_at) + '</small>';\n                        html += '</div></div></div>';\n                    });\n                    \n                    list.innerHTML = html;\n                });\n            }\n            \n            function escapeHtml(text) {\n                var div = document.createElement('div');\n                div.appendChild(document.createTextNode(text));\n                return div.innerHTML;\n            }\n            \n            function loadRecentNotifications() {\n                fetch('/notifications/recent')\n                    .then(function(response) { return response.json(); })\n                    .then(function(data) {\n                        if (data.error) return;\n                        updateNotificationBadge(data.unread_count);\n                        renderNotifications(data.notifications, data.unread_count);\n                    })\n                    .catch(function(err) { console.log('Notification fetch error:', err); });\n            }\n            \n            function loadChatUnreadCount() {\n                fetch('/chat/unread-count')\n                    .then(function(response) { return response.json(); })\n                    .then(function(data) {\n                        if (data.error) return;\n                        updateChatBadge(data.count);\n                    })\n                    .catch(function(err) { console.log('Chat count fetch error:', err); });\n            }\n            \n            function pollForUpdates() {\n                fetch('/notifications/poll?since=' + encodeURIComponent(lastPollTime))\n                    .then(function(response) { return response.json(); })\n                    .then(function(data) {\n                        if (data.error) return;\n                        updateNotificationBadge(data.unread_count);\n                        if (data.timestamp) lastPollTime = data.timestamp;\n                        \n                        // Show browser notification for new items\n                        if (data.notifications && data.notifications.length > 0) {\n                            loadRecentNotifications();\n                        }\n                    })\n                    .catch(function(err) { console.log('Poll error:', err); });\n            }\n            \n            // Initial load\n            loadRecentNotifications();\n            loadChatUnreadCount();\n            \n            // Poll every 30 seconds\n            setInterval(function() {\n                pollForUpdates();\n                loadChatUnreadCount();\n            }, 30000);\n            \n            // Expose mark all as read function\n            window.markAllNotificationsRead = function() {\n                fetch('/notifications/mark-all-read', { method: 'POST' })\n                    .then(function(response) { return response.json(); })\n                    .then(function(data) {\n                        if (data.success) {\n                            updateNotificationBadge(0);\n                            loadRecentNotifications();\n                        }\n                    })\n                    .catch(function(err) { console.log('Mark read error:', err); });\n            };\n        })();\n        <?php endif; ?>\n        \n        // Enable click-outside-to-close for all modals (especially for mobile)\n        document.addEventListener('DOMContentLoaded', function() {\n            // All Bootstrap modals with default backdrop behavior will close on outside click\n            // This ensures modals are configured correctly\n            var modals = document.querySelectorAll('.modal');\n            modals.forEach(function(modal) {\n                // Remove any static backdrop that prevents clicking outside to close\n                modal.removeAttribute('data-bs-backdrop');\n                \n                // Add click handler on modal backdrop for mobile touch devices\n                modal.addEventListener('click', function(e) {\n                    if (e.target === modal) {\n                        var modalInstance = bootstrap.Modal.getInstance(modal);\n                        if (modalInstance) {\n                            modalInstance.hide();\n                        }\n                    }\n                });\n            });\n        });\n    </script>\n</body>\n</html>\n","path":null,"size_bytes":26390,"size_tokens":null},"app/views/auth/forgot-password.php":{"content":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Forgot Password - <?= APP_NAME ?></title>\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n    <link href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\" rel=\"stylesheet\">\n</head>\n<body class=\"bg-light\">\n    <?php require __DIR__ . '/../common/header.php'; ?>\n    \n    <div class=\"container mt-5\">\n        <div class=\"row justify-content-center\">\n            <div class=\"col-md-5\">\n                <div class=\"card shadow\">\n                    <div class=\"card-body p-4\">\n                        <div class=\"text-center mb-4\">\n                            <i class=\"fas fa-key fa-3x text-primary mb-3\"></i>\n                            <h2 class=\"mb-2\">Forgot Password?</h2>\n                            <p class=\"text-muted\">Enter your email address and we'll send you a link to reset your password.</p>\n                        </div>\n                        \n                        <?php if (hasFlash('error')): ?>\n                            <div class=\"alert alert-danger\"><?= getFlash('error') ?></div>\n                        <?php endif; ?>\n                        \n                        <?php if (hasFlash('success')): ?>\n                            <div class=\"alert alert-success\"><?= getFlash('success') ?></div>\n                        <?php endif; ?>\n                        \n                        <form method=\"POST\" action=\"/forgot-password\">\n                            <?= csrfField() ?>\n                            \n                            <div class=\"mb-3\">\n                                <label for=\"email\" class=\"form-label\">Email Address</label>\n                                <input type=\"email\" class=\"form-control\" id=\"email\" name=\"email\" \n                                       placeholder=\"Enter your registered email\" required>\n                            </div>\n                            \n                            <button type=\"submit\" class=\"btn btn-primary w-100\">\n                                <i class=\"fas fa-paper-plane me-2\"></i>Send Reset Link\n                            </button>\n                        </form>\n                        \n                        <hr class=\"my-4\">\n                        \n                        <div class=\"text-center\">\n                            <p class=\"mb-0\">\n                                Remember your password? <a href=\"/login\">Login here</a>\n                            </p>\n                            <p class=\"mt-2\">\n                                Don't have an account? <a href=\"/register\">Register here</a>\n                            </p>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class=\"card mt-3 bg-info bg-opacity-10 border-info\">\n                    <div class=\"card-body\">\n                        <h6 class=\"card-title\"><i class=\"fas fa-info-circle me-2\"></i>Password Reset Instructions</h6>\n                        <ul class=\"small mb-0\">\n                            <li>Enter your registered email address</li>\n                            <li>Check your inbox for a reset link</li>\n                            <li>Click the link within 1 hour (link expires after that)</li>\n                            <li>Create a new strong password</li>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <?php require __DIR__ . '/../common/footer.php'; ?>\n</body>\n</html>\n","path":null,"size_bytes":3671,"size_tokens":null},"app/views/admin/jobs.php":{"content":"<?php\n$meta = generateMetaTags('Manage Jobs - Admin', 'Manage job postings');\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container\">\n    <h1 class=\"mb-4\">Manage Jobs</h1>\n    \n    <?php if ($success = getFlash('success')): ?>\n        <div class=\"alert alert-success\"><?= $success ?></div>\n    <?php endif; ?>\n    \n    <div class=\"card\">\n        <div class=\"card-header\">\n            <form action=\"/admin/jobs\" method=\"GET\" class=\"row g-2\">\n                <div class=\"col-md-4\">\n                    <select name=\"status\" class=\"form-select\">\n                        <option value=\"\">All Status</option>\n                        <option value=\"Pending\" <?= (isset($_GET['status']) && $_GET['status'] === 'Pending') ? 'selected' : '' ?>>Pending</option>\n                        <option value=\"Approved\" <?= (isset($_GET['status']) && $_GET['status'] === 'Approved') ? 'selected' : '' ?>>Approved</option>\n                        <option value=\"Rejected\" <?= (isset($_GET['status']) && $_GET['status'] === 'Rejected') ? 'selected' : '' ?>>Rejected</option>\n                    </select>\n                </div>\n                <div class=\"col-md-2\">\n                    <button type=\"submit\" class=\"btn btn-primary\">Filter</button>\n                </div>\n            </form>\n        </div>\n        <div class=\"card-body\">\n            <div class=\"table-responsive\">\n                <table class=\"table table-striped\">\n                    <thead>\n                        <tr>\n                            <th>ID</th>\n                            <th>Title</th>\n                            <th>Employer</th>\n                            <th>Location</th>\n                            <th>Status</th>\n                            <th>Posted</th>\n                            <th>Actions</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <?php foreach ($jobs as $job): ?>\n                        <tr>\n                            <td><?= $job['id'] ?></td>\n                            <td><?= htmlspecialchars($job['title']) ?></td>\n                            <td><?= htmlspecialchars($job['employer_name']) ?></td>\n                            <td><?= htmlspecialchars($job['location']) ?></td>\n                            <td>\n                                <span class=\"badge bg-<?= $job['status'] === 'Approved' ? 'success' : ($job['status'] === 'Pending' ? 'warning' : 'danger') ?>\">\n                                    <?= $job['status'] ?>\n                                </span>\n                            </td>\n                            <td><?= formatDate($job['created_at']) ?></td>\n                            <td>\n                                <a href=\"/admin/jobs/<?= $job['id'] ?>\" class=\"btn btn-sm btn-info\">View</a>\n                                <?php if ($job['status'] === 'Pending'): ?>\n                                    <form action=\"/admin/jobs/<?= $job['id'] ?>/approve\" method=\"POST\" class=\"d-inline\">\n                                        <?= csrfField() ?>\n                                        <button type=\"submit\" class=\"btn btn-sm btn-success\">Approve</button>\n                                    </form>\n                                    <form action=\"/admin/jobs/<?= $job['id'] ?>/reject\" method=\"POST\" class=\"d-inline\">\n                                        <?= csrfField() ?>\n                                        <button type=\"submit\" class=\"btn btn-sm btn-warning\">Reject</button>\n                                    </form>\n                                <?php endif; ?>\n                                <form action=\"/admin/jobs/<?= $job['id'] ?>/delete\" method=\"POST\" class=\"d-inline\" onsubmit=\"return confirm('Are you sure?')\">\n                                    <?= csrfField() ?>\n                                    <button type=\"submit\" class=\"btn btn-sm btn-danger\">Delete</button>\n                                </form>\n                            </td>\n                        </tr>\n                        <?php endforeach; ?>\n                    </tbody>\n                </table>\n            </div>\n            \n            <?php if ($pagination['total_pages'] > 1): ?>\n            <nav>\n                <ul class=\"pagination justify-content-center\">\n                    <?php for ($i = 1; $i <= $pagination['total_pages']; $i++): ?>\n                        <li class=\"page-item <?= $i === $pagination['current_page'] ? 'active' : '' ?>\">\n                            <a class=\"page-link\" href=\"?page=<?= $i ?><?= !empty($_GET['status']) ? '&status=' . $_GET['status'] : '' ?>\">\n                                <?= $i ?>\n                            </a>\n                        </li>\n                    <?php endfor; ?>\n                </ul>\n            </nav>\n            <?php endif; ?>\n        </div>\n    </div>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":4910,"size_tokens":null},"app/controllers/AuthController.php":{"content":"<?php\n/**\n * Authentication Controller\n */\n\nrequire_once __DIR__ . '/../../config/database.php';\nrequire_once __DIR__ . '/../../config/constants.php';\nrequire_once __DIR__ . '/../../includes/functions.php';\nrequire_once __DIR__ . '/../../includes/csrf.php';\nrequire_once __DIR__ . '/../../app/models/User.php';\n\nclass AuthController {\n    private $userModel;\n    \n    public function __construct() {\n        $this->userModel = new User();\n    }\n    \n    // Show login form\n    public function showLogin() {\n        if (isLoggedIn()) {\n            $user = getCurrentUser();\n            $this->redirectToDashboard($user['type']);\n        }\n        \n        require __DIR__ . '/../views/auth/login.php';\n    }\n    \n    // Handle login\n    public function login() {\n        checkCSRF();\n        \n        $email = sanitize($_POST['email'] ?? '');\n        $password = $_POST['password'] ?? '';\n        \n        // Check login attempts\n        if ($this->isLoginLocked(getClientIP())) {\n            setFlash('error', 'Too many login attempts. Please try again in 15 minutes.');\n            redirect('/login');\n        }\n        \n        // Validate\n        if (empty($email) || empty($password)) {\n            setFlash('error', 'All fields are required');\n            redirect('/login');\n        }\n        \n        // Verify credentials\n        $user = $this->userModel->verifyCredentials($email, $password);\n        \n        if (!$user) {\n            $this->recordLoginAttempt(getClientIP());\n            setFlash('error', ERROR_INVALID_CREDENTIALS);\n            redirect('/login');\n        }\n        \n        // Create session\n        initSession();\n        $_SESSION['user_id'] = $user['id'];\n        $_SESSION['user_type'] = $user['type'];\n        $_SESSION['user_name'] = $user['name'];\n        $_SESSION['fingerprint'] = getSessionFingerprint();\n        \n        // Clear login attempts\n        $this->clearLoginAttempts(getClientIP());\n        \n        setFlash('success', SUCCESS_LOGIN);\n        $this->redirectToDashboard($user['type']);\n    }\n    \n    // Show registration form\n    public function showRegister() {\n        if (isLoggedIn()) {\n            $user = getCurrentUser();\n            $this->redirectToDashboard($user['type']);\n        }\n        \n        require __DIR__ . '/../views/auth/register.php';\n    }\n    \n    // Handle registration\n    public function register() {\n        checkCSRF();\n        \n        $name = sanitize($_POST['name'] ?? '');\n        $email = sanitize($_POST['email'] ?? '');\n        $mobile_no = sanitize($_POST['mobile_no'] ?? '');\n        $password = $_POST['password'] ?? '';\n        $confirmPassword = $_POST['confirm_password'] ?? '';\n        $type = sanitize($_POST['type'] ?? USER_TYPE_JOBSEEKER);\n        \n        // Validate\n        $errors = [];\n        \n        if (empty($name) || empty($email) || empty($password)) {\n            $errors[] = 'All fields are required';\n        }\n        \n        if (!isValidEmail($email)) {\n            $errors[] = 'Invalid email address';\n        }\n        \n        if (strlen($password) < 6) {\n            $errors[] = 'Password must be at least 6 characters';\n        }\n        \n        if ($password !== $confirmPassword) {\n            $errors[] = 'Passwords do not match';\n        }\n        \n        if ($this->userModel->emailExists($email)) {\n            $errors[] = ERROR_EMAIL_EXISTS;\n        }\n        \n        if (!in_array($type, [USER_TYPE_JOBSEEKER, USER_TYPE_EMPLOYER])) {\n            $errors[] = 'Invalid user type';\n        }\n        \n        if (!empty($errors)) {\n            setFlash('error', implode('<br>', $errors));\n            redirect('/register');\n        }\n        \n        // Create user\n        $userId = $this->userModel->create([\n            'name' => $name,\n            'email' => $email,\n            'password' => $password,\n            'type' => $type,\n            'mobile_no' => $mobile_no,\n            'verified' => 1 // Auto-verify for now\n        ]);\n        \n        if ($userId) {\n            setFlash('success', SUCCESS_REGISTER);\n            redirect('/login');\n        } else {\n            setFlash('error', 'Registration failed. Please try again.');\n            redirect('/register');\n        }\n    }\n    \n    // Logout\n    public function logout() {\n        initSession();\n        session_destroy();\n        redirect('/');\n    }\n    \n    // Record login attempt\n    private function recordLoginAttempt($ip) {\n        $db = getDB();\n        $sql = \"INSERT INTO login_attempts (ip_address) VALUES (:ip)\";\n        $stmt = $db->prepare($sql);\n        $stmt->execute([':ip' => $ip]);\n    }\n    \n    // Clear login attempts\n    private function clearLoginAttempts($ip) {\n        $db = getDB();\n        $sql = \"DELETE FROM login_attempts WHERE ip_address = :ip\";\n        $stmt = $db->prepare($sql);\n        $stmt->execute([':ip' => $ip]);\n    }\n    \n    // Check if login is locked\n    private function isLoginLocked($ip) {\n        $db = getDB();\n        $sql = \"SELECT COUNT(*) as attempts FROM login_attempts \n                WHERE ip_address = :ip \n                AND attempt_time > DATE_SUB(NOW(), INTERVAL 15 MINUTE)\";\n        \n        $stmt = $db->prepare($sql);\n        $stmt->execute([':ip' => $ip]);\n        $result = $stmt->fetch();\n        \n        return $result['attempts'] >= MAX_LOGIN_ATTEMPTS;\n    }\n    \n    // Redirect to appropriate dashboard\n    private function redirectToDashboard($userType) {\n        switch ($userType) {\n            case USER_TYPE_ADMIN:\n                redirect('/admin/dashboard');\n                break;\n            case USER_TYPE_EMPLOYER:\n                redirect('/employer/dashboard');\n                break;\n            case USER_TYPE_JOBSEEKER:\n            default:\n                redirect('/jobseeker/dashboard');\n                break;\n        }\n    }\n    \n    // Show forgot password form\n    public function showForgotPassword() {\n        if (isLoggedIn()) {\n            redirect('/');\n        }\n        \n        require __DIR__ . '/../views/auth/forgot-password.php';\n    }\n    \n    // Handle password reset request\n    public function requestPasswordReset() {\n        checkCSRF();\n        \n        $email = sanitize($_POST['email'] ?? '');\n        \n        if (empty($email) || !isValidEmail($email)) {\n            setFlash('error', 'Please enter a valid email address');\n            redirect('/forgot-password');\n        }\n        \n        $user = $this->userModel->findByEmail($email);\n        \n        if (!$user) {\n            // Don't reveal if email exists - security best practice\n            setFlash('success', 'If an account exists with this email, you will receive a password reset link shortly.');\n            redirect('/forgot-password');\n        }\n        \n        // Generate reset token\n        $token = bin2hex(random_bytes(32));\n        $expiresAt = date('Y-m-d H:i:s', strtotime('+1 hour'));\n        \n        // Store token in database\n        $db = getDB();\n        \n        // Delete any existing tokens for this email\n        $sql = \"DELETE FROM password_reset_tokens WHERE email = :email\";\n        $stmt = $db->prepare($sql);\n        $stmt->execute([':email' => $email]);\n        \n        // Insert new token\n        $sql = \"INSERT INTO password_reset_tokens (email, token, expires_at) \n                VALUES (:email, :token, :expires_at)\";\n        $stmt = $db->prepare($sql);\n        $stmt->execute([\n            ':email' => $email,\n            ':token' => $token,\n            ':expires_at' => $expiresAt\n        ]);\n        \n        // Send reset email\n        require_once __DIR__ . '/../../includes/email.php';\n        sendPasswordResetEmail($user['email'], $user['name'], $token);\n        \n        setFlash('success', 'If an account exists with this email, you will receive a password reset link shortly.');\n        redirect('/forgot-password');\n    }\n    \n    // Show reset password form\n    public function showResetPassword() {\n        if (isLoggedIn()) {\n            redirect('/');\n        }\n        \n        $token = sanitize($_GET['token'] ?? '');\n        \n        if (empty($token)) {\n            setFlash('error', 'Invalid reset link');\n            redirect('/forgot-password');\n        }\n        \n        // Verify token exists and hasn't expired\n        if (!$this->verifyResetToken($token)) {\n            setFlash('error', 'This reset link is invalid or has expired. Please request a new one.');\n            redirect('/forgot-password');\n        }\n        \n        require __DIR__ . '/../views/auth/reset-password.php';\n    }\n    \n    // Handle password reset\n    public function resetPassword() {\n        checkCSRF();\n        \n        $token = sanitize($_POST['token'] ?? '');\n        $password = $_POST['password'] ?? '';\n        $confirmPassword = $_POST['confirm_password'] ?? '';\n        \n        // Validate\n        if (empty($password) || empty($confirmPassword)) {\n            setFlash('error', 'All fields are required');\n            redirect('/reset-password?token=' . $token);\n        }\n        \n        if (strlen($password) < 6) {\n            setFlash('error', 'Password must be at least 6 characters');\n            redirect('/reset-password?token=' . $token);\n        }\n        \n        if ($password !== $confirmPassword) {\n            setFlash('error', 'Passwords do not match');\n            redirect('/reset-password?token=' . $token);\n        }\n        \n        // Verify token\n        $resetData = $this->getResetTokenData($token);\n        \n        if (!$resetData) {\n            setFlash('error', 'This reset link is invalid or has expired. Please request a new one.');\n            redirect('/forgot-password');\n        }\n        \n        // Update password\n        $user = $this->userModel->findByEmail($resetData['email']);\n        \n        if (!$user) {\n            setFlash('error', 'User not found');\n            redirect('/forgot-password');\n        }\n        \n        $this->userModel->update($user['id'], ['password' => $password]);\n        \n        // Delete used token\n        $db = getDB();\n        $sql = \"DELETE FROM password_reset_tokens WHERE token = :token\";\n        $stmt = $db->prepare($sql);\n        $stmt->execute([':token' => $token]);\n        \n        setFlash('success', 'Your password has been reset successfully. You can now login with your new password.');\n        redirect('/login');\n    }\n    \n    // Verify reset token is valid\n    private function verifyResetToken($token) {\n        $data = $this->getResetTokenData($token);\n        return $data !== null;\n    }\n    \n    // Get reset token data if valid\n    private function getResetTokenData($token) {\n        $db = getDB();\n        $sql = \"SELECT * FROM password_reset_tokens \n                WHERE token = :token \n                AND expires_at > NOW() \n                LIMIT 1\";\n        \n        $stmt = $db->prepare($sql);\n        $stmt->execute([':token' => $token]);\n        $result = $stmt->fetch();\n        \n        return $result ?: null;\n    }\n}\n","path":null,"size_bytes":10978,"size_tokens":null},"config/env.php":{"content":"<?php\n/**\n * Environment Configuration\n * Database credentials and API keys\n * \n * IMPORTANT: For production, set these values as environment variables\n * and remove the default values below.\n */\n\n// Database Configuration\n// Set these as environment variables in production\ndefine('DB_HOST', getenv('DB_HOST') ?: 'srv1642.hstgr.io');\ndefine('DB_NAME', getenv('DB_NAME') ?: 'u647904474_connect9job');\ndefine('DB_USER', getenv('DB_USER') ?: 'u647904474_connect9job');\ndefine('DB_PASS', getenv('DB_PASS') ?: 'Hostinger@1234#');\n\n// Application Settings\ndefine('APP_NAME', 'ConnectWith9 Job Portal');\ndefine('APP_URL', getenv('APP_URL') ?: 'http://localhost:5000');\ndefine('APP_ENV', getenv('APP_ENV') ?: 'development'); // development or production\n\n// reCAPTCHA Keys (Add your own keys via environment variables)\ndefine('RECAPTCHA_SITE_KEY', getenv('RECAPTCHA_SITE_KEY') ?: '');\ndefine('RECAPTCHA_SECRET_KEY', getenv('RECAPTCHA_SECRET_KEY') ?: '');\n\n// SMTP Configuration (for email notifications)\ndefine('SMTP_HOST', getenv('SMTP_HOST') ?: 'smtp.gmail.com');\ndefine('SMTP_USER', getenv('SMTP_USER') ?: '');\ndefine('SMTP_PASS', getenv('SMTP_PASS') ?: '');\ndefine('SMTP_PORT', getenv('SMTP_PORT') ?: 587);\n\n// File Upload Settings\ndefine('MAX_FILE_SIZE', 5242880); // 5MB in bytes\ndefine('ALLOWED_RESUME_TYPES', ['pdf', 'doc', 'docx', 'txt']);\ndefine('UPLOAD_PATH', __DIR__ . '/../public/uploads/');\n\n// Security Settings\ndefine('SESSION_LIFETIME', 3600); // 1 hour\ndefine('MAX_LOGIN_ATTEMPTS', 5);\ndefine('LOGIN_LOCKOUT_TIME', 900); // 15 minutes\n","path":null,"size_bytes":1546,"size_tokens":null},"app/views/auth/register.php":{"content":"<?php\n$meta = generateMetaTags('Register', 'Create your ConnectWith9 account');\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container\">\n    <div class=\"row justify-content-center\">\n        <div class=\"col-md-8\">\n            <div class=\"card shadow\">\n                <div class=\"card-body p-5\">\n                    <h2 class=\"text-center mb-4\">Create Account</h2>\n                    \n                    <?php if ($error = getFlash('error')): ?>\n                        <div class=\"alert alert-danger\"><?= $error ?></div>\n                    <?php endif; ?>\n                    \n                    <form action=\"/register\" method=\"POST\">\n                        <?= csrfField() ?>\n                        \n                        <div class=\"row\">\n                            <div class=\"col-md-6 mb-3\">\n                                <label for=\"name\" class=\"form-label\">Full Name</label>\n                                <input type=\"text\" class=\"form-control\" id=\"name\" name=\"name\" required>\n                            </div>\n                            \n                            <div class=\"col-md-6 mb-3\">\n                                <label for=\"email\" class=\"form-label\">Email Address</label>\n                                <input type=\"email\" class=\"form-control\" id=\"email\" name=\"email\" required>\n                            </div>\n                        </div>\n                        \n                        <div class=\"row\">\n                            <div class=\"col-md-6 mb-3\">\n                                <label for=\"mobile_no\" class=\"form-label\">Mobile Number</label>\n                                <input type=\"tel\" class=\"form-control\" id=\"mobile_no\" name=\"mobile_no\" placeholder=\"+91 1234567890\">\n                            </div>\n                            \n                            <div class=\"col-md-6 mb-3\">\n                                <label class=\"form-label\">Account Type</label>\n                                <div>\n                                    <div class=\"form-check form-check-inline\">\n                                        <input class=\"form-check-input\" type=\"radio\" name=\"type\" id=\"jobseeker\" value=\"jobseeker\" checked>\n                                        <label class=\"form-check-label\" for=\"jobseeker\">\n                                            <i class=\"fas fa-user\"></i> Job Seeker\n                                        </label>\n                                    </div>\n                                    <div class=\"form-check form-check-inline\">\n                                        <input class=\"form-check-input\" type=\"radio\" name=\"type\" id=\"employer\" value=\"employer\">\n                                        <label class=\"form-check-label\" for=\"employer\">\n                                            <i class=\"fas fa-building\"></i> Employer\n                                        </label>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                        \n                        <div class=\"row\">\n                            <div class=\"col-md-6 mb-3\">\n                                <label for=\"password\" class=\"form-label\">Password</label>\n                                <input type=\"password\" class=\"form-control\" id=\"password\" name=\"password\" required minlength=\"6\">\n                            </div>\n                            \n                            <div class=\"col-md-6 mb-3\">\n                                <label for=\"confirm_password\" class=\"form-label\">Confirm Password</label>\n                                <input type=\"password\" class=\"form-control\" id=\"confirm_password\" name=\"confirm_password\" required>\n                            </div>\n                        </div>\n                        \n                        <button type=\"submit\" class=\"btn btn-primary w-100\">Register</button>\n                    </form>\n                    \n                    <div class=\"text-center mt-3\">\n                        <p>Already have an account? <a href=\"/login\">Login here</a></p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":4274,"size_tokens":null},"app/views/jobseeker/profile.php":{"content":"<?php\n$meta = generateMetaTags('My Profile', 'View your professional profile');\nrequire __DIR__ . '/../common/header.php';\n\n$profile = $data['profile'] ?? [];\n$workExperiences = $data['work_experiences'] ?? [];\n$education = $data['education'] ?? [];\n$skills = $data['skills'] ?? [];\n$certifications = $data['certifications'] ?? [];\n$languages = $data['languages'] ?? [];\n$projects = $data['projects'] ?? [];\n?>\n\n<div class=\"container my-5\">\n    <div class=\"d-flex justify-content-between align-items-center mb-4\">\n        <h2><i class=\"fas fa-user\"></i> My Profile</h2>\n        <a href=\"/jobseeker/profile/edit\" class=\"btn btn-primary\">\n            <i class=\"fas fa-edit\"></i> Edit Profile\n        </a>\n    </div>\n\n    <?php if (empty($profile)): ?>\n        <div class=\"alert alert-info\">\n            <h5>Complete Your Profile</h5>\n            <p>Your profile is empty. Click \"Edit Profile\" to add your professional information, work experience, education, skills, and more!</p>\n            <a href=\"/jobseeker/profile/edit\" class=\"btn btn-primary mt-2\">\n                <i class=\"fas fa-plus\"></i> Create Profile Now\n            </a>\n        </div>\n    <?php else: ?>\n        <div class=\"card shadow\">\n            <div class=\"card-body\">\n                <div class=\"row\">\n                    <div class=\"col-md-2 text-center\">\n                        <?php if (!empty($profile['profile_picture'])): ?>\n                            <img src=\"/uploads/profiles/<?= htmlspecialchars($profile['profile_picture']) ?>\" \n                                 alt=\"Profile\" class=\"img-thumbnail rounded-circle\" style=\"width: 120px; height: 120px; object-fit: cover;\">\n                        <?php else: ?>\n                            <div class=\"bg-secondary text-white rounded-circle d-inline-flex align-items-center justify-content-center\" \n                                 style=\"width: 120px; height: 120px; font-size: 48px;\">\n                                <i class=\"fas fa-user\"></i>\n                            </div>\n                        <?php endif; ?>\n                    </div>\n                    <div class=\"col-md-10\">\n                        <h3><?= htmlspecialchars($data['user']['name']) ?></h3>\n                        <?php if ($profile['headline']): ?>\n                            <h5 class=\"text-muted\"><?= htmlspecialchars($profile['headline']) ?></h5>\n                        <?php endif; ?>\n                        <?php if ($profile['city']): ?>\n                            <p><i class=\"fas fa-map-marker-alt\"></i> <?= htmlspecialchars($profile['city']) ?>, <?= htmlspecialchars($profile['state']) ?></p>\n                        <?php endif; ?>\n                        <?php if ($profile['summary']): ?>\n                            <p class=\"mt-3\"><?= nl2br(htmlspecialchars($profile['summary'])) ?></p>\n                        <?php endif; ?>\n                        \n                        <div class=\"mt-3\">\n                            <?php if (!empty($skills)): ?>\n                                <p><strong>Top Skills:</strong> \n                                <?php \n                                $skillNames = array_map(fn($s) => $s['skill_name'], array_slice($skills, 0, 5));\n                                echo implode(', ', $skillNames);\n                                ?>\n                                </p>\n                            <?php endif; ?>\n                            \n                            <?php if ($profile['total_experience_years']): ?>\n                                <span class=\"badge bg-info me-2\"><?= $profile['total_experience_years'] ?> years experience</span>\n                            <?php endif; ?>\n                            <?php if ($profile['availability']): ?>\n                                <span class=\"badge bg-success me-2\">Available: <?= ucfirst(str_replace('_', ' ', $profile['availability'])) ?></span>\n                            <?php endif; ?>\n                            <?php if ($profile['willing_to_relocate']): ?>\n                                <span class=\"badge bg-primary\">Open to Relocation</span>\n                            <?php endif; ?>\n                        </div>\n                        \n                        <?php if (!empty($profile['resume_file'])): ?>\n                            <div class=\"mt-3\">\n                                <a href=\"/uploads/resumes/<?= htmlspecialchars($profile['resume_file']) ?>\" \n                                   target=\"_blank\" class=\"btn btn-outline-success\">\n                                    <i class=\"fas fa-file-pdf\"></i> Download Resume\n                                </a>\n                            </div>\n                        <?php endif; ?>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <?php if (!empty($workExperiences)): ?>\n            <div class=\"card shadow mt-4\">\n                <div class=\"card-body\">\n                    <h4><i class=\"fas fa-briefcase\"></i> Work Experience</h4>\n                    <hr>\n                    <?php foreach ($workExperiences as $exp): ?>\n                        <div class=\"mb-3\">\n                            <h5><?= htmlspecialchars($exp['job_title']) ?></h5>\n                            <p class=\"mb-0\"><strong><?= htmlspecialchars($exp['company_name']) ?></strong></p>\n                            <p class=\"text-muted\"><?= formatDate($exp['start_date']) ?> - <?= $exp['is_current'] ? 'Present' : formatDate($exp['end_date']) ?></p>\n                            <?php if ($exp['description']): ?>\n                                <p><?= nl2br(htmlspecialchars($exp['description'])) ?></p>\n                            <?php endif; ?>\n                        </div>\n                        <hr>\n                    <?php endforeach; ?>\n                </div>\n            </div>\n        <?php endif; ?>\n\n        <?php if (!empty($education)): ?>\n            <div class=\"card shadow mt-4\">\n                <div class=\"card-body\">\n                    <h4><i class=\"fas fa-graduation-cap\"></i> Education</h4>\n                    <hr>\n                    <?php foreach ($education as $edu): ?>\n                        <div class=\"mb-3\">\n                            <h5><?= htmlspecialchars($edu['degree']) ?></h5>\n                            <?php if ($edu['field_of_study']): ?>\n                                <p class=\"mb-0\">Field: <?= htmlspecialchars($edu['field_of_study']) ?></p>\n                            <?php endif; ?>\n                            <p class=\"mb-0\"><strong><?= htmlspecialchars($edu['institution']) ?></strong></p>\n                            <?php if ($edu['start_date']): ?>\n                                <p class=\"text-muted\"><?= formatDate($edu['start_date']) ?> - <?= formatDate($edu['end_date']) ?></p>\n                            <?php endif; ?>\n                        </div>\n                        <hr>\n                    <?php endforeach; ?>\n                </div>\n            </div>\n        <?php endif; ?>\n\n        <?php if (!empty($skills)): ?>\n            <div class=\"card shadow mt-4\">\n                <div class=\"card-body\">\n                    <h4><i class=\"fas fa-code\"></i> Skills</h4>\n                    <hr>\n                    <div class=\"row\">\n                        <?php foreach ($skills as $skill): ?>\n                            <div class=\"col-md-3 mb-2\">\n                                <span class=\"badge bg-primary me-1\"><?= htmlspecialchars($skill['skill_name']) ?></span>\n                                <small class=\"text-muted\">(<?= ucfirst($skill['proficiency']) ?>)</small>\n                            </div>\n                        <?php endforeach; ?>\n                    </div>\n                </div>\n            </div>\n        <?php endif; ?>\n    <?php endif; ?>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":7836,"size_tokens":null},"app/views/jobseeker/profile_modals.php":{"content":"<?php\n// Modal forms for adding profile sections\n?>\n\n<!-- Add Work Experience Modal -->\n<div class=\"modal fade\" id=\"addWorkExpModal\" tabindex=\"-1\">\n    <div class=\"modal-dialog modal-lg\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h5 class=\"modal-title\">Add Work Experience</h5>\n                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\n            </div>\n            <form action=\"/jobseeker/profile/add-work-experience\" method=\"POST\">\n                <?= csrfField() ?>\n                <div class=\"modal-body\">\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Job Title *</label>\n                        <input type=\"text\" name=\"job_title\" class=\"form-control\" required>\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Company Name *</label>\n                        <input type=\"text\" name=\"company_name\" class=\"form-control\" required>\n                    </div>\n                    <div class=\"row\">\n                        <div class=\"col-md-6 mb-3\">\n                            <label class=\"form-label\">Location</label>\n                            <input type=\"text\" name=\"location\" class=\"form-control\" placeholder=\"e.g., Mumbai, India\">\n                        </div>\n                        <div class=\"col-md-6 mb-3\">\n                            <label class=\"form-label\">Employment Type</label>\n                            <select name=\"employment_type\" class=\"form-control\">\n                                <option value=\"full_time\">Full-time</option>\n                                <option value=\"part_time\">Part-time</option>\n                                <option value=\"contract\">Contract</option>\n                                <option value=\"internship\">Internship</option>\n                                <option value=\"freelance\">Freelance</option>\n                            </select>\n                        </div>\n                    </div>\n                    <div class=\"row\">\n                        <div class=\"col-md-6 mb-3\">\n                            <label class=\"form-label\">Start Date *</label>\n                            <input type=\"date\" name=\"start_date\" class=\"form-control\" required>\n                        </div>\n                        <div class=\"col-md-6 mb-3\">\n                            <label class=\"form-label\">End Date</label>\n                            <input type=\"date\" name=\"end_date\" id=\"work_end_date\" class=\"form-control\">\n                            <div class=\"form-check mt-2\">\n                                <input type=\"checkbox\" class=\"form-check-input\" name=\"is_current\" \n                                       id=\"is_current_work\" onclick=\"document.getElementById('work_end_date').disabled = this.checked\">\n                                <label class=\"form-check-label\" for=\"is_current_work\">Currently working here</label>\n                            </div>\n                        </div>\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Description</label>\n                        <textarea name=\"description\" class=\"form-control\" rows=\"3\" \n                                  placeholder=\"Describe your responsibilities and role...\"></textarea>\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Key Achievements</label>\n                        <textarea name=\"achievements\" class=\"form-control\" rows=\"3\"\n                                  placeholder=\"List your major achievements and accomplishments...\"></textarea>\n                    </div>\n                </div>\n                <div class=\"modal-footer\">\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\n                    <button type=\"submit\" class=\"btn btn-primary\">Save Experience</button>\n                </div>\n            </form>\n        </div>\n    </div>\n</div>\n\n<!-- Add Education Modal -->\n<div class=\"modal fade\" id=\"addEducationModal\" tabindex=\"-1\">\n    <div class=\"modal-dialog modal-lg\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h5 class=\"modal-title\">Add Education</h5>\n                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\n            </div>\n            <form action=\"/jobseeker/profile/add-education\" method=\"POST\">\n                <?= csrfField() ?>\n                <div class=\"modal-body\">\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Degree *</label>\n                        <input type=\"text\" name=\"degree\" class=\"form-control\" \n                               placeholder=\"e.g., Bachelor of Technology\" required>\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Field of Study</label>\n                        <input type=\"text\" name=\"field_of_study\" class=\"form-control\"\n                               placeholder=\"e.g., Computer Science\">\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Institution *</label>\n                        <input type=\"text\" name=\"institution\" class=\"form-control\"\n                               placeholder=\"e.g., IIT Delhi\" required>\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Location</label>\n                        <input type=\"text\" name=\"location\" class=\"form-control\"\n                               placeholder=\"e.g., New Delhi, India\">\n                    </div>\n                    <div class=\"row\">\n                        <div class=\"col-md-6 mb-3\">\n                            <label class=\"form-label\">Start Date</label>\n                            <input type=\"date\" name=\"start_date\" class=\"form-control\">\n                        </div>\n                        <div class=\"col-md-6 mb-3\">\n                            <label class=\"form-label\">End Date</label>\n                            <input type=\"date\" name=\"end_date\" class=\"form-control\">\n                        </div>\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Grade/CGPA</label>\n                        <input type=\"text\" name=\"grade\" class=\"form-control\"\n                               placeholder=\"e.g., 8.5/10 or 85%\">\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Description</label>\n                        <textarea name=\"description\" class=\"form-control\" rows=\"2\"\n                                  placeholder=\"Additional details about coursework, projects, etc...\"></textarea>\n                    </div>\n                </div>\n                <div class=\"modal-footer\">\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\n                    <button type=\"submit\" class=\"btn btn-primary\">Save Education</button>\n                </div>\n            </form>\n        </div>\n    </div>\n</div>\n\n<!-- Add Skill Modal -->\n<div class=\"modal fade\" id=\"addSkillModal\" tabindex=\"-1\">\n    <div class=\"modal-dialog\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h5 class=\"modal-title\">Add Skill</h5>\n                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\n            </div>\n            <form action=\"/jobseeker/profile/add-skill\" method=\"POST\">\n                <?= csrfField() ?>\n                <div class=\"modal-body\">\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Skill Name *</label>\n                        <input type=\"text\" name=\"skill_name\" class=\"form-control\"\n                               placeholder=\"e.g., JavaScript, React, Python\" required>\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Proficiency Level</label>\n                        <select name=\"proficiency\" class=\"form-control\">\n                            <option value=\"beginner\">Beginner</option>\n                            <option value=\"intermediate\" selected>Intermediate</option>\n                            <option value=\"advanced\">Advanced</option>\n                            <option value=\"expert\">Expert</option>\n                        </select>\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Years of Experience</label>\n                        <input type=\"number\" name=\"years_of_experience\" class=\"form-control\" \n                               min=\"0\" max=\"50\" value=\"0\">\n                    </div>\n                </div>\n                <div class=\"modal-footer\">\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\n                    <button type=\"submit\" class=\"btn btn-primary\">Save Skill</button>\n                </div>\n            </form>\n        </div>\n    </div>\n</div>\n\n<!-- Add Certification Modal -->\n<div class=\"modal fade\" id=\"addCertModal\" tabindex=\"-1\">\n    <div class=\"modal-dialog modal-lg\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h5 class=\"modal-title\">Add Certification</h5>\n                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\n            </div>\n            <form action=\"/jobseeker/profile/add-certification\" method=\"POST\">\n                <?= csrfField() ?>\n                <div class=\"modal-body\">\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Certification Name *</label>\n                        <input type=\"text\" name=\"certification_name\" class=\"form-control\"\n                               placeholder=\"e.g., AWS Certified Solutions Architect\" required>\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Issuing Organization *</label>\n                        <input type=\"text\" name=\"issuing_organization\" class=\"form-control\"\n                               placeholder=\"e.g., Amazon Web Services\" required>\n                    </div>\n                    <div class=\"row\">\n                        <div class=\"col-md-6 mb-3\">\n                            <label class=\"form-label\">Issue Date</label>\n                            <input type=\"date\" name=\"issue_date\" class=\"form-control\">\n                        </div>\n                        <div class=\"col-md-6 mb-3\">\n                            <label class=\"form-label\">Expiry Date (if applicable)</label>\n                            <input type=\"date\" name=\"expiry_date\" class=\"form-control\">\n                        </div>\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Credential ID</label>\n                        <input type=\"text\" name=\"credential_id\" class=\"form-control\"\n                               placeholder=\"e.g., ABC123XYZ\">\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Credential URL</label>\n                        <input type=\"url\" name=\"credential_url\" class=\"form-control\"\n                               placeholder=\"https://...\">\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Description</label>\n                        <textarea name=\"description\" class=\"form-control\" rows=\"2\"></textarea>\n                    </div>\n                </div>\n                <div class=\"modal-footer\">\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\n                    <button type=\"submit\" class=\"btn btn-primary\">Save Certification</button>\n                </div>\n            </form>\n        </div>\n    </div>\n</div>\n\n<!-- Add Language Modal -->\n<div class=\"modal fade\" id=\"addLanguageModal\" tabindex=\"-1\">\n    <div class=\"modal-dialog\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h5 class=\"modal-title\">Add Language</h5>\n                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\n            </div>\n            <form action=\"/jobseeker/profile/add-language\" method=\"POST\">\n                <?= csrfField() ?>\n                <div class=\"modal-body\">\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Language *</label>\n                        <input type=\"text\" name=\"language_name\" class=\"form-control\"\n                               placeholder=\"e.g., English, Hindi\" required>\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Proficiency Level</label>\n                        <select name=\"proficiency\" class=\"form-control\">\n                            <option value=\"basic\">Basic</option>\n                            <option value=\"conversational\">Conversational</option>\n                            <option value=\"professional\" selected>Professional</option>\n                            <option value=\"native\">Native</option>\n                        </select>\n                    </div>\n                </div>\n                <div class=\"modal-footer\">\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\n                    <button type=\"submit\" class=\"btn btn-primary\">Save Language</button>\n                </div>\n            </form>\n        </div>\n    </div>\n</div>\n\n<!-- Add Project Modal -->\n<div class=\"modal fade\" id=\"addProjectModal\" tabindex=\"-1\">\n    <div class=\"modal-dialog modal-lg\">\n        <div class=\"modal-content\">\n            <div class=\"modal-header\">\n                <h5 class=\"modal-title\">Add Project</h5>\n                <button type=\"button\" class=\"btn-close\" data-bs-dismiss=\"modal\"></button>\n            </div>\n            <form action=\"/jobseeker/profile/add-project\" method=\"POST\">\n                <?= csrfField() ?>\n                <div class=\"modal-body\">\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Project Name *</label>\n                        <input type=\"text\" name=\"project_name\" class=\"form-control\"\n                               placeholder=\"e.g., E-commerce Website\" required>\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Project URL</label>\n                        <input type=\"url\" name=\"project_url\" class=\"form-control\"\n                               placeholder=\"https://github.com/yourusername/project\">\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Description</label>\n                        <textarea name=\"description\" class=\"form-control\" rows=\"3\"\n                                  placeholder=\"Describe the project, your role, and what you accomplished...\"></textarea>\n                    </div>\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Technologies Used</label>\n                        <input type=\"text\" name=\"technologies_used\" class=\"form-control\"\n                               placeholder=\"e.g., React, Node.js, MongoDB, AWS\">\n                    </div>\n                    <div class=\"row\">\n                        <div class=\"col-md-6 mb-3\">\n                            <label class=\"form-label\">Start Date</label>\n                            <input type=\"date\" name=\"start_date\" class=\"form-control\">\n                        </div>\n                        <div class=\"col-md-6 mb-3\">\n                            <label class=\"form-label\">End Date</label>\n                            <input type=\"date\" name=\"end_date\" id=\"project_end_date\" class=\"form-control\">\n                            <div class=\"form-check mt-2\">\n                                <input type=\"checkbox\" class=\"form-check-input\" name=\"is_ongoing\"\n                                       id=\"is_ongoing_project\" onclick=\"document.getElementById('project_end_date').disabled = this.checked\">\n                                <label class=\"form-check-label\" for=\"is_ongoing_project\">Ongoing project</label>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n                <div class=\"modal-footer\">\n                    <button type=\"button\" class=\"btn btn-secondary\" data-bs-dismiss=\"modal\">Cancel</button>\n                    <button type=\"submit\" class=\"btn btn-primary\">Save Project</button>\n                </div>\n            </form>\n        </div>\n    </div>\n</div>\n","path":null,"size_bytes":16979,"size_tokens":null},"app/views/auth/login.php":{"content":"<?php\n$meta = generateMetaTags('Login', 'Login to your ConnectWith9 account');\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container\">\n    <div class=\"row justify-content-center\">\n        <div class=\"col-md-6\">\n            <div class=\"card shadow\">\n                <div class=\"card-body p-5\">\n                    <h2 class=\"text-center mb-4\">Login</h2>\n                    \n                    <?php if ($error = getFlash('error')): ?>\n                        <div class=\"alert alert-danger\"><?= $error ?></div>\n                    <?php endif; ?>\n                    \n                    <?php if ($success = getFlash('success')): ?>\n                        <div class=\"alert alert-success\"><?= $success ?></div>\n                    <?php endif; ?>\n                    \n                    <form action=\"/login\" method=\"POST\">\n                        <?= csrfField() ?>\n                        \n                        <div class=\"mb-3\">\n                            <label for=\"email\" class=\"form-label\">Email Address</label>\n                            <input type=\"email\" class=\"form-control\" id=\"email\" name=\"email\" required>\n                        </div>\n                        \n                        <div class=\"mb-3\">\n                            <label for=\"password\" class=\"form-label\">Password</label>\n                            <input type=\"password\" class=\"form-control\" id=\"password\" name=\"password\" required>\n                        </div>\n                        \n                        <div class=\"mb-3 text-end\">\n                            <a href=\"/forgot-password\" class=\"text-decoration-none\">Forgot Password?</a>\n                        </div>\n                        \n                        <button type=\"submit\" class=\"btn btn-primary w-100\">Login</button>\n                    </form>\n                    \n                    <div class=\"text-center mt-3\">\n                        <p>Don't have an account? <a href=\"/register\">Register here</a></p>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":2149,"size_tokens":null},"docs/password_reset_guide.md":{"content":"# Password Reset Functionality Guide\n\n## Overview\n\nThe ConnectWith9 Job Portal includes a complete password reset functionality that allows users (Admin, Employer, Job Seeker) to reset their passwords via email.\n\n## Features\n\n✅ **Secure token-based reset** - Tokens expire after 1 hour\n✅ **Email notifications** - Automated password reset emails  \n✅ **Works for all user types** - Admin, Employer, and Job Seeker\n✅ **Rate limiting prevention** - Uses existing login throttling system\n✅ **User-friendly interface** - Beautiful forms with password strength indicator\n✅ **Security best practices** - Doesn't reveal if email exists in system\n\n## Setup Instructions\n\n### Step 1: Create Database Table\n\nRun this command to add the password_reset_tokens table:\n\n```bash\nphp scripts/add_password_reset.php\n```\n\nOr manually execute this SQL:\n\n```sql\nCREATE TABLE IF NOT EXISTS password_reset_tokens (\n    id INT AUTO_INCREMENT PRIMARY KEY,\n    email VARCHAR(100) NOT NULL,\n    token VARCHAR(100) NOT NULL UNIQUE,\n    expires_at DATETIME NOT NULL,\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    INDEX idx_email (email),\n    INDEX idx_token (token),\n    INDEX idx_expires (expires_at)\n) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;\n```\n\n### Step 2: Configure Email Settings\n\nUpdate your email configuration in `config/env.php`:\n\n```php\n// SMTP Configuration (for email notifications)\ndefine('SMTP_HOST', 'smtp.gmail.com');\ndefine('SMTP_USER', 'your-email@gmail.com');\ndefine('SMTP_PASS', 'your-app-password');\ndefine('SMTP_PORT', 587);\n```\n\n**For Gmail:**\n1. Enable 2-Step Verification\n2. Go to Google Account → Security → App passwords\n3. Generate an app password\n4. Use that password in SMTP_PASS\n\n**For other email providers:**\n- **SendGrid**: smtp.sendgrid.net\n- **Mailgun**: smtp.mailgun.org\n- **Amazon SES**: email-smtp.region.amazonaws.com\n\n### Step 3: Test the Feature\n\n1. Go to `/login`\n2. Click \"Forgot Password?\"\n3. Enter a registered email address\n4. Check your inbox for the reset link\n5. Click the link and set a new password\n6. Login with your new password\n\n## User Flow\n\n### Password Reset Request\n\n1. User visits `/forgot-password`\n2. User enters their registered email\n3. System generates a secure token (64 characters)\n4. Token is stored in database with 1-hour expiration\n5. Email with reset link is sent to user\n6. Success message displayed (doesn't reveal if email exists)\n\n### Password Reset Completion\n\n1. User clicks reset link from email\n2. System validates token (checks existence and expiration)\n3. User enters new password (minimum 6 characters)\n4. Password strength indicator shows security level\n5. Password is hashed and updated in database\n6. Used token is deleted\n7. User redirected to login with success message\n\n## Security Features\n\n### Token Security\n- **Random generation**: Uses `bin2hex(random_bytes(32))` for cryptographically secure tokens\n- **Unique constraint**: Database ensures no duplicate tokens\n- **One-time use**: Token deleted after successful password reset\n- **Time-limited**: Expires after 1 hour\n\n### Email Validation\n- Checks email format validity\n- Verifies email exists in database (internal check only)\n- Doesn't reveal to attacker if email is registered\n\n### Password Validation\n- Minimum 6 characters (configurable)\n- Must match confirmation field\n- Strength indicator encourages strong passwords\n- Hashed using bcrypt (PASSWORD_DEFAULT)\n\n### Protection Against Attacks\n- **Token expiration**: Prevents old tokens from working\n- **Single use**: Token deleted after reset\n- **No email enumeration**: Same message whether email exists or not\n- **CSRF protection**: All forms protected with CSRF tokens\n\n## File Structure\n\n```\napp/\n├── controllers/\n│   └── AuthController.php          # Password reset methods added\n├── views/\n│   └── auth/\n│       ├── login.php              # Updated with \"Forgot Password?\" link\n│       ├── forgot-password.php    # Request reset form\n│       └── reset-password.php     # New password form\npublic/\n└── index.php                      # Routes for /forgot-password and /reset-password\nincludes/\n└── email.php                      # sendPasswordResetEmail() function\nscripts/\n└── add_password_reset.php         # Database migration script\ndocs/\n└── password_reset_migration.sql   # SQL for manual migration\n```\n\n## Routes\n\n| Route | Method | Description |\n|-------|--------|-------------|\n| `/forgot-password` | GET | Show password reset request form |\n| `/forgot-password` | POST | Process password reset request |\n| `/reset-password?token=xxx` | GET | Show new password form |\n| `/reset-password` | POST | Process password update |\n\n## Email Template\n\nThe password reset email includes:\n- Personalized greeting with user's name\n- Clear call-to-action button\n- Backup link (in case button doesn't work)\n- Expiration notice (1 hour)\n- Security reminder (ignore if didn't request)\n\n## Controller Methods\n\n### AuthController.php\n\n```php\n// Show forgot password form\npublic function showForgotPassword()\n\n// Handle password reset request\npublic function requestPasswordReset()\n\n// Show reset password form (with token validation)\npublic function showResetPassword()\n\n// Handle password reset\npublic function resetPassword()\n\n// Verify reset token is valid\nprivate function verifyResetToken($token)\n\n// Get reset token data if valid\nprivate function getResetTokenData($token)\n```\n\n## Database Schema\n\n```sql\npassword_reset_tokens\n├── id (INT, AUTO_INCREMENT, PRIMARY KEY)\n├── email (VARCHAR 100, NOT NULL)\n├── token (VARCHAR 100, NOT NULL, UNIQUE)\n├── expires_at (DATETIME, NOT NULL)\n├── created_at (TIMESTAMP, DEFAULT CURRENT_TIMESTAMP)\n├── INDEX idx_email (email)\n├── INDEX idx_token (token)\n└── INDEX idx_expires (expires_at)\n```\n\n## Testing Checklist\n\n- [ ] Password reset table created successfully\n- [ ] SMTP settings configured correctly\n- [ ] \"Forgot Password?\" link appears on login page\n- [ ] Forgot password page loads at `/forgot-password`\n- [ ] Form validates email address\n- [ ] Email sent successfully to registered user\n- [ ] Reset link contains valid token\n- [ ] Reset link expires after 1 hour\n- [ ] Reset password page validates token\n- [ ] Password strength indicator works\n- [ ] Password confirmation validation works\n- [ ] Password updated in database\n- [ ] Can login with new password\n- [ ] Used token is deleted from database\n- [ ] Invalid/expired tokens show error message\n\n## Troubleshooting\n\n### Email Not Sending\n\n**Problem**: User doesn't receive reset email\n\n**Solutions**:\n1. Check SMTP credentials in `config/env.php`\n2. Verify SMTP port (587 for TLS, 465 for SSL)\n3. Check spam/junk folder\n4. Test with a simple PHP mail script\n5. Check server error logs\n6. Consider using email service (SendGrid, Mailgun)\n\n### Token Invalid/Expired\n\n**Problem**: \"This reset link is invalid or has expired\"\n\n**Solutions**:\n1. Request a new reset link\n2. Check database clock vs server clock\n3. Verify token wasn't already used\n4. Check token hasn't expired (1 hour limit)\n\n### Password Not Updating\n\n**Problem**: Password reset succeeds but can't login\n\n**Solutions**:\n1. Verify password is being hashed correctly\n2. Check User model update() method\n3. Clear browser cookies/cache\n4. Verify correct email being used\n\n## Customization\n\n### Change Token Expiration\n\nIn `AuthController::requestPasswordReset()`:\n\n```php\n// Change from 1 hour to 30 minutes\n$expiresAt = date('Y-m-d H:i:s', strtotime('+30 minutes'));\n\n// Or 24 hours\n$expiresAt = date('Y-m-d H:i:s', strtotime('+24 hours'));\n```\n\n### Customize Email Template\n\nEdit `includes/email.php` → `sendPasswordResetEmail()`:\n\n```php\nfunction sendPasswordResetEmail($userEmail, $userName, $resetToken) {\n    // Customize subject\n    $subject = \"Your Custom Subject Here\";\n    \n    // Customize email content\n    $content = <<<HTML\n<h2>Your Custom Heading</h2>\n<p>Your custom message...</p>\nHTML;\n    \n    // Rest of the code...\n}\n```\n\n### Change Password Requirements\n\nIn `AuthController::resetPassword()`:\n\n```php\n// Change minimum password length\nif (strlen($password) < 8) {  // Changed from 6 to 8\n    setFlash('error', 'Password must be at least 8 characters');\n    redirect('/reset-password?token=' . $token);\n}\n\n// Add complexity requirements\nif (!preg_match('/^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d)/', $password)) {\n    setFlash('error', 'Password must contain uppercase, lowercase, and number');\n    redirect('/reset-password?token=' . $token);\n}\n```\n\n## Production Deployment\n\nBefore deploying to production:\n\n1. ✅ Test password reset flow completely\n2. ✅ Configure production SMTP settings\n3. ✅ Set APP_ENV to 'production' in config/env.php\n4. ✅ Use environment variables for SMTP credentials\n5. ✅ Enable HTTPS for secure token transmission\n6. ✅ Set up email monitoring/logging\n7. ✅ Test with real email accounts\n8. ✅ Configure SPF/DKIM for better email delivery\n9. ✅ Set up email rate limiting if needed\n10. ✅ Monitor reset token usage for abuse\n\n## Support & Maintenance\n\n### Cleanup Old Tokens\n\nAdd a cron job to clean up expired tokens:\n\n```bash\n# Run daily at 2 AM\n0 2 * * * php /path/to/scripts/cleanup_tokens.php\n```\n\nCreate `scripts/cleanup_tokens.php`:\n\n```php\n<?php\nrequire_once __DIR__ . '/../config/database.php';\n$db = getDB();\n$db->exec(\"DELETE FROM password_reset_tokens WHERE expires_at < NOW()\");\n```\n\n### Monitor Reset Requests\n\nTrack password reset requests in admin panel:\n\n```sql\nSELECT DATE(created_at) as date, COUNT(*) as reset_requests\nFROM password_reset_tokens\nGROUP BY DATE(created_at)\nORDER BY date DESC\nLIMIT 30;\n```\n\n## FAQs\n\n**Q: How long is the reset link valid?**  \nA: 1 hour by default (customizable)\n\n**Q: Can a user request multiple reset links?**  \nA: Yes, but only the latest token will work (old tokens are deleted)\n\n**Q: Does it work for all user types?**  \nA: Yes, Admin, Employer, and Job Seeker can all reset passwords\n\n**Q: What if email service is down?**  \nA: User won't receive email but can retry. Consider implementing email queuing for production.\n\n**Q: Is the feature mobile-friendly?**  \nA: Yes, all forms are responsive and work on mobile devices\n\n---\n\n**Your password reset feature is now ready to use!** 🎉\n","path":null,"size_bytes":10308,"size_tokens":null},"replit.md":{"content":"# ConnectWith9 Job Portal\n\n## Overview\nConnectWith9 is a comprehensive job portal application designed to connect job seekers with employers across various industries. Built with Core PHP, it features a robust three-tier user role system (Admin, Employer, Job Seeker), ensuring tailored experiences and secure interactions. The platform prioritizes an intuitive user interface, robust security features including CSRF protection and login throttling, and SEO optimization to maximize visibility. Its core purpose is to streamline the hiring process, offering features from advanced job seeker profiles and resume uploads to real-time chat and notification systems, fostering efficient communication and successful placements.\n\n## User Preferences\nI prefer iterative development with clear communication at each stage. Please ask for confirmation before implementing major architectural changes or deleting existing code. I value detailed explanations of complex solutions. Ensure that all new features are thoroughly tested and documented, especially regarding security and data integrity.\n\n## System Architecture\n\n### Core Architecture\nThe application follows a Model-View-Controller (MVC) architectural pattern, separating business logic, data presentation, and user interaction. It's built with Core PHP 8.2 and utilizes a remote MySQL 8.0 database.\n\n### User Roles\n1.  **Admin**: Manages users, moderates jobs, and monitors system activities, including notification management and candidate viewing.\n2.  **Employer**: Posts job listings, views and manages applications, searches for candidates, and communicates with selected job seekers.\n3.  **Job Seeker**: Browses and applies for jobs, manages a comprehensive professional profile, and tracks application statuses.\n\n### Key Features\n*   **Authentication & Authorization**: Secure user login/registration with password hashing, login throttling, and session fingerprinting. Three distinct user roles with role-based access control.\n*   **Job Management**: Employers can post jobs, and job seekers can browse and apply. Includes an admin approval workflow for job postings.\n*   **Comprehensive Job Seeker Profiles**: Detailed profiles with sections for work experience, education, skills, certifications, languages, and projects. Supports resume and profile picture uploads.\n*   **Candidate Management**: Employers can search, filter, and manage candidates, with features for selecting candidates and initiating chat. Admins can also browse all candidates.\n*   **Real-time Communication**: Integrated chat system for direct messaging between employers and selected job seekers, including attachment support for various file types (images, documents, PDFs).\n*   **Notification System**: Real-time notifications for job selections, new job postings, chat messages, and system announcements, with unread counts and a full notification center.\n*   **Password Reset**: Secure token-based password reset functionality with email notifications.\n*   **Security Features**: CSRF protection, input sanitization, password hashing (bcrypt), login attempt tracking, and session fingerprinting.\n*   **SEO Optimization**: Dynamic meta tags, Schema.org JSON-LD, clean URL structures, Open Graph, and Twitter Card support.\n*   **Responsive UI**: Built with Bootstrap 5.3 for a mobile-first, responsive user experience.\n*   **Action-Specific Button Loaders**: Visual feedback for form submissions with dynamic loader texts.\n\n### Folder Structure\n```\n/jobportal/\n├── config/\n├── app/\n│   ├── controllers/\n│   ├── models/\n│   └── views/\n├── public/\n│   ├── assets/\n│   └── uploads/\n├── includes/\n├── scripts/\n└── docs/\n```\n\n### UI/UX Design\nThe application uses Bootstrap 5.3 for its responsive design, ensuring a consistent and user-friendly interface across devices. Custom CSS styling is applied for branding. Icons are provided by Font Awesome 6.4.\n\n## External Dependencies\n*   **Database**: Remote MySQL 8.0 (Hostinger)\n*   **UI Framework**: Bootstrap 5.3\n*   **Icons**: Font Awesome 6.4\n*   **Web Server**: Apache with mod_rewrite (for clean URLs)","path":null,"size_bytes":4165,"size_tokens":null},"app/views/admin/candidate_profile.php":{"content":"<?php\n$meta = generateMetaTags('Candidate Profile - Admin', 'View candidate profile');\nrequire __DIR__ . '/../common/header.php';\n\n$profile = $data['profile'] ?? [];\n$user = $data['user'] ?? [];\n$workExperiences = $data['work_experiences'] ?? [];\n$education = $data['education'] ?? [];\n$skills = $data['skills'] ?? [];\n$certifications = $data['certifications'] ?? [];\n$languages = $data['languages'] ?? [];\n$projects = $data['projects'] ?? [];\n?>\n\n<div class=\"container my-5\">\n    <div class=\"d-flex justify-content-between align-items-center mb-4\">\n        <h2><i class=\"fas fa-user\"></i> Candidate Profile</h2>\n        <a href=\"/admin/candidates\" class=\"btn btn-secondary\">\n            <i class=\"fas fa-arrow-left\"></i> Back to Candidates\n        </a>\n    </div>\n\n    <?php if (empty($profile)): ?>\n        <div class=\"alert alert-info\">\n            <h5>Profile Incomplete</h5>\n            <p>This candidate has not completed their profile yet.</p>\n        </div>\n    <?php else: ?>\n        <div class=\"card shadow mb-4\">\n            <div class=\"card-body\">\n                <div class=\"row\">\n                    <div class=\"col-md-2 text-center\">\n                        <?php if (!empty($profile['profile_picture'])): ?>\n                            <img src=\"/uploads/profiles/<?= htmlspecialchars($profile['profile_picture']) ?>\" \n                                 alt=\"Profile\" class=\"img-thumbnail rounded-circle\" style=\"width: 120px; height: 120px; object-fit: cover;\">\n                        <?php else: ?>\n                            <div class=\"bg-secondary text-white rounded-circle d-inline-flex align-items-center justify-content-center\" \n                                 style=\"width: 120px; height: 120px; font-size: 48px;\">\n                                <i class=\"fas fa-user\"></i>\n                            </div>\n                        <?php endif; ?>\n                    </div>\n                    <div class=\"col-md-10\">\n                        <h3><?= htmlspecialchars($user['name']) ?></h3>\n                        <p class=\"text-muted\"><?= htmlspecialchars($user['email']) ?></p>\n                        <?php if (!empty($user['mobile_no'])): ?>\n                            <p class=\"text-muted\"><i class=\"fas fa-phone\"></i> <?= htmlspecialchars($user['mobile_no']) ?></p>\n                        <?php endif; ?>\n                        \n                        <?php if ($profile['headline']): ?>\n                            <h5 class=\"text-muted mt-2\"><?= htmlspecialchars($profile['headline']) ?></h5>\n                        <?php endif; ?>\n                        \n                        <?php if ($profile['city']): ?>\n                            <p><i class=\"fas fa-map-marker-alt\"></i> <?= htmlspecialchars($profile['city']) ?>, <?= htmlspecialchars($profile['state']) ?></p>\n                        <?php endif; ?>\n                        \n                        <?php if ($profile['summary']): ?>\n                            <p class=\"mt-3\"><?= nl2br(htmlspecialchars($profile['summary'])) ?></p>\n                        <?php endif; ?>\n                        \n                        <div class=\"mt-3\">\n                            <?php if (!empty($skills)): ?>\n                                <p><strong>Top Skills:</strong> \n                                <?php \n                                $skillNames = array_map(fn($s) => $s['skill_name'], array_slice($skills, 0, 5));\n                                echo implode(', ', $skillNames);\n                                ?>\n                                </p>\n                            <?php endif; ?>\n                            \n                            <?php if ($profile['total_experience_years']): ?>\n                                <span class=\"badge bg-info me-2\"><?= $profile['total_experience_years'] ?> years experience</span>\n                            <?php endif; ?>\n                            \n                            <?php if ($profile['availability']): ?>\n                                <span class=\"badge bg-success me-2\">Available: <?= ucfirst(str_replace('_', ' ', $profile['availability'])) ?></span>\n                            <?php endif; ?>\n                            \n                            <?php if ($profile['willing_to_relocate']): ?>\n                                <span class=\"badge bg-primary\">Open to Relocation</span>\n                            <?php endif; ?>\n                        </div>\n                        \n                        <?php if (!empty($profile['resume_file'])): ?>\n                            <div class=\"mt-3\">\n                                <a href=\"/uploads/resumes/<?= htmlspecialchars($profile['resume_file']) ?>\" \n                                   target=\"_blank\" class=\"btn btn-outline-success\">\n                                    <i class=\"fas fa-file-pdf\"></i> View Resume\n                                </a>\n                            </div>\n                        <?php endif; ?>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <!-- Work Experience -->\n        <?php if (!empty($workExperiences)): ?>\n            <div class=\"card shadow mb-4\">\n                <div class=\"card-header bg-primary text-white\">\n                    <h5 class=\"mb-0\"><i class=\"fas fa-briefcase\"></i> Work Experience</h5>\n                </div>\n                <div class=\"card-body\">\n                    <?php foreach ($workExperiences as $exp): ?>\n                        <div class=\"mb-4\">\n                            <h5><?= htmlspecialchars($exp['job_title']) ?></h5>\n                            <p class=\"mb-1\"><strong><?= htmlspecialchars($exp['company_name']) ?></strong></p>\n                            <p class=\"text-muted mb-2\">\n                                <i class=\"fas fa-calendar\"></i> \n                                <?= formatDate($exp['start_date']) ?> - <?= $exp['is_current'] ? 'Present' : formatDate($exp['end_date']) ?>\n                            </p>\n                            <?php if ($exp['description']): ?>\n                                <p><?= nl2br(htmlspecialchars($exp['description'])) ?></p>\n                            <?php endif; ?>\n                        </div>\n                        <hr>\n                    <?php endforeach; ?>\n                </div>\n            </div>\n        <?php endif; ?>\n\n        <!-- Education -->\n        <?php if (!empty($education)): ?>\n            <div class=\"card shadow mb-4\">\n                <div class=\"card-header bg-info text-white\">\n                    <h5 class=\"mb-0\"><i class=\"fas fa-graduation-cap\"></i> Education</h5>\n                </div>\n                <div class=\"card-body\">\n                    <?php foreach ($education as $edu): ?>\n                        <div class=\"mb-4\">\n                            <h5><?= htmlspecialchars($edu['degree']) ?></h5>\n                            <p class=\"mb-1\"><strong><?= htmlspecialchars($edu['school_name']) ?></strong></p>\n                            <?php if ($edu['field_of_study']): ?>\n                                <p class=\"mb-2\">Field of Study: <?= htmlspecialchars($edu['field_of_study']) ?></p>\n                            <?php endif; ?>\n                            <p class=\"text-muted mb-2\">\n                                <i class=\"fas fa-calendar\"></i> \n                                <?= formatDate($edu['start_date']) ?> - <?= $edu['is_current'] ? 'Ongoing' : formatDate($edu['end_date']) ?>\n                            </p>\n                            <?php if ($edu['description']): ?>\n                                <p><?= nl2br(htmlspecialchars($edu['description'])) ?></p>\n                            <?php endif; ?>\n                        </div>\n                        <hr>\n                    <?php endforeach; ?>\n                </div>\n            </div>\n        <?php endif; ?>\n\n        <!-- Skills -->\n        <?php if (!empty($skills)): ?>\n            <div class=\"card shadow mb-4\">\n                <div class=\"card-header bg-success text-white\">\n                    <h5 class=\"mb-0\"><i class=\"fas fa-cog\"></i> Skills</h5>\n                </div>\n                <div class=\"card-body\">\n                    <div class=\"row\">\n                        <?php foreach ($skills as $skill): ?>\n                            <div class=\"col-md-4 mb-2\">\n                                <span class=\"badge bg-light text-dark p-2\">\n                                    <?= htmlspecialchars($skill['skill_name']) ?>\n                                </span>\n                            </div>\n                        <?php endforeach; ?>\n                    </div>\n                </div>\n            </div>\n        <?php endif; ?>\n\n        <!-- Certifications -->\n        <?php if (!empty($certifications)): ?>\n            <div class=\"card shadow mb-4\">\n                <div class=\"card-header bg-warning text-white\">\n                    <h5 class=\"mb-0\"><i class=\"fas fa-certificate\"></i> Certifications</h5>\n                </div>\n                <div class=\"card-body\">\n                    <?php foreach ($certifications as $cert): ?>\n                        <div class=\"mb-4\">\n                            <h5><?= htmlspecialchars($cert['certification_name']) ?></h5>\n                            <p class=\"mb-1\"><strong><?= htmlspecialchars($cert['issuing_organization']) ?></strong></p>\n                            <p class=\"text-muted mb-2\">\n                                <i class=\"fas fa-calendar\"></i> Issued: <?= formatDate($cert['issue_date']) ?>\n                            </p>\n                            <?php if ($cert['expiry_date']): ?>\n                                <p class=\"text-muted mb-2\">Expires: <?= formatDate($cert['expiry_date']) ?></p>\n                            <?php endif; ?>\n                            <?php if ($cert['credential_url']): ?>\n                                <p>\n                                    <a href=\"<?= htmlspecialchars($cert['credential_url']) ?>\" target=\"_blank\">\n                                        <i class=\"fas fa-external-link-alt\"></i> View Credential\n                                    </a>\n                                </p>\n                            <?php endif; ?>\n                        </div>\n                        <hr>\n                    <?php endforeach; ?>\n                </div>\n            </div>\n        <?php endif; ?>\n\n        <!-- Languages -->\n        <?php if (!empty($languages)): ?>\n            <div class=\"card shadow mb-4\">\n                <div class=\"card-header bg-secondary text-white\">\n                    <h5 class=\"mb-0\"><i class=\"fas fa-language\"></i> Languages</h5>\n                </div>\n                <div class=\"card-body\">\n                    <div class=\"row\">\n                        <?php foreach ($languages as $lang): ?>\n                            <div class=\"col-md-6 mb-2\">\n                                <p class=\"mb-1\">\n                                    <strong><?= htmlspecialchars($lang['language_name']) ?></strong>\n                                    <span class=\"badge bg-info\"><?= htmlspecialchars(ucfirst($lang['proficiency_level'])) ?></span>\n                                </p>\n                            </div>\n                        <?php endforeach; ?>\n                    </div>\n                </div>\n            </div>\n        <?php endif; ?>\n\n        <!-- Projects -->\n        <?php if (!empty($projects)): ?>\n            <div class=\"card shadow mb-4\">\n                <div class=\"card-header bg-dark text-white\">\n                    <h5 class=\"mb-0\"><i class=\"fas fa-project-diagram\"></i> Projects</h5>\n                </div>\n                <div class=\"card-body\">\n                    <?php foreach ($projects as $project): ?>\n                        <div class=\"mb-4\">\n                            <h5><?= htmlspecialchars($project['project_name']) ?></h5>\n                            <?php if ($project['description']): ?>\n                                <p><?= nl2br(htmlspecialchars($project['description'])) ?></p>\n                            <?php endif; ?>\n                            <?php if ($project['start_date']): ?>\n                                <p class=\"text-muted mb-2\">\n                                    <i class=\"fas fa-calendar\"></i> \n                                    <?= formatDate($project['start_date']) ?> - <?= $project['end_date'] ? formatDate($project['end_date']) : 'Ongoing' ?>\n                                </p>\n                            <?php endif; ?>\n                            <?php if ($project['project_url']): ?>\n                                <p>\n                                    <a href=\"<?= htmlspecialchars($project['project_url']) ?>\" target=\"_blank\">\n                                        <i class=\"fas fa-external-link-alt\"></i> View Project\n                                    </a>\n                                </p>\n                            <?php endif; ?>\n                        </div>\n                        <hr>\n                    <?php endforeach; ?>\n                </div>\n            </div>\n        <?php endif; ?>\n\n        <div class=\"mt-4\">\n            <a href=\"/admin/candidates\" class=\"btn btn-secondary\">\n                <i class=\"fas fa-arrow-left\"></i> Back to Candidates\n            </a>\n        </div>\n    <?php endif; ?>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":13381,"size_tokens":null},"app/views/jobseeker/dashboard.php":{"content":"<?php\n$meta = generateMetaTags('Job Seeker Dashboard', 'View your job applications and find new opportunities');\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container\">\n    <h1 class=\"mb-4\">Job Seeker Dashboard</h1>\n    \n    <?php if ($success = getFlash('success')): ?>\n        <div class=\"alert alert-success\"><?= $success ?></div>\n    <?php endif; ?>\n    \n    <div class=\"row mb-4\">\n        <div class=\"col-md-4\">\n            <div class=\"card text-white bg-primary\">\n                <div class=\"card-body\">\n                    <h5 class=\"card-title\">My Applications</h5>\n                    <p class=\"display-4\"><?= $stats['applications'] ?></p>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <div class=\"row mb-4\">\n        <div class=\"col-md-12\">\n            <div class=\"card\">\n                <div class=\"card-header\">\n                    <h5 class=\"mb-0\">Quick Actions</h5>\n                </div>\n                <div class=\"card-body\">\n                    <a href=\"/jobs\" class=\"btn btn-primary me-2 mb-2\"><i class=\"fas fa-search\"></i> Browse Jobs</a>\n                    <a href=\"/jobseeker/applications\" class=\"btn btn-outline-primary me-2 mb-2\"><i class=\"fas fa-file-alt\"></i> View My Applications</a>\n                    <a href=\"/jobseeker/profile\" class=\"btn btn-outline-success me-2 mb-2\"><i class=\"fas fa-id-card\"></i> My Profile</a>\n                    <a href=\"/jobseeker/profile/edit\" class=\"btn btn-outline-info mb-2\"><i class=\"fas fa-edit\"></i> Edit Profile</a>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <div class=\"row\">\n        <div class=\"col-md-6\">\n            <div class=\"card\">\n                <div class=\"card-header\">\n                    <h5 class=\"mb-0\">Recent Applications</h5>\n                </div>\n                <div class=\"card-body\">\n                    <?php if (empty($recentApplications)): ?>\n                        <p class=\"text-muted\">You haven't applied to any jobs yet.</p>\n                        <a href=\"/jobs\" class=\"btn btn-primary\">Start Browsing Jobs</a>\n                    <?php else: ?>\n                        <div class=\"list-group list-group-flush\">\n                            <?php foreach ($recentApplications as $app): ?>\n                            <div class=\"list-group-item\">\n                                <h6 class=\"mb-1\"><?= htmlspecialchars($app['job_title']) ?></h6>\n                                <p class=\"mb-1 text-muted\">\n                                    <small>\n                                        <i class=\"fas fa-building\"></i> <?= htmlspecialchars($app['employer_name']) ?> |\n                                        <i class=\"fas fa-map-marker-alt\"></i> <?= htmlspecialchars($app['location']) ?>\n                                    </small>\n                                </p>\n                                <small class=\"text-muted\">Applied: <?= formatDate($app['applied_at']) ?></small>\n                            </div>\n                            <?php endforeach; ?>\n                        </div>\n                    <?php endif; ?>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"col-md-6\">\n            <div class=\"card\">\n                <div class=\"card-header\">\n                    <h5 class=\"mb-0\">Latest Jobs</h5>\n                </div>\n                <div class=\"card-body\">\n                    <div class=\"list-group list-group-flush\">\n                        <?php foreach ($latestJobs as $job): ?>\n                        <a href=\"/jobs/<?= $job['id'] ?>\" class=\"list-group-item list-group-item-action\">\n                            <h6 class=\"mb-1\"><?= htmlspecialchars($job['title']) ?></h6>\n                            <p class=\"mb-1 text-muted\">\n                                <small>\n                                    <i class=\"fas fa-building\"></i> <?= htmlspecialchars($job['employer_name']) ?> |\n                                    <i class=\"fas fa-map-marker-alt\"></i> <?= htmlspecialchars($job['location']) ?>\n                                </small>\n                            </p>\n                            <small class=\"text-muted\"><?= formatDate($job['created_at']) ?></small>\n                        </a>\n                        <?php endforeach; ?>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":4451,"size_tokens":null},"app/views/admin/view_user.php":{"content":"<?php\n$meta = generateMetaTags('View/Edit User - Admin', 'View and edit user details');\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container\">\n    <div class=\"row mb-4\">\n        <div class=\"col-md-8\">\n            <h1>View & Edit User</h1>\n        </div>\n        <div class=\"col-md-4 text-end\">\n            <a href=\"/admin/users\" class=\"btn btn-secondary\">Back to Users</a>\n        </div>\n    </div>\n    \n    <?php if ($error = getFlash('error')): ?>\n        <div class=\"alert alert-danger\"><?= htmlspecialchars($error) ?></div>\n    <?php endif; ?>\n    \n    <?php if ($success = getFlash('success')): ?>\n        <div class=\"alert alert-success\"><?= htmlspecialchars($success) ?></div>\n    <?php endif; ?>\n    \n    <div class=\"card\">\n        <div class=\"card-header bg-primary text-white\">\n            <h5 class=\"mb-0\">Complete Account Information</h5>\n        </div>\n        <div class=\"card-body\">\n            <form action=\"/admin/users/<?= $user['id'] ?>/update\" method=\"POST\">\n                <?= csrfField() ?>\n                \n                <div class=\"row\">\n                    <div class=\"col-md-6 mb-3\">\n                        <label for=\"name\" class=\"form-label\">Name</label>\n                        <input type=\"text\" class=\"form-control\" id=\"name\" name=\"name\" value=\"<?= htmlspecialchars($user['name']) ?>\" required>\n                    </div>\n                    <div class=\"col-md-6 mb-3\">\n                        <label for=\"email\" class=\"form-label\">Email Address</label>\n                        <input type=\"email\" class=\"form-control\" id=\"email\" name=\"email\" value=\"<?= htmlspecialchars($user['email']) ?>\" required>\n                    </div>\n                </div>\n                \n                <div class=\"row\">\n                    <div class=\"col-md-6 mb-3\">\n                        <label for=\"mobile_no\" class=\"form-label\">Mobile Number</label>\n                        <input type=\"tel\" class=\"form-control\" id=\"mobile_no\" name=\"mobile_no\" value=\"<?= htmlspecialchars($user['mobile_no'] ?? '') ?>\" placeholder=\"+91 1234567890\">\n                    </div>\n                </div>\n                \n                <div class=\"row\">\n                    <div class=\"col-md-6 mb-3\">\n                        <label for=\"type\" class=\"form-label\">User Type</label>\n                        <select class=\"form-select\" id=\"type\" name=\"type\" required>\n                            <option value=\"jobseeker\" <?= $user['type'] === 'jobseeker' ? 'selected' : '' ?>>Job Seeker</option>\n                            <option value=\"employer\" <?= $user['type'] === 'employer' ? 'selected' : '' ?>>Employer</option>\n                            <option value=\"admin\" <?= $user['type'] === 'admin' ? 'selected' : '' ?>>Admin</option>\n                        </select>\n                    </div>\n                    <div class=\"col-md-6 mb-3\">\n                        <label for=\"verified\" class=\"form-label\">Verification Status</label>\n                        <select class=\"form-select\" id=\"verified\" name=\"verified\" required>\n                            <option value=\"0\" <?= !$user['verified'] ? 'selected' : '' ?>>Not Verified</option>\n                            <option value=\"1\" <?= $user['verified'] ? 'selected' : '' ?>>Verified</option>\n                        </select>\n                    </div>\n                </div>\n                \n                <div class=\"row\">\n                    <div class=\"col-md-12 mb-3\">\n                        <label for=\"password\" class=\"form-label\">Change Password (Leave empty to keep current)</label>\n                        <input type=\"password\" class=\"form-control\" id=\"password\" name=\"password\" placeholder=\"Enter new password (min. 6 characters)\">\n                        <small class=\"form-text text-muted\">If you change the password, enter at least 6 characters.</small>\n                    </div>\n                </div>\n                \n                <div class=\"row\">\n                    <div class=\"col-md-12\">\n                        <p class=\"text-muted mb-2\"><strong>Account Created:</strong> <?= formatDate($user['created_at']) ?></p>\n                        <p class=\"text-muted mb-3\"><strong>User ID:</strong> <?= $user['id'] ?></p>\n                    </div>\n                </div>\n                \n                <div class=\"row\">\n                    <div class=\"col-md-12\">\n                        <button type=\"submit\" class=\"btn btn-success btn-lg\">Save Changes</button>\n                        <a href=\"/admin/users\" class=\"btn btn-secondary btn-lg\">Cancel</a>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":4711,"size_tokens":null},"app/views/employer/dashboard.php":{"content":"<?php\n$meta = generateMetaTags('Employer Dashboard', 'Manage your job postings');\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container\">\n    <h1 class=\"mb-4\">Employer Dashboard</h1>\n    \n    <?php if ($success = getFlash('success')): ?>\n        <div class=\"alert alert-success\"><?= $success ?></div>\n    <?php endif; ?>\n    \n    <div class=\"row mb-4\">\n        <div class=\"col-md-4\">\n            <div class=\"card text-white bg-primary\">\n                <div class=\"card-body\">\n                    <h5 class=\"card-title\">Total Jobs</h5>\n                    <p class=\"display-4\"><?= $stats['total_jobs'] ?></p>\n                </div>\n            </div>\n        </div>\n        <div class=\"col-md-4\">\n            <div class=\"card text-white bg-success\">\n                <div class=\"card-body\">\n                    <h5 class=\"card-title\">Approved Jobs</h5>\n                    <p class=\"display-4\"><?= $stats['approved_jobs'] ?></p>\n                </div>\n            </div>\n        </div>\n        <div class=\"col-md-4\">\n            <div class=\"card text-white bg-warning\">\n                <div class=\"card-body\">\n                    <h5 class=\"card-title\">Pending Jobs</h5>\n                    <p class=\"display-4\"><?= $stats['pending_jobs'] ?></p>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <div class=\"row mb-4\">\n        <div class=\"col-md-12\">\n            <div class=\"card\">\n                <div class=\"card-header\">\n                    <h5 class=\"mb-0\">Quick Actions</h5>\n                </div>\n                <div class=\"card-body\">\n                    <a href=\"/employer/post-job\" class=\"btn btn-primary me-2 mb-2\"><i class=\"fas fa-plus\"></i> Post New Job</a>\n                    <a href=\"/employer/jobs\" class=\"btn btn-outline-primary me-2 mb-2\"><i class=\"fas fa-list\"></i> View All Jobs</a>\n                    <a href=\"/employer/candidates\" class=\"btn btn-outline-success mb-2\"><i class=\"fas fa-users\"></i> Find Candidates</a>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <div class=\"row\">\n        <div class=\"col-md-12\">\n            <div class=\"card\">\n                <div class=\"card-header\">\n                    <h5 class=\"mb-0\">Recent Jobs</h5>\n                </div>\n                <div class=\"card-body\">\n                    <div class=\"table-responsive\">\n                        <table class=\"table\">\n                            <thead>\n                                <tr>\n                                    <th>Title</th>\n                                    <th>Location</th>\n                                    <th>Type</th>\n                                    <th>Status</th>\n                                    <th>Posted</th>\n                                    <th>Actions</th>\n                                </tr>\n                            </thead>\n                            <tbody>\n                                <?php foreach ($recentJobs as $job): ?>\n                                <tr>\n                                    <td><?= htmlspecialchars($job['title']) ?></td>\n                                    <td><?= htmlspecialchars($job['location']) ?></td>\n                                    <td><span class=\"badge bg-info\"><?= $job['type'] ?></span></td>\n                                    <td>\n                                        <span class=\"badge bg-<?= $job['status'] === 'Approved' ? 'success' : ($job['status'] === 'Pending' ? 'warning' : 'danger') ?>\">\n                                            <?= $job['status'] ?>\n                                        </span>\n                                    </td>\n                                    <td><?= formatDate($job['created_at']) ?></td>\n                                    <td>\n                                        <a href=\"/employer/jobs/<?= $job['id'] ?>/applications\" class=\"btn btn-sm btn-primary\">Applications</a>\n                                    </td>\n                                </tr>\n                                <?php endforeach; ?>\n                            </tbody>\n                        </table>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":4264,"size_tokens":null},"app/models/Application.php":{"content":"<?php\n/**\n * Application Model\n */\n\nrequire_once __DIR__ . '/../../config/database.php';\n\nclass Application {\n    private $db;\n    \n    public function __construct() {\n        $this->db = getDB();\n    }\n    \n    // Create new application\n    public function create($jobId, $userId, $resumePath) {\n        $sql = \"INSERT INTO applications (job_id, user_id, resume_path) \n                VALUES (:job_id, :user_id, :resume_path)\";\n        \n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([\n            ':job_id' => $jobId,\n            ':user_id' => $userId,\n            ':resume_path' => $resumePath\n        ]);\n        \n        return $this->db->lastInsertId();\n    }\n    \n    // Check if user already applied\n    public function hasApplied($jobId, $userId) {\n        $sql = \"SELECT COUNT(*) as count FROM applications \n                WHERE job_id = :job_id AND user_id = :user_id\";\n        \n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':job_id' => $jobId, ':user_id' => $userId]);\n        $result = $stmt->fetch();\n        \n        return $result['count'] > 0;\n    }\n    \n    // Get applications for a job\n    public function getByJob($jobId, $limit = null, $offset = 0) {\n        $sql = \"SELECT a.*, u.name as applicant_name, u.email as applicant_email,\n                jp.phone as applicant_phone\n                FROM applications a\n                JOIN users u ON a.user_id = u.id\n                LEFT JOIN jobseeker_profiles jp ON a.user_id = jp.user_id\n                WHERE a.job_id = :job_id\n                ORDER BY a.applied_at DESC\";\n        \n        if ($limit) {\n            $sql .= \" LIMIT :limit OFFSET :offset\";\n        }\n        \n        $stmt = $this->db->prepare($sql);\n        $stmt->bindValue(':job_id', $jobId, PDO::PARAM_INT);\n        \n        if ($limit) {\n            $stmt->bindValue(':limit', $limit, PDO::PARAM_INT);\n            $stmt->bindValue(':offset', $offset, PDO::PARAM_INT);\n        }\n        \n        $stmt->execute();\n        return $stmt->fetchAll();\n    }\n    \n    // Get applications by user\n    public function getByUser($userId, $limit = null, $offset = 0) {\n        $sql = \"SELECT a.*, j.title as job_title, j.location, j.type, j.salary,\n                u.name as employer_name, c.name as category_name\n                FROM applications a\n                JOIN jobs j ON a.job_id = j.id\n                JOIN users u ON j.employer_id = u.id\n                LEFT JOIN categories c ON j.category_id = c.id\n                WHERE a.user_id = :user_id\n                ORDER BY a.applied_at DESC\";\n        \n        if ($limit) {\n            $sql .= \" LIMIT :limit OFFSET :offset\";\n        }\n        \n        $stmt = $this->db->prepare($sql);\n        $stmt->bindValue(':user_id', $userId, PDO::PARAM_INT);\n        \n        if ($limit) {\n            $stmt->bindValue(':limit', $limit, PDO::PARAM_INT);\n            $stmt->bindValue(':offset', $offset, PDO::PARAM_INT);\n        }\n        \n        $stmt->execute();\n        return $stmt->fetchAll();\n    }\n    \n    // Count applications for a job\n    public function countByJob($jobId) {\n        $sql = \"SELECT COUNT(*) as total FROM applications WHERE job_id = :job_id\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':job_id' => $jobId]);\n        $result = $stmt->fetch();\n        return $result['total'];\n    }\n    \n    // Count applications by user\n    public function countByUser($userId) {\n        $sql = \"SELECT COUNT(*) as total FROM applications WHERE user_id = :user_id\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':user_id' => $userId]);\n        $result = $stmt->fetch();\n        return $result['total'];\n    }\n    \n    // Delete application\n    public function delete($id) {\n        $sql = \"DELETE FROM applications WHERE id = :id\";\n        $stmt = $this->db->prepare($sql);\n        return $stmt->execute([':id' => $id]);\n    }\n    \n    // Find application by ID\n    public function findById($id) {\n        $sql = \"SELECT a.*, u.name as applicant_name, u.email as applicant_email,\n                jp.phone as applicant_phone\n                FROM applications a\n                JOIN users u ON a.user_id = u.id\n                LEFT JOIN jobseeker_profiles jp ON a.user_id = jp.user_id\n                WHERE a.id = :id\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':id' => $id]);\n        return $stmt->fetch();\n    }\n    \n    // Update application status\n    public function updateStatus($id, $status) {\n        $sql = \"UPDATE applications SET status = :status WHERE id = :id\";\n        $stmt = $this->db->prepare($sql);\n        return $stmt->execute([':id' => $id, ':status' => $status]);\n    }\n    \n    // Get all applications for employer\n    public function getByEmployer($employerId, $limit = null, $offset = 0) {\n        $sql = \"SELECT a.*, j.title as job_title, u.name as applicant_name, u.email as applicant_email\n                FROM applications a\n                JOIN jobs j ON a.job_id = j.id\n                JOIN users u ON a.user_id = u.id\n                WHERE j.employer_id = :employer_id\n                ORDER BY a.applied_at DESC\";\n        \n        if ($limit) {\n            $sql .= \" LIMIT :limit OFFSET :offset\";\n        }\n        \n        $stmt = $this->db->prepare($sql);\n        $stmt->bindValue(':employer_id', $employerId, PDO::PARAM_INT);\n        \n        if ($limit) {\n            $stmt->bindValue(':limit', $limit, PDO::PARAM_INT);\n            $stmt->bindValue(':offset', $offset, PDO::PARAM_INT);\n        }\n        \n        $stmt->execute();\n        return $stmt->fetchAll();\n    }\n}\n","path":null,"size_bytes":5609,"size_tokens":null},"includes/seo.php":{"content":"<?php\n/**\n * SEO Helper Functions\n */\n\n// Generate page meta tags\nfunction generateMetaTags($title, $description = '', $keywords = '', $image = '') {\n    $siteName = APP_NAME;\n    $fullTitle = $title . ' | ' . $siteName;\n    \n    // Truncate if needed\n    if (strlen($fullTitle) > META_TITLE_LENGTH) {\n        $fullTitle = substr($fullTitle, 0, META_TITLE_LENGTH - 3) . '...';\n    }\n    \n    if (strlen($description) > META_DESCRIPTION_LENGTH) {\n        $description = substr($description, 0, META_DESCRIPTION_LENGTH - 3) . '...';\n    }\n    \n    $meta = [\n        'title' => htmlspecialchars($fullTitle, ENT_QUOTES),\n        'description' => htmlspecialchars($description, ENT_QUOTES),\n        'keywords' => htmlspecialchars($keywords, ENT_QUOTES),\n        'image' => $image ? htmlspecialchars($image, ENT_QUOTES) : asset('images/logo.png'),\n        'url' => htmlspecialchars(getCurrentUrl(), ENT_QUOTES)\n    ];\n    \n    return $meta;\n}\n\n// Get current URL\nfunction getCurrentUrl() {\n    $protocol = isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] === 'on' ? 'https' : 'http';\n    $host = $_SERVER['HTTP_HOST'] ?? 'localhost';\n    $uri = $_SERVER['REQUEST_URI'] ?? '';\n    return $protocol . '://' . $host . $uri;\n}\n\n// Generate job Schema.org JSON-LD\nfunction generateJobSchema($job) {\n    $schema = [\n        '@context' => 'https://schema.org/',\n        '@type' => 'JobPosting',\n        'title' => $job['title'],\n        'description' => strip_tags($job['description']),\n        'datePosted' => date('Y-m-d', strtotime($job['created_at'])),\n        'employmentType' => strtoupper(str_replace('-', '_', $job['type'])),\n        'hiringOrganization' => [\n            '@type' => 'Organization',\n            'name' => APP_NAME\n        ],\n        'jobLocation' => [\n            '@type' => 'Place',\n            'address' => [\n                '@type' => 'PostalAddress',\n                'addressLocality' => $job['location'],\n                'addressCountry' => 'IN'\n            ]\n        ]\n    ];\n    \n    if (!empty($job['salary'])) {\n        $salaryParts = explode('-', $job['salary']);\n        if (count($salaryParts) === 2) {\n            $schema['baseSalary'] = [\n                '@type' => 'MonetaryAmount',\n                'currency' => 'INR',\n                'value' => [\n                    '@type' => 'QuantitativeValue',\n                    'minValue' => trim($salaryParts[0]),\n                    'maxValue' => trim($salaryParts[1]),\n                    'unitText' => 'MONTH'\n                ]\n            ];\n        }\n    }\n    \n    return json_encode($schema, JSON_UNESCAPED_SLASHES | JSON_PRETTY_PRINT);\n}\n\n// Generate breadcrumb Schema.org JSON-LD\nfunction generateBreadcrumbSchema($items) {\n    $listItems = [];\n    foreach ($items as $index => $item) {\n        $listItems[] = [\n            '@type' => 'ListItem',\n            'position' => $index + 1,\n            'name' => $item['name'],\n            'item' => $item['url'] ?? getCurrentUrl()\n        ];\n    }\n    \n    $schema = [\n        '@context' => 'https://schema.org/',\n        '@type' => 'BreadcrumbList',\n        'itemListElement' => $listItems\n    ];\n    \n    return json_encode($schema, JSON_UNESCAPED_SLASHES | JSON_PRETTY_PRINT);\n}\n\n// Render meta tags in HTML\nfunction renderMetaTags($meta) {\n    echo '<title>' . $meta['title'] . '</title>' . \"\\n\";\n    echo '<meta name=\"description\" content=\"' . $meta['description'] . '\">' . \"\\n\";\n    if (!empty($meta['keywords'])) {\n        echo '<meta name=\"keywords\" content=\"' . $meta['keywords'] . '\">' . \"\\n\";\n    }\n    \n    // Open Graph tags\n    echo '<meta property=\"og:title\" content=\"' . $meta['title'] . '\">' . \"\\n\";\n    echo '<meta property=\"og:description\" content=\"' . $meta['description'] . '\">' . \"\\n\";\n    echo '<meta property=\"og:image\" content=\"' . $meta['image'] . '\">' . \"\\n\";\n    echo '<meta property=\"og:url\" content=\"' . $meta['url'] . '\">' . \"\\n\";\n    echo '<meta property=\"og:type\" content=\"website\">' . \"\\n\";\n    \n    // Twitter Card tags\n    echo '<meta name=\"twitter:card\" content=\"summary_large_image\">' . \"\\n\";\n    echo '<meta name=\"twitter:title\" content=\"' . $meta['title'] . '\">' . \"\\n\";\n    echo '<meta name=\"twitter:description\" content=\"' . $meta['description'] . '\">' . \"\\n\";\n    echo '<meta name=\"twitter:image\" content=\"' . $meta['image'] . '\">' . \"\\n\";\n}\n","path":null,"size_bytes":4306,"size_tokens":null},"app/views/jobs/index.php":{"content":"<?php\n$meta = generateMetaTags('Browse Jobs', 'Find your next career opportunity. Browse thousands of jobs across multiple categories.');\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container\">\n    <h1 class=\"mb-4\">Browse Jobs</h1>\n    \n    <?php if ($error = getFlash('error')): ?>\n        <div class=\"alert alert-danger\"><?= $error ?></div>\n    <?php endif; ?>\n    \n    <?php if ($success = getFlash('success')): ?>\n        <div class=\"alert alert-success\"><?= $success ?></div>\n    <?php endif; ?>\n    \n    <div class=\"row mb-4\">\n        <div class=\"col-md-12\">\n            <form action=\"/jobs\" method=\"GET\" class=\"card p-3\">\n                <div class=\"row g-3\">\n                    <div class=\"col-md-4\">\n                        <input type=\"text\" class=\"form-control\" name=\"search\" placeholder=\"Search jobs...\" value=\"<?= htmlspecialchars($_GET['search'] ?? '') ?>\">\n                    </div>\n                    <div class=\"col-md-3\">\n                        <select name=\"category\" class=\"form-select\">\n                            <option value=\"\">All Categories</option>\n                            <?php foreach ($categories as $cat): ?>\n                                <option value=\"<?= $cat['id'] ?>\" <?= (isset($_GET['category']) && $_GET['category'] == $cat['id']) ? 'selected' : '' ?>>\n                                    <?= htmlspecialchars($cat['name']) ?>\n                                </option>\n                            <?php endforeach; ?>\n                        </select>\n                    </div>\n                    <div class=\"col-md-3\">\n                        <input type=\"text\" class=\"form-control\" name=\"location\" placeholder=\"Location\" value=\"<?= htmlspecialchars($_GET['location'] ?? '') ?>\">\n                    </div>\n                    <div class=\"col-md-2\">\n                        <button type=\"submit\" class=\"btn btn-primary w-100\">Search</button>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n    \n    <div class=\"row\">\n        <?php if (empty($jobs)): ?>\n            <div class=\"col-12\">\n                <div class=\"alert alert-info\">No jobs found. Try adjusting your search criteria.</div>\n            </div>\n        <?php else: ?>\n            <?php foreach ($jobs as $job): ?>\n            <div class=\"col-md-12 mb-3\">\n                <div class=\"card shadow-sm\">\n                    <div class=\"card-body\">\n                        <div class=\"row\">\n                            <div class=\"col-md-9\">\n                                <h5 class=\"card-title\">\n                                    <a href=\"/jobs/<?= $job['id'] ?>\" class=\"text-decoration-none\">\n                                        <?= htmlspecialchars($job['title']) ?>\n                                    </a>\n                                </h5>\n                                <p class=\"text-muted mb-2\">\n                                    <i class=\"fas fa-building\"></i> <?= htmlspecialchars($job['employer_name']) ?> |\n                                    <i class=\"fas fa-map-marker-alt\"></i> <?= htmlspecialchars($job['location']) ?>\n                                </p>\n                                <p class=\"mb-2\">\n                                    <span class=\"badge bg-info\"><?= htmlspecialchars($job['type']) ?></span>\n                                    <span class=\"badge bg-secondary\"><?= htmlspecialchars($job['category_name']) ?></span>\n                                    <?php if ($job['salary']): ?>\n                                        <span class=\"badge bg-success\"><?= formatSalary($job['salary']) ?></span>\n                                    <?php endif; ?>\n                                </p>\n                                <p class=\"card-text\"><?= truncate(strip_tags($job['description']), 150) ?></p>\n                            </div>\n                            <div class=\"col-md-3 text-end\">\n                                <small class=\"text-muted d-block mb-2\">\n                                    <i class=\"fas fa-clock\"></i> <?= formatDate($job['created_at']) ?>\n                                </small>\n                                <a href=\"/jobs/<?= $job['id'] ?>\" class=\"btn btn-primary\">View Details</a>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            </div>\n            <?php endforeach; ?>\n            \n            <?php if ($pagination['total_pages'] > 1): ?>\n            <div class=\"col-12\">\n                <nav>\n                    <ul class=\"pagination justify-content-center\">\n                        <?php for ($i = 1; $i <= $pagination['total_pages']; $i++): ?>\n                            <li class=\"page-item <?= $i === $pagination['current_page'] ? 'active' : '' ?>\">\n                                <a class=\"page-link\" href=\"?page=<?= $i ?><?= !empty($_GET['search']) ? '&search=' . urlencode($_GET['search']) : '' ?><?= !empty($_GET['category']) ? '&category=' . $_GET['category'] : '' ?><?= !empty($_GET['location']) ? '&location=' . urlencode($_GET['location']) : '' ?>\">\n                                    <?= $i ?>\n                                </a>\n                            </li>\n                        <?php endfor; ?>\n                    </ul>\n                </nav>\n            </div>\n            <?php endif; ?>\n        <?php endif; ?>\n    </div>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":5454,"size_tokens":null},"app/controllers/EmployerController.php":{"content":"<?php\n/**\n * Employer Controller\n */\n\nrequire_once __DIR__ . '/../../config/database.php';\nrequire_once __DIR__ . '/../../config/constants.php';\nrequire_once __DIR__ . '/../../includes/functions.php';\nrequire_once __DIR__ . '/../../includes/csrf.php';\nrequire_once __DIR__ . '/../../app/models/Job.php';\nrequire_once __DIR__ . '/../../app/models/Category.php';\nrequire_once __DIR__ . '/../../app/models/Application.php';\nrequire_once __DIR__ . '/../../app/models/JobSeekerProfile.php';\nrequire_once __DIR__ . '/../../app/models/User.php';\nrequire_once __DIR__ . '/../../app/models/Notification.php';\nrequire_once __DIR__ . '/../../app/models/Conversation.php';\n\nclass EmployerController {\n    private $jobModel;\n    private $categoryModel;\n    private $applicationModel;\n    private $profileModel;\n    private $userModel;\n    \n    public function __construct() {\n        requireRole(USER_TYPE_EMPLOYER);\n        \n        $this->jobModel = new Job();\n        $this->categoryModel = new Category();\n        $this->applicationModel = new Application();\n        $this->profileModel = new JobSeekerProfile();\n        $this->userModel = new User();\n    }\n    \n    // View and filter candidates\n    public function candidates() {\n        $user = getCurrentUser();\n        $filters = [];\n        \n        if (!empty($_GET['city'])) {\n            $filters['city'] = sanitize($_GET['city']);\n        }\n        \n        if (!empty($_GET['state'])) {\n            $filters['state'] = sanitize($_GET['state']);\n        }\n        \n        if (!empty($_GET['skill'])) {\n            $filters['skill'] = sanitize($_GET['skill']);\n        }\n        \n        if (!empty($_GET['min_experience'])) {\n            $filters['min_experience'] = (int)$_GET['min_experience'];\n        }\n        \n        if (!empty($_GET['max_experience'])) {\n            $filters['max_experience'] = (int)$_GET['max_experience'];\n        }\n        \n        if (!empty($_GET['availability'])) {\n            $filters['availability'] = sanitize($_GET['availability']);\n        }\n        \n        $candidates = $this->profileModel->searchCandidates($filters);\n        \n        $conversationModel = new Conversation();\n        $selectedCandidates = $conversationModel->getSelectedCandidatesByEmployer($user['id']);\n        \n        require __DIR__ . '/../views/employer/candidates.php';\n    }\n    \n    // View candidate full profile\n    public function viewCandidate($userId) {\n        $user = $this->userModel->findById($userId);\n        \n        if (!$user || $user['type'] !== USER_TYPE_JOBSEEKER) {\n            setFlash('error', 'Candidate not found');\n            redirect('/employer/candidates');\n        }\n        \n        $data = $this->profileModel->getCompleteProfile($userId);\n        $data['user'] = $user;\n        \n        require __DIR__ . '/../views/employer/candidate_profile.php';\n    }\n    \n    // Employer dashboard\n    public function dashboard() {\n        $user = getCurrentUser();\n        \n        $stats = [\n            'total_jobs' => $this->jobModel->count(['employer_id' => $user['id']]),\n            'approved_jobs' => $this->jobModel->count([\n                'employer_id' => $user['id'],\n                'status' => JOB_STATUS_APPROVED\n            ]),\n            'pending_jobs' => $this->jobModel->count([\n                'employer_id' => $user['id'],\n                'status' => JOB_STATUS_PENDING\n            ]),\n        ];\n        \n        $recentJobs = $this->jobModel->getAll([\n            'employer_id' => $user['id'],\n            'limit' => 10\n        ]);\n        \n        require __DIR__ . '/../views/employer/dashboard.php';\n    }\n    \n    // List employer's jobs\n    public function jobs() {\n        $user = getCurrentUser();\n        $page = isset($_GET['page']) ? (int)$_GET['page'] : 1;\n        \n        $jobs = $this->jobModel->getAll([\n            'employer_id' => $user['id'],\n            'limit' => JOBS_PER_PAGE,\n            'offset' => ($page - 1) * JOBS_PER_PAGE\n        ]);\n        \n        $totalJobs = $this->jobModel->count(['employer_id' => $user['id']]);\n        $pagination = paginate($totalJobs, JOBS_PER_PAGE, $page);\n        \n        require __DIR__ . '/../views/employer/jobs.php';\n    }\n    \n    // Show post job form\n    public function showPostJob() {\n        $categories = $this->categoryModel->getAll();\n        require __DIR__ . '/../views/employer/post-job.php';\n    }\n    \n    // Handle post job\n    public function postJob() {\n        checkCSRF();\n        \n        $user = getCurrentUser();\n        \n        $title = sanitize($_POST['title'] ?? '');\n        $description = sanitize($_POST['description'] ?? '');\n        $categoryId = (int)($_POST['category_id'] ?? 0);\n        $location = sanitize($_POST['location'] ?? '');\n        $salary = sanitize($_POST['salary'] ?? '');\n        $type = sanitize($_POST['type'] ?? JOB_TYPE_FULLTIME);\n        \n        // Validate\n        $errors = [];\n        \n        if (empty($title) || empty($description) || empty($location)) {\n            $errors[] = 'All required fields must be filled';\n        }\n        \n        if ($categoryId <= 0) {\n            $errors[] = 'Please select a category';\n        }\n        \n        if (!in_array($type, [JOB_TYPE_FULLTIME, JOB_TYPE_PARTTIME, JOB_TYPE_CONTRACT, JOB_TYPE_INTERNSHIP])) {\n            $errors[] = 'Invalid job type';\n        }\n        \n        if (!empty($errors)) {\n            setFlash('error', implode('<br>', $errors));\n            redirect('/employer/post-job');\n        }\n        \n        // Create job\n        $jobId = $this->jobModel->create([\n            'title' => $title,\n            'description' => $description,\n            'category_id' => $categoryId,\n            'employer_id' => $user['id'],\n            'location' => $location,\n            'salary' => $salary,\n            'type' => $type,\n            'status' => JOB_STATUS_PENDING\n        ]);\n        \n        if ($jobId) {\n            setFlash('success', SUCCESS_JOB_POSTED);\n            redirect('/employer/jobs');\n        } else {\n            setFlash('error', 'Failed to post job. Please try again.');\n            redirect('/employer/post-job');\n        }\n    }\n    \n    // View applications for a job\n    public function applications($jobId = null) {\n        $user = getCurrentUser();\n        \n        if ($jobId) {\n            // View applications for specific job\n            $job = $this->jobModel->findById($jobId);\n            \n            if (!$job || $job['employer_id'] != $user['id']) {\n                setFlash('error', ERROR_UNAUTHORIZED);\n                redirect('/employer/dashboard');\n            }\n            \n            $applications = $this->applicationModel->getByJob($jobId);\n            require __DIR__ . '/../views/employer/job-applications.php';\n        } else {\n            // View all applications\n            $page = isset($_GET['page']) ? (int)$_GET['page'] : 1;\n            $applications = $this->applicationModel->getByEmployer(\n                $user['id'],\n                APPLICATIONS_PER_PAGE,\n                ($page - 1) * APPLICATIONS_PER_PAGE\n            );\n            \n            require __DIR__ . '/../views/employer/applications.php';\n        }\n    }\n    \n    // Delete job\n    public function deleteJob($id) {\n        checkCSRF();\n        \n        $user = getCurrentUser();\n        $job = $this->jobModel->findById($id);\n        \n        if (!$job || $job['employer_id'] != $user['id']) {\n            setFlash('error', ERROR_UNAUTHORIZED);\n            redirect('/employer/jobs');\n        }\n        \n        if ($this->jobModel->delete($id)) {\n            setFlash('success', 'Job deleted successfully');\n        } else {\n            setFlash('error', 'Failed to delete job');\n        }\n        \n        redirect('/employer/jobs');\n    }\n    \n    // Select candidate for a job\n    public function selectCandidate($jobId, $applicationId) {\n        checkCSRF();\n        \n        $user = getCurrentUser();\n        $job = $this->jobModel->findById($jobId);\n        \n        if (!$job || $job['employer_id'] != $user['id']) {\n            setFlash('error', ERROR_UNAUTHORIZED);\n            redirect('/employer/dashboard');\n        }\n        \n        $application = $this->applicationModel->findById($applicationId);\n        \n        if (!$application || $application['job_id'] != $jobId) {\n            setFlash('error', 'Application not found');\n            redirect(\"/employer/jobs/$jobId/applications\");\n        }\n        \n        // Update application status to selected\n        $this->applicationModel->updateStatus($applicationId, 'selected');\n        \n        // Prepare email and WhatsApp notification details\n        $candidateName = $application['applicant_name'];\n        $candidateEmail = $application['applicant_email'];\n        $candidatePhone = $application['applicant_phone'] ?? '';\n        $candidateId = $application['user_id'];\n        $jobTitle = $job['title'];\n        $companyName = $user['name'];\n        \n        // Create in-app notification for the candidate\n        $notificationModel = new Notification();\n        $notificationModel->notifyJobSeekerSelected($candidateId, $user['id'], $jobId, $applicationId, $jobTitle, $companyName);\n        \n        // Create or get existing conversation\n        $conversationModel = new Conversation();\n        $existingConversation = $conversationModel->findByParticipants($user['id'], $candidateId, $jobId);\n        \n        if (!$existingConversation) {\n            $conversationModel->create([\n                'employer_id' => $user['id'],\n                'candidate_id' => $candidateId,\n                'job_id' => $jobId,\n                'application_id' => $applicationId,\n                'status' => 'active'\n            ]);\n        }\n        \n        // Clean phone number for WhatsApp (ensure country code)\n        $cleanPhone = preg_replace('/[^0-9]/', '', $candidatePhone);\n        \n        // Create email subject and body\n        $emailSubject = \"Congratulations! You have been selected for \" . $jobTitle;\n        $emailBody = \"Dear \" . $candidateName . \",\\n\\nCongratulations! We are pleased to inform you that you have been selected for the position of \" . $jobTitle . \" at \" . $companyName . \".\\n\\nWe will contact you shortly with further details about the next steps.\\n\\nBest regards,\\n\" . $companyName;\n        \n        // Create WhatsApp message\n        $whatsappMessage = \"Congratulations \" . $candidateName . \"! You have been selected for the position of \" . $jobTitle . \" at \" . $companyName . \". We will contact you shortly with further details.\";\n        \n        // Store notification links in session for the view\n        $_SESSION['selection_notification'] = [\n            'candidate_name' => $candidateName,\n            'candidate_email' => $candidateEmail,\n            'candidate_phone' => $cleanPhone,\n            'email_subject' => $emailSubject,\n            'email_body' => $emailBody,\n            'whatsapp_message' => $whatsappMessage\n        ];\n        \n        setFlash('success', \"Candidate \" . $candidateName . \" has been selected! They have been notified and you can now chat with them. Send them an email/WhatsApp using the buttons below.\");\n        \n        redirect(\"/employer/jobs/$jobId/applications\");\n    }\n}\n","path":null,"size_bytes":11246,"size_tokens":null},"app/controllers/JobController.php":{"content":"<?php\n/**\n * Job Controller\n */\n\nrequire_once __DIR__ . '/../../config/database.php';\nrequire_once __DIR__ . '/../../config/constants.php';\nrequire_once __DIR__ . '/../../includes/functions.php';\nrequire_once __DIR__ . '/../../includes/csrf.php';\nrequire_once __DIR__ . '/../../includes/seo.php';\nrequire_once __DIR__ . '/../../app/models/Job.php';\nrequire_once __DIR__ . '/../../app/models/Category.php';\nrequire_once __DIR__ . '/../../app/models/Application.php';\n\nclass JobController {\n    private $jobModel;\n    private $categoryModel;\n    private $applicationModel;\n    \n    public function __construct() {\n        $this->jobModel = new Job();\n        $this->categoryModel = new Category();\n        $this->applicationModel = new Application();\n    }\n    \n    // List all jobs\n    public function index() {\n        $page = isset($_GET['page']) ? (int)$_GET['page'] : 1;\n        $filters = [\n            'status' => JOB_STATUS_APPROVED,\n            'limit' => JOBS_PER_PAGE,\n            'offset' => ($page - 1) * JOBS_PER_PAGE\n        ];\n        \n        if (!empty($_GET['category'])) {\n            $filters['category_id'] = (int)$_GET['category'];\n        }\n        \n        if (!empty($_GET['type'])) {\n            $filters['type'] = sanitize($_GET['type']);\n        }\n        \n        if (!empty($_GET['location'])) {\n            $filters['location'] = sanitize($_GET['location']);\n        }\n        \n        if (!empty($_GET['search'])) {\n            $filters['search'] = sanitize($_GET['search']);\n        }\n        \n        $jobs = $this->jobModel->getAll($filters);\n        $totalJobs = $this->jobModel->count(['status' => JOB_STATUS_APPROVED]);\n        $pagination = paginate($totalJobs, JOBS_PER_PAGE, $page);\n        \n        $categories = $this->categoryModel->getAll();\n        \n        require __DIR__ . '/../views/jobs/index.php';\n    }\n    \n    // Show single job\n    public function show($id) {\n        $job = $this->jobModel->findById($id);\n        \n        if (!$job || $job['status'] !== JOB_STATUS_APPROVED) {\n            http_response_code(404);\n            die('Job not found');\n        }\n        \n        // Check if user has applied\n        $hasApplied = false;\n        if (isLoggedIn()) {\n            $user = getCurrentUser();\n            $hasApplied = $this->applicationModel->hasApplied($id, $user['id']);\n        }\n        \n        require __DIR__ . '/../views/jobs/show.php';\n    }\n    \n    // Apply for job\n    public function apply($jobId) {\n        requireAuth();\n        checkCSRF();\n        \n        $user = getCurrentUser();\n        \n        // Only job seekers can apply\n        if ($user['type'] !== USER_TYPE_JOBSEEKER) {\n            setFlash('error', 'Only job seekers can apply for jobs');\n            redirect('/jobs/' . $jobId);\n        }\n        \n        // Check if job exists\n        $job = $this->jobModel->findById($jobId);\n        if (!$job || $job['status'] !== JOB_STATUS_APPROVED) {\n            setFlash('error', 'Job not found');\n            redirect('/jobs');\n        }\n        \n        // Check if already applied\n        if ($this->applicationModel->hasApplied($jobId, $user['id'])) {\n            setFlash('error', 'You have already applied for this job');\n            redirect('/jobs/' . $jobId);\n        }\n        \n        // Validate file upload\n        if (!isset($_FILES['resume']) || $_FILES['resume']['error'] !== UPLOAD_ERR_OK) {\n            setFlash('error', 'Please upload your resume');\n            redirect('/jobs/' . $jobId);\n        }\n        \n        $errors = validateFileUpload($_FILES['resume']);\n        if (!empty($errors)) {\n            setFlash('error', implode('<br>', $errors));\n            redirect('/jobs/' . $jobId);\n        }\n        \n        // Upload resume\n        $resumePath = uploadFile($_FILES['resume'], UPLOAD_PATH . 'resumes/');\n        \n        if (!$resumePath) {\n            setFlash('error', 'Failed to upload resume');\n            redirect('/jobs/' . $jobId);\n        }\n        \n        // Create application\n        $applicationId = $this->applicationModel->create($jobId, $user['id'], $resumePath);\n        \n        if ($applicationId) {\n            setFlash('success', SUCCESS_APPLICATION);\n        } else {\n            setFlash('error', 'Application failed. Please try again.');\n        }\n        \n        redirect('/jobs/' . $jobId);\n    }\n    \n    // Search jobs (AJAX)\n    public function search() {\n        header('Content-Type: application/json');\n        \n        $query = sanitize($_GET['q'] ?? '');\n        \n        if (strlen($query) < 2) {\n            echo json_encode([]);\n            exit;\n        }\n        \n        $results = $this->jobModel->search($query, 10);\n        echo json_encode($results);\n    }\n}\n","path":null,"size_bytes":4727,"size_tokens":null},"app/views/jobseeker/edit_profile.php":{"content":"<?php\n$meta = generateMetaTags('Edit Profile', 'Update your professional profile');\nrequire __DIR__ . '/../common/header.php';\n\n$profile = $data['profile'] ?? [];\n$workExperiences = $data['work_experiences'] ?? [];\n$education = $data['education'] ?? [];\n$skills = $data['skills'] ?? [];\n$certifications = $data['certifications'] ?? [];\n$languages = $data['languages'] ?? [];\n$projects = $data['projects'] ?? [];\n?>\n\n<style>\n.section-card {\n    background: #fff;\n    border-radius: 8px;\n    padding: 24px;\n    margin-bottom: 24px;\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n}\n.section-header {\n    display: flex;\n    justify-content: space-between;\n    align-items: center;\n    margin-bottom: 20px;\n    border-bottom: 2px solid #0d6efd;\n    padding-bottom: 10px;\n}\n.badge-proficiency {\n    font-size: 0.75rem;\n    padding: 4px 8px;\n}\n.item-card {\n    background: #f8f9fa;\n    padding: 15px;\n    border-radius: 6px;\n    margin-bottom: 12px;\n    border-left: 3px solid #0d6efd;\n}\n</style>\n\n<div class=\"container my-5\">\n    <div class=\"row\">\n        <div class=\"col-md-12\">\n            <div class=\"d-flex justify-content-between align-items-center mb-4\">\n                <h2><i class=\"fas fa-user-edit\"></i> Edit Professional Profile</h2>\n                <a href=\"/jobseeker/profile\" class=\"btn btn-outline-secondary\">\n                    <i class=\"fas fa-eye\"></i> View Profile\n                </a>\n            </div>\n\n            <?php if ($error = getFlash('error')): ?>\n                <div class=\"alert alert-danger\"><?= $error ?></div>\n            <?php endif; ?>\n            \n            <?php if ($success = getFlash('success')): ?>\n                <div class=\"alert alert-success\"><?= $success ?></div>\n            <?php endif; ?>\n\n            <!-- Basic Information -->\n            <div class=\"section-card\">\n                <div class=\"section-header\">\n                    <h4><i class=\"fas fa-info-circle\"></i> Basic Information</h4>\n                </div>\n                <form action=\"/jobseeker/profile/update-basic\" method=\"POST\">\n                    <?= csrfField() ?>\n                    \n                    <div class=\"row\">\n                        <div class=\"col-md-6 mb-3\">\n                            <label class=\"form-label\">Professional Headline *</label>\n                            <input type=\"text\" name=\"headline\" class=\"form-control\" \n                                   value=\"<?= htmlspecialchars($profile['headline'] ?? '') ?>\"\n                                   placeholder=\"e.g., Full Stack Developer | React & Node.js Expert\" required>\n                        </div>\n                        <div class=\"col-md-6 mb-3\">\n                            <label class=\"form-label\">Phone Number</label>\n                            <input type=\"tel\" name=\"phone\" class=\"form-control\" \n                                   value=\"<?= htmlspecialchars($profile['phone'] ?? '') ?>\"\n                                   placeholder=\"+91 9876543210\">\n                        </div>\n                    </div>\n\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Professional Summary</label>\n                        <textarea name=\"summary\" class=\"form-control\" rows=\"4\"\n                                  placeholder=\"Write a compelling summary of your professional background, skills, and career objectives...\"><?= htmlspecialchars($profile['summary'] ?? '') ?></textarea>\n                    </div>\n\n                    <div class=\"row\">\n                        <div class=\"col-md-6 mb-3\">\n                            <label class=\"form-label\">City *</label>\n                            <input type=\"text\" name=\"city\" class=\"form-control\" \n                                   value=\"<?= htmlspecialchars($profile['city'] ?? '') ?>\" required>\n                        </div>\n                        <div class=\"col-md-6 mb-3\">\n                            <label class=\"form-label\">State *</label>\n                            <input type=\"text\" name=\"state\" class=\"form-control\" \n                                   value=\"<?= htmlspecialchars($profile['state'] ?? '') ?>\" required>\n                        </div>\n                    </div>\n\n                    <div class=\"row\">\n                        <div class=\"col-md-6 mb-3\">\n                            <label class=\"form-label\">Country</label>\n                            <input type=\"text\" name=\"country\" class=\"form-control\" \n                                   value=\"<?= htmlspecialchars($profile['country'] ?? 'India') ?>\">\n                        </div>\n                        <div class=\"col-md-6 mb-3\">\n                            <label class=\"form-label\">Postal Code</label>\n                            <input type=\"text\" name=\"postal_code\" class=\"form-control\" \n                                   value=\"<?= htmlspecialchars($profile['postal_code'] ?? '') ?>\">\n                        </div>\n                    </div>\n\n                    <div class=\"mb-3\">\n                        <label class=\"form-label\">Full Address</label>\n                        <textarea name=\"address\" class=\"form-control\" rows=\"2\"><?= htmlspecialchars($profile['address'] ?? '') ?></textarea>\n                    </div>\n\n                    <div class=\"row\">\n                        <div class=\"col-md-4 mb-3\">\n                            <label class=\"form-label\">Date of Birth</label>\n                            <input type=\"date\" name=\"date_of_birth\" class=\"form-control\" \n                                   value=\"<?= htmlspecialchars($profile['date_of_birth'] ?? '') ?>\">\n                        </div>\n                        <div class=\"col-md-4 mb-3\">\n                            <label class=\"form-label\">Gender</label>\n                            <select name=\"gender\" class=\"form-control\">\n                                <option value=\"\">Select</option>\n                                <option value=\"male\" <?= ($profile['gender'] ?? '') === 'male' ? 'selected' : '' ?>>Male</option>\n                                <option value=\"female\" <?= ($profile['gender'] ?? '') === 'female' ? 'selected' : '' ?>>Female</option>\n                                <option value=\"other\" <?= ($profile['gender'] ?? '') === 'other' ? 'selected' : '' ?>>Other</option>\n                                <option value=\"prefer_not_to_say\" <?= ($profile['gender'] ?? '') === 'prefer_not_to_say' ? 'selected' : '' ?>>Prefer not to say</option>\n                            </select>\n                        </div>\n                        <div class=\"col-md-4 mb-3\">\n                            <label class=\"form-label\">Total Experience (Years)</label>\n                            <input type=\"number\" name=\"total_experience_years\" class=\"form-control\" min=\"0\" max=\"50\"\n                                   value=\"<?= htmlspecialchars($profile['total_experience_years'] ?? 0) ?>\">\n                        </div>\n                    </div>\n\n                    <div class=\"row\">\n                        <div class=\"col-md-4 mb-3\">\n                            <label class=\"form-label\">Current Salary (₹)</label>\n                            <input type=\"number\" name=\"current_salary\" class=\"form-control\" \n                                   value=\"<?= htmlspecialchars($profile['current_salary'] ?? '') ?>\"\n                                   placeholder=\"e.g., 800000\">\n                        </div>\n                        <div class=\"col-md-4 mb-3\">\n                            <label class=\"form-label\">Expected Salary (₹)</label>\n                            <input type=\"number\" name=\"expected_salary\" class=\"form-control\" \n                                   value=\"<?= htmlspecialchars($profile['expected_salary'] ?? '') ?>\"\n                                   placeholder=\"e.g., 1200000\">\n                        </div>\n                        <div class=\"col-md-4 mb-3\">\n                            <label class=\"form-label\">Notice Period</label>\n                            <input type=\"text\" name=\"notice_period\" class=\"form-control\" \n                                   value=\"<?= htmlspecialchars($profile['notice_period'] ?? '') ?>\"\n                                   placeholder=\"e.g., 30 days\">\n                        </div>\n                    </div>\n\n                    <div class=\"row\">\n                        <div class=\"col-md-6 mb-3\">\n                            <label class=\"form-label\">Availability</label>\n                            <select name=\"availability\" class=\"form-control\">\n                                <option value=\"immediate\" <?= ($profile['availability'] ?? 'immediate') === 'immediate' ? 'selected' : '' ?>>Immediate</option>\n                                <option value=\"15_days\" <?= ($profile['availability'] ?? '') === '15_days' ? 'selected' : '' ?>>15 Days</option>\n                                <option value=\"1_month\" <?= ($profile['availability'] ?? '') === '1_month' ? 'selected' : '' ?>>1 Month</option>\n                                <option value=\"2_months\" <?= ($profile['availability'] ?? '') === '2_months' ? 'selected' : '' ?>>2 Months</option>\n                                <option value=\"3_months\" <?= ($profile['availability'] ?? '') === '3_months' ? 'selected' : '' ?>>3+ Months</option>\n                            </select>\n                        </div>\n                        <div class=\"col-md-6 mb-3\">\n                            <div class=\"form-check mt-4\">\n                                <input type=\"checkbox\" class=\"form-check-input\" id=\"willing_to_relocate\" \n                                       name=\"willing_to_relocate\" value=\"1\"\n                                       <?= !empty($profile['willing_to_relocate']) ? 'checked' : '' ?>>\n                                <label class=\"form-check-label\" for=\"willing_to_relocate\">\n                                    Willing to Relocate\n                                </label>\n                            </div>\n                        </div>\n                    </div>\n\n                    <div class=\"row\">\n                        <div class=\"col-md-4 mb-3\">\n                            <label class=\"form-label\">LinkedIn URL</label>\n                            <input type=\"url\" name=\"linkedin_url\" class=\"form-control\" \n                                   value=\"<?= htmlspecialchars($profile['linkedin_url'] ?? '') ?>\"\n                                   placeholder=\"https://linkedin.com/in/yourprofile\">\n                        </div>\n                        <div class=\"col-md-4 mb-3\">\n                            <label class=\"form-label\">GitHub URL</label>\n                            <input type=\"url\" name=\"github_url\" class=\"form-control\" \n                                   value=\"<?= htmlspecialchars($profile['github_url'] ?? '') ?>\"\n                                   placeholder=\"https://github.com/yourusername\">\n                        </div>\n                        <div class=\"col-md-4 mb-3\">\n                            <label class=\"form-label\">Portfolio URL</label>\n                            <input type=\"url\" name=\"portfolio_url\" class=\"form-control\" \n                                   value=\"<?= htmlspecialchars($profile['portfolio_url'] ?? '') ?>\"\n                                   placeholder=\"https://yourportfolio.com\">\n                        </div>\n                    </div>\n\n                    <button type=\"submit\" class=\"btn btn-primary\">\n                        <i class=\"fas fa-save\"></i> Save Basic Information\n                    </button>\n                </form>\n            </div>\n\n            <!-- Profile Picture & Resume Upload -->\n            <div class=\"section-card\">\n                <div class=\"section-header\">\n                    <h4><i class=\"fas fa-file-upload\"></i> Files Upload</h4>\n                </div>\n                \n                <div class=\"row\">\n                    <div class=\"col-md-6\">\n                        <form action=\"/jobseeker/profile/upload-picture\" method=\"POST\" enctype=\"multipart/form-data\">\n                            <?= csrfField() ?>\n                            <label class=\"form-label\">Profile Picture (JPG, PNG - Max 2MB)</label>\n                            <?php if (!empty($profile['profile_picture'])): ?>\n                                <div class=\"mb-2\">\n                                    <img src=\"/uploads/profiles/<?= htmlspecialchars($profile['profile_picture']) ?>\" \n                                         alt=\"Profile\" class=\"img-thumbnail\" style=\"max-width: 150px;\">\n                                </div>\n                            <?php endif; ?>\n                            <input type=\"file\" name=\"profile_picture\" class=\"form-control mb-2\" accept=\"image/*\" required>\n                            <button type=\"submit\" class=\"btn btn-sm btn-primary\">\n                                <i class=\"fas fa-upload\"></i> Upload Picture\n                            </button>\n                        </form>\n                    </div>\n                    <div class=\"col-md-6\">\n                        <form action=\"/jobseeker/profile/upload-resume\" method=\"POST\" enctype=\"multipart/form-data\">\n                            <?= csrfField() ?>\n                            <label class=\"form-label\">Resume/CV (PDF, DOC, DOCX - Max 5MB)</label>\n                            <?php if (!empty($profile['resume_file'])): ?>\n                                <div class=\"mb-2\">\n                                    <a href=\"/uploads/resumes/<?= htmlspecialchars($profile['resume_file']) ?>\" \n                                       target=\"_blank\" class=\"btn btn-sm btn-outline-success\">\n                                        <i class=\"fas fa-file-pdf\"></i> View Current Resume\n                                    </a>\n                                </div>\n                            <?php endif; ?>\n                            <input type=\"file\" name=\"resume\" class=\"form-control mb-2\" \n                                   accept=\".pdf,.doc,.docx,.txt\" required>\n                            <button type=\"submit\" class=\"btn btn-sm btn-primary\">\n                                <i class=\"fas fa-upload\"></i> Upload Resume\n                            </button>\n                        </form>\n                    </div>\n                </div>\n            </div>\n\n            <!-- Work Experience -->\n            <div class=\"section-card\">\n                <div class=\"section-header\">\n                    <h4><i class=\"fas fa-briefcase\"></i> Work Experience</h4>\n                    <button type=\"button\" class=\"btn btn-sm btn-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#addWorkExpModal\">\n                        <i class=\"fas fa-plus\"></i> Add Experience\n                    </button>\n                </div>\n\n                <?php if (empty($workExperiences)): ?>\n                    <p class=\"text-muted\">No work experience added yet. Click \"Add Experience\" to get started.</p>\n                <?php else: ?>\n                    <?php foreach ($workExperiences as $exp): ?>\n                        <div class=\"item-card\">\n                            <div class=\"d-flex justify-content-between\">\n                                <div>\n                                    <h5><?= htmlspecialchars($exp['job_title']) ?></h5>\n                                    <p class=\"mb-1\"><strong><?= htmlspecialchars($exp['company_name']) ?></strong></p>\n                                    <p class=\"mb-1 text-muted\">\n                                        <i class=\"fas fa-calendar\"></i>\n                                        <?= formatDate($exp['start_date']) ?> - \n                                        <?= $exp['is_current'] ? 'Present' : formatDate($exp['end_date']) ?>\n                                        <?php if ($exp['is_current']): ?>\n                                            <span class=\"badge bg-success ms-2\">Current</span>\n                                        <?php endif; ?>\n                                    </p>\n                                    <?php if ($exp['location']): ?>\n                                        <p class=\"mb-1 text-muted\"><i class=\"fas fa-map-marker-alt\"></i> <?= htmlspecialchars($exp['location']) ?></p>\n                                    <?php endif; ?>\n                                    <?php if ($exp['description']): ?>\n                                        <p class=\"mt-2\"><?= nl2br(htmlspecialchars($exp['description'])) ?></p>\n                                    <?php endif; ?>\n                                </div>\n                                <div>\n                                    <form action=\"/jobseeker/profile/delete-work-experience\" method=\"POST\" style=\"display:inline;\"\n                                          onsubmit=\"return confirm('Delete this work experience?');\">\n                                        <?= csrfField() ?>\n                                        <input type=\"hidden\" name=\"id\" value=\"<?= $exp['id'] ?>\">\n                                        <button type=\"submit\" class=\"btn btn-sm btn-outline-danger\">\n                                            <i class=\"fas fa-trash\"></i>\n                                        </button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    <?php endforeach; ?>\n                <?php endif; ?>\n            </div>\n\n            <!-- Education -->\n            <div class=\"section-card\">\n                <div class=\"section-header\">\n                    <h4><i class=\"fas fa-graduation-cap\"></i> Education</h4>\n                    <button type=\"button\" class=\"btn btn-sm btn-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#addEducationModal\">\n                        <i class=\"fas fa-plus\"></i> Add Education\n                    </button>\n                </div>\n\n                <?php if (empty($education)): ?>\n                    <p class=\"text-muted\">No education added yet. Click \"Add Education\" to get started.</p>\n                <?php else: ?>\n                    <?php foreach ($education as $edu): ?>\n                        <div class=\"item-card\">\n                            <div class=\"d-flex justify-content-between\">\n                                <div>\n                                    <h5><?= htmlspecialchars($edu['degree']) ?></h5>\n                                    <?php if ($edu['field_of_study']): ?>\n                                        <p class=\"mb-1\">Field: <?= htmlspecialchars($edu['field_of_study']) ?></p>\n                                    <?php endif; ?>\n                                    <p class=\"mb-1\"><strong><?= htmlspecialchars($edu['institution']) ?></strong></p>\n                                    <?php if ($edu['start_date']): ?>\n                                        <p class=\"mb-1 text-muted\">\n                                            <i class=\"fas fa-calendar\"></i>\n                                            <?= formatDate($edu['start_date']) ?> - <?= formatDate($edu['end_date']) ?>\n                                        </p>\n                                    <?php endif; ?>\n                                    <?php if ($edu['grade']): ?>\n                                        <p class=\"mb-1\">Grade: <strong><?= htmlspecialchars($edu['grade']) ?></strong></p>\n                                    <?php endif; ?>\n                                </div>\n                                <div>\n                                    <form action=\"/jobseeker/profile/delete-education\" method=\"POST\" style=\"display:inline;\"\n                                          onsubmit=\"return confirm('Delete this education?');\">\n                                        <?= csrfField() ?>\n                                        <input type=\"hidden\" name=\"id\" value=\"<?= $edu['id'] ?>\">\n                                        <button type=\"submit\" class=\"btn btn-sm btn-outline-danger\">\n                                            <i class=\"fas fa-trash\"></i>\n                                        </button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    <?php endforeach; ?>\n                <?php endif; ?>\n            </div>\n\n            <!-- Skills -->\n            <div class=\"section-card\">\n                <div class=\"section-header\">\n                    <h4><i class=\"fas fa-code\"></i> Skills</h4>\n                    <button type=\"button\" class=\"btn btn-sm btn-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#addSkillModal\">\n                        <i class=\"fas fa-plus\"></i> Add Skill\n                    </button>\n                </div>\n\n                <?php if (empty($skills)): ?>\n                    <p class=\"text-muted\">No skills added yet. Click \"Add Skill\" to get started.</p>\n                <?php else: ?>\n                    <div class=\"row\">\n                        <?php foreach ($skills as $skill): ?>\n                            <div class=\"col-md-4 mb-3\">\n                                <div class=\"item-card\">\n                                    <div class=\"d-flex justify-content-between align-items-start\">\n                                        <div>\n                                            <h6 class=\"mb-1\"><?= htmlspecialchars($skill['skill_name']) ?></h6>\n                                            <span class=\"badge badge-proficiency bg-<?= \n                                                $skill['proficiency'] === 'expert' ? 'danger' : \n                                                ($skill['proficiency'] === 'advanced' ? 'warning' : \n                                                ($skill['proficiency'] === 'intermediate' ? 'info' : 'secondary'))\n                                            ?>\">\n                                                <?= ucfirst($skill['proficiency']) ?>\n                                            </span>\n                                            <?php if ($skill['years_of_experience'] > 0): ?>\n                                                <small class=\"text-muted d-block mt-1\">\n                                                    <?= $skill['years_of_experience'] ?> years\n                                                </small>\n                                            <?php endif; ?>\n                                        </div>\n                                        <form action=\"/jobseeker/profile/delete-skill\" method=\"POST\" style=\"display:inline;\"\n                                              onsubmit=\"return confirm('Delete this skill?');\">\n                                            <?= csrfField() ?>\n                                            <input type=\"hidden\" name=\"id\" value=\"<?= $skill['id'] ?>\">\n                                            <button type=\"submit\" class=\"btn btn-sm btn-link text-danger p-0\">\n                                                <i class=\"fas fa-times\"></i>\n                                            </button>\n                                        </form>\n                                    </div>\n                                </div>\n                            </div>\n                        <?php endforeach; ?>\n                    </div>\n                <?php endif; ?>\n            </div>\n\n            <!-- Certifications -->\n            <div class=\"section-card\">\n                <div class=\"section-header\">\n                    <h4><i class=\"fas fa-certificate\"></i> Certifications</h4>\n                    <button type=\"button\" class=\"btn btn-sm btn-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#addCertModal\">\n                        <i class=\"fas fa-plus\"></i> Add Certification\n                    </button>\n                </div>\n\n                <?php if (empty($certifications)): ?>\n                    <p class=\"text-muted\">No certifications added yet. Click \"Add Certification\" to get started.</p>\n                <?php else: ?>\n                    <?php foreach ($certifications as $cert): ?>\n                        <div class=\"item-card\">\n                            <div class=\"d-flex justify-content-between\">\n                                <div>\n                                    <h5><?= htmlspecialchars($cert['certification_name']) ?></h5>\n                                    <p class=\"mb-1\"><strong><?= htmlspecialchars($cert['issuing_organization']) ?></strong></p>\n                                    <?php if ($cert['issue_date']): ?>\n                                        <p class=\"mb-1 text-muted\">\n                                            <i class=\"fas fa-calendar\"></i> Issued: <?= formatDate($cert['issue_date']) ?>\n                                            <?php if ($cert['expiry_date']): ?>\n                                                | Expires: <?= formatDate($cert['expiry_date']) ?>\n                                            <?php endif; ?>\n                                        </p>\n                                    <?php endif; ?>\n                                    <?php if ($cert['credential_url']): ?>\n                                        <p class=\"mb-1\">\n                                            <a href=\"<?= htmlspecialchars($cert['credential_url']) ?>\" target=\"_blank\" class=\"btn btn-sm btn-outline-primary\">\n                                                <i class=\"fas fa-external-link-alt\"></i> View Credential\n                                            </a>\n                                        </p>\n                                    <?php endif; ?>\n                                </div>\n                                <div>\n                                    <form action=\"/jobseeker/profile/delete-certification\" method=\"POST\" style=\"display:inline;\"\n                                          onsubmit=\"return confirm('Delete this certification?');\">\n                                        <?= csrfField() ?>\n                                        <input type=\"hidden\" name=\"id\" value=\"<?= $cert['id'] ?>\">\n                                        <button type=\"submit\" class=\"btn btn-sm btn-outline-danger\">\n                                            <i class=\"fas fa-trash\"></i>\n                                        </button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    <?php endforeach; ?>\n                <?php endif; ?>\n            </div>\n\n            <!-- Languages -->\n            <div class=\"section-card\">\n                <div class=\"section-header\">\n                    <h4><i class=\"fas fa-language\"></i> Languages</h4>\n                    <button type=\"button\" class=\"btn btn-sm btn-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#addLanguageModal\">\n                        <i class=\"fas fa-plus\"></i> Add Language\n                    </button>\n                </div>\n\n                <?php if (empty($languages)): ?>\n                    <p class=\"text-muted\">No languages added yet. Click \"Add Language\" to get started.</p>\n                <?php else: ?>\n                    <div class=\"row\">\n                        <?php foreach ($languages as $lang): ?>\n                            <div class=\"col-md-3 mb-3\">\n                                <div class=\"item-card\">\n                                    <div class=\"d-flex justify-content-between align-items-start\">\n                                        <div>\n                                            <h6 class=\"mb-1\"><?= htmlspecialchars($lang['language_name']) ?></h6>\n                                            <span class=\"badge bg-secondary\"><?= ucfirst($lang['proficiency']) ?></span>\n                                        </div>\n                                        <form action=\"/jobseeker/profile/delete-language\" method=\"POST\" style=\"display:inline;\"\n                                              onsubmit=\"return confirm('Delete this language?');\">\n                                            <?= csrfField() ?>\n                                            <input type=\"hidden\" name=\"id\" value=\"<?= $lang['id'] ?>\">\n                                            <button type=\"submit\" class=\"btn btn-sm btn-link text-danger p-0\">\n                                                <i class=\"fas fa-times\"></i>\n                                            </button>\n                                        </form>\n                                    </div>\n                                </div>\n                            </div>\n                        <?php endforeach; ?>\n                    </div>\n                <?php endif; ?>\n            </div>\n\n            <!-- Projects -->\n            <div class=\"section-card\">\n                <div class=\"section-header\">\n                    <h4><i class=\"fas fa-project-diagram\"></i> Projects</h4>\n                    <button type=\"button\" class=\"btn btn-sm btn-primary\" data-bs-toggle=\"modal\" data-bs-target=\"#addProjectModal\">\n                        <i class=\"fas fa-plus\"></i> Add Project\n                    </button>\n                </div>\n\n                <?php if (empty($projects)): ?>\n                    <p class=\"text-muted\">No projects added yet. Click \"Add Project\" to get started.</p>\n                <?php else: ?>\n                    <?php foreach ($projects as $project): ?>\n                        <div class=\"item-card\">\n                            <div class=\"d-flex justify-content-between\">\n                                <div>\n                                    <h5><?= htmlspecialchars($project['project_name']) ?></h5>\n                                    <?php if ($project['project_url']): ?>\n                                        <p class=\"mb-1\">\n                                            <a href=\"<?= htmlspecialchars($project['project_url']) ?>\" target=\"_blank\">\n                                                <i class=\"fas fa-link\"></i> View Project\n                                            </a>\n                                        </p>\n                                    <?php endif; ?>\n                                    <?php if ($project['description']): ?>\n                                        <p class=\"mt-2\"><?= nl2br(htmlspecialchars($project['description'])) ?></p>\n                                    <?php endif; ?>\n                                    <?php if ($project['technologies_used']): ?>\n                                        <p class=\"mb-1\"><strong>Technologies:</strong> <?= htmlspecialchars($project['technologies_used']) ?></p>\n                                    <?php endif; ?>\n                                    <?php if ($project['start_date']): ?>\n                                        <p class=\"mb-1 text-muted\">\n                                            <i class=\"fas fa-calendar\"></i>\n                                            <?= formatDate($project['start_date']) ?> - \n                                            <?= $project['is_ongoing'] ? 'Ongoing' : formatDate($project['end_date']) ?>\n                                        </p>\n                                    <?php endif; ?>\n                                </div>\n                                <div>\n                                    <form action=\"/jobseeker/profile/delete-project\" method=\"POST\" style=\"display:inline;\"\n                                          onsubmit=\"return confirm('Delete this project?');\">\n                                        <?= csrfField() ?>\n                                        <input type=\"hidden\" name=\"id\" value=\"<?= $project['id'] ?>\">\n                                        <button type=\"submit\" class=\"btn btn-sm btn-outline-danger\">\n                                            <i class=\"fas fa-trash\"></i>\n                                        </button>\n                                    </form>\n                                </div>\n                            </div>\n                        </div>\n                    <?php endforeach; ?>\n                <?php endif; ?>\n            </div>\n        </div>\n    </div>\n</div>\n\n<!-- Modals -->\n<?php require __DIR__ . '/profile_modals.php'; ?>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":32200,"size_tokens":null},"app/views/employer/post-job.php":{"content":"<?php\n$meta = generateMetaTags('Post a Job', 'Post a new job opening');\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container\">\n    <div class=\"row justify-content-center\">\n        <div class=\"col-md-8\">\n            <div class=\"card shadow\">\n                <div class=\"card-body p-4\">\n                    <h2 class=\"mb-4\">Post a New Job</h2>\n                    \n                    <?php if ($error = getFlash('error')): ?>\n                        <div class=\"alert alert-danger\"><?= $error ?></div>\n                    <?php endif; ?>\n                    \n                    <form action=\"/employer/post-job\" method=\"POST\">\n                        <?= csrfField() ?>\n                        \n                        <div class=\"mb-3\">\n                            <label for=\"title\" class=\"form-label\">Job Title *</label>\n                            <input type=\"text\" class=\"form-control\" id=\"title\" name=\"title\" required>\n                        </div>\n                        \n                        <div class=\"mb-3\">\n                            <label for=\"category_id\" class=\"form-label\">Category *</label>\n                            <select class=\"form-select\" id=\"category_id\" name=\"category_id\" required>\n                                <option value=\"\">Select Category</option>\n                                <?php foreach ($categories as $category): ?>\n                                    <option value=\"<?= $category['id'] ?>\"><?= htmlspecialchars($category['name']) ?></option>\n                                <?php endforeach; ?>\n                            </select>\n                        </div>\n                        \n                        <div class=\"row\">\n                            <div class=\"col-md-6 mb-3\">\n                                <label for=\"type\" class=\"form-label\">Job Type *</label>\n                                <select class=\"form-select\" id=\"type\" name=\"type\" required>\n                                    <option value=\"Full-time\">Full-time</option>\n                                    <option value=\"Part-time\">Part-time</option>\n                                    <option value=\"Contract\">Contract</option>\n                                    <option value=\"Internship\">Internship</option>\n                                </select>\n                            </div>\n                            \n                            <div class=\"col-md-6 mb-3\">\n                                <label for=\"location\" class=\"form-label\">Location *</label>\n                                <input type=\"text\" class=\"form-control\" id=\"location\" name=\"location\" placeholder=\"e.g., Delhi, Mumbai\" required>\n                            </div>\n                        </div>\n                        \n                        <div class=\"mb-3\">\n                            <label for=\"salary\" class=\"form-label\">Salary Range (Optional)</label>\n                            <input type=\"text\" class=\"form-control\" id=\"salary\" name=\"salary\" placeholder=\"e.g., 30000-50000\">\n                            <small class=\"text-muted\">Enter salary range in format: min-max</small>\n                        </div>\n                        \n                        <div class=\"mb-3\">\n                            <label for=\"description\" class=\"form-label\">Job Description *</label>\n                            <textarea class=\"form-control\" id=\"description\" name=\"description\" rows=\"8\" required placeholder=\"Enter detailed job description, requirements, and responsibilities\"></textarea>\n                        </div>\n                        \n                        <div class=\"alert alert-info\">\n                            <i class=\"fas fa-info-circle\"></i> Your job posting will be reviewed by our admin team before being published.\n                        </div>\n                        \n                        <button type=\"submit\" class=\"btn btn-primary btn-lg w-100\">\n                            <i class=\"fas fa-paper-plane\"></i> Submit Job Post\n                        </button>\n                    </form>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":4183,"size_tokens":null},"public/assets/js/app.js":{"content":"// ConnectWith9 Job Portal JavaScript\n\n// Add spinner to button (for database operations)\nconst addButtonLoader = (button) => {\n    if (!button || button.querySelector('.btn-spinner')) return;\n    const spinner = document.createElement('span');\n    spinner.className = 'btn-spinner';\n    button.prepend(spinner);\n    button.disabled = true;\n};\n\n// Initialize button loaders function\nconst initButtonLoaders = () => {\n    // Add loader to form submit buttons (database calls only)\n    document.querySelectorAll('form').forEach(form => {\n        form.addEventListener('submit', function(e) {\n            const button = this.querySelector('button[type=\"submit\"]');\n            \n            // Skip loader for delete forms (btn-danger)\n            if (button && !button.classList.contains('btn-danger')) {\n                addButtonLoader(button);\n            }\n        });\n    });\n};\n\n// Run when DOM is ready\nif (document.readyState === 'loading') {\n    document.addEventListener('DOMContentLoaded', function() {\n        initButtonLoaders();\n        setupAutoHideAlerts();\n        setupDeleteConfirmation();\n        setupJobSearch();\n        setupFormValidation();\n        setupFileValidation();\n        setupSmoothScroll();\n    });\n} else {\n    // DOM is already loaded\n    initButtonLoaders();\n    setupAutoHideAlerts();\n    setupDeleteConfirmation();\n    setupJobSearch();\n    setupFormValidation();\n    setupFileValidation();\n    setupSmoothScroll();\n}\n\n// Auto-hide alerts after 5 seconds\nconst setupAutoHideAlerts = () => {\n    const alerts = document.querySelectorAll('.alert');\n    alerts.forEach(alert => {\n        setTimeout(() => {\n            alert.style.transition = 'opacity 0.5s';\n            alert.style.opacity = '0';\n            setTimeout(() => alert.remove(), 500);\n        }, 5000);\n    });\n};\n\n// Confirm delete actions\nconst setupDeleteConfirmation = () => {\n    const deleteForms = document.querySelectorAll('form[onsubmit*=\"confirm\"]');\n    deleteForms.forEach(form => {\n        form.addEventListener('submit', function(e) {\n            if (!confirm('Are you sure you want to delete this item?')) {\n                e.preventDefault();\n            }\n        });\n    });\n};\n\n// Job search autocomplete (if search input exists)\nconst setupJobSearch = () => {\n    const searchInput = document.querySelector('input[name=\"search\"]');\n    if (searchInput && window.location.pathname.includes('jobs')) {\n        let searchTimeout;\n        \n        searchInput.addEventListener('input', function(e) {\n            clearTimeout(searchTimeout);\n            const query = e.target.value.trim();\n            \n            if (query.length < 2) return;\n            \n            searchTimeout = setTimeout(() => {\n                fetch(`/api/jobs/search?q=${encodeURIComponent(query)}`)\n                    .then(response => response.json())\n                    .then(data => {\n                        console.log('Search results:', data);\n                    })\n                    .catch(error => console.error('Search error:', error));\n            }, 300);\n        });\n    }\n};\n\n// Form validation\nconst setupFormValidation = () => {\n    const forms = document.querySelectorAll('form[action]');\n    forms.forEach(form => {\n        form.addEventListener('submit', function(e) {\n            const requiredFields = form.querySelectorAll('[required]');\n            let isValid = true;\n            \n            requiredFields.forEach(field => {\n                if (!field.value.trim()) {\n                    isValid = false;\n                    field.classList.add('is-invalid');\n                } else {\n                    field.classList.remove('is-invalid');\n                }\n            });\n            \n            // Email validation\n            const emailFields = form.querySelectorAll('input[type=\"email\"]');\n            emailFields.forEach(field => {\n                const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n                if (field.value && !emailRegex.test(field.value)) {\n                    isValid = false;\n                    field.classList.add('is-invalid');\n                }\n            });\n            \n            // Password confirmation\n            const password = form.querySelector('input[name=\"password\"]');\n            const confirmPassword = form.querySelector('input[name=\"confirm_password\"]');\n            \n            if (password && confirmPassword && password.value !== confirmPassword.value) {\n                isValid = false;\n                confirmPassword.classList.add('is-invalid');\n                alert('Passwords do not match');\n                e.preventDefault();\n                return false;\n            }\n        });\n    });\n};\n\n// File upload validation\nconst setupFileValidation = () => {\n    const fileInputs = document.querySelectorAll('input[type=\"file\"]');\n    fileInputs.forEach(input => {\n        input.addEventListener('change', function(e) {\n            const file = e.target.files[0];\n            if (!file) return;\n            \n            const maxSize = 5 * 1024 * 1024; // 5MB\n            const allowedTypes = ['application/pdf', 'application/msword', 'application/vnd.openxmlformats-officedocument.wordprocessingml.document', 'text/plain'];\n            \n            if (file.size > maxSize) {\n                alert('File size must not exceed 5MB');\n                e.target.value = '';\n                return;\n            }\n            \n            if (!allowedTypes.includes(file.type)) {\n                alert('Only PDF, DOC, DOCX, and TXT files are allowed');\n                e.target.value = '';\n                return;\n            }\n        });\n    });\n};\n\n// Smooth scroll for anchor links\nconst setupSmoothScroll = () => {\n    document.querySelectorAll('a[href^=\"#\"]').forEach(anchor => {\n        anchor.addEventListener('click', function (e) {\n            e.preventDefault();\n            const target = document.querySelector(this.getAttribute('href'));\n            if (target) {\n                target.scrollIntoView({\n                    behavior: 'smooth',\n                    block: 'start'\n                });\n            }\n        });\n    });\n};\n\n// Log to verify script is loaded\nconsole.log('App.js loaded and initialized');\n","path":null,"size_bytes":6219,"size_tokens":null},"app/models/Category.php":{"content":"<?php\n/**\n * Category Model\n */\n\nrequire_once __DIR__ . '/../../config/database.php';\n\nclass Category {\n    private $db;\n    \n    public function __construct() {\n        $this->db = getDB();\n    }\n    \n    // Get all categories\n    public function getAll() {\n        $sql = \"SELECT c.*, COUNT(j.id) as job_count \n                FROM categories c\n                LEFT JOIN jobs j ON c.id = j.category_id AND j.status = 'Approved'\n                GROUP BY c.id\n                ORDER BY c.name ASC\";\n        \n        $stmt = $this->db->prepare($sql);\n        $stmt->execute();\n        return $stmt->fetchAll();\n    }\n    \n    // Find category by ID\n    public function findById($id) {\n        $sql = \"SELECT * FROM categories WHERE id = :id LIMIT 1\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':id' => $id]);\n        return $stmt->fetch();\n    }\n    \n    // Find category by slug\n    public function findBySlug($slug) {\n        $sql = \"SELECT * FROM categories WHERE slug = :slug LIMIT 1\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':slug' => $slug]);\n        return $stmt->fetch();\n    }\n    \n    // Create category\n    public function create($name, $slug) {\n        $sql = \"INSERT INTO categories (name, slug) VALUES (:name, :slug)\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':name' => $name, ':slug' => $slug]);\n        return $this->db->lastInsertId();\n    }\n    \n    // Update category\n    public function update($id, $name, $slug) {\n        $sql = \"UPDATE categories SET name = :name, slug = :slug WHERE id = :id\";\n        $stmt = $this->db->prepare($sql);\n        return $stmt->execute([':id' => $id, ':name' => $name, ':slug' => $slug]);\n    }\n    \n    // Delete category\n    public function delete($id) {\n        $sql = \"DELETE FROM categories WHERE id = :id\";\n        $stmt = $this->db->prepare($sql);\n        return $stmt->execute([':id' => $id]);\n    }\n}\n","path":null,"size_bytes":1938,"size_tokens":null},"app/views/jobseeker/applications.php":{"content":"<?php\n$meta = generateMetaTags('My Applications', 'View all your job applications');\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container\">\n    <h1 class=\"mb-4\">My Applications</h1>\n    \n    <?php if (empty($applications)): ?>\n        <div class=\"alert alert-info\">\n            You haven't applied to any jobs yet. <a href=\"/jobs\" class=\"alert-link\">Browse Jobs</a>\n        </div>\n    <?php else: ?>\n        <div class=\"row\">\n            <?php foreach ($applications as $app): ?>\n            <div class=\"col-md-12 mb-3\">\n                <div class=\"card\">\n                    <div class=\"card-body\">\n                        <h5 class=\"card-title\"><?= htmlspecialchars($app['job_title']) ?></h5>\n                        <p class=\"text-muted mb-2\">\n                            <i class=\"fas fa-building\"></i> <?= htmlspecialchars($app['employer_name']) ?> |\n                            <i class=\"fas fa-map-marker-alt\"></i> <?= htmlspecialchars($app['location']) ?>\n                        </p>\n                        <p class=\"mb-2\">\n                            <span class=\"badge bg-info\"><?= htmlspecialchars($app['type']) ?></span>\n                            <span class=\"badge bg-secondary\"><?= htmlspecialchars($app['category_name']) ?></span>\n                        </p>\n                        <p class=\"text-muted mb-0\">\n                            <small>Applied on: <?= formatDate($app['applied_at']) ?></small>\n                        </p>\n                    </div>\n                </div>\n            </div>\n            <?php endforeach; ?>\n            \n            <?php if (isset($pagination) && $pagination['total_pages'] > 1): ?>\n            <div class=\"col-12\">\n                <nav>\n                    <ul class=\"pagination justify-content-center\">\n                        <?php for ($i = 1; $i <= $pagination['total_pages']; $i++): ?>\n                            <li class=\"page-item <?= $i === $pagination['current_page'] ? 'active' : '' ?>\">\n                                <a class=\"page-link\" href=\"?page=<?= $i ?>\"><?= $i ?></a>\n                            </li>\n                        <?php endfor; ?>\n                    </ul>\n                </nav>\n            </div>\n            <?php endif; ?>\n        </div>\n    <?php endif; ?>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":2338,"size_tokens":null},"app/views/admin/users.php":{"content":"<?php\n$meta = generateMetaTags('Manage Users - Admin', 'Manage platform users');\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container\">\n    <h1 class=\"mb-4\">Manage Users</h1>\n    \n    <?php if ($success = getFlash('success')): ?>\n        <div class=\"alert alert-success\"><?= $success ?></div>\n    <?php endif; ?>\n    \n    <div class=\"card\">\n        <div class=\"card-header\">\n            <form action=\"/admin/users\" method=\"GET\" class=\"row g-2\">\n                <div class=\"col-md-3\">\n                    <select name=\"type\" class=\"form-select\">\n                        <option value=\"\">All Types</option>\n                        <option value=\"jobseeker\" <?= (isset($_GET['type']) && $_GET['type'] === 'jobseeker') ? 'selected' : '' ?>>Job Seekers</option>\n                        <option value=\"employer\" <?= (isset($_GET['type']) && $_GET['type'] === 'employer') ? 'selected' : '' ?>>Employers</option>\n                        <option value=\"admin\" <?= (isset($_GET['type']) && $_GET['type'] === 'admin') ? 'selected' : '' ?>>Admins</option>\n                    </select>\n                </div>\n                <div class=\"col-md-4\">\n                    <input type=\"text\" name=\"search\" class=\"form-control\" placeholder=\"Search by name or email\" value=\"<?= htmlspecialchars($_GET['search'] ?? '') ?>\">\n                </div>\n                <div class=\"col-md-2\">\n                    <button type=\"submit\" class=\"btn btn-primary\">Search</button>\n                </div>\n            </form>\n        </div>\n        <div class=\"card-body\">\n            <div class=\"table-responsive\">\n                <table class=\"table table-striped\">\n                    <thead>\n                        <tr>\n                            <th>ID</th>\n                            <th>Name</th>\n                            <th>Email</th>\n                            <th>Mobile</th>\n                            <th>Type</th>\n                            <th>Verified</th>\n                            <th>Joined</th>\n                            <th>Actions</th>\n                        </tr>\n                    </thead>\n                    <tbody>\n                        <?php foreach ($users as $user): ?>\n                        <tr>\n                            <td><?= $user['id'] ?></td>\n                            <td><?= htmlspecialchars($user['name']) ?></td>\n                            <td><?= htmlspecialchars($user['email']) ?></td>\n                            <td><?= htmlspecialchars($user['mobile_no'] ?? '-') ?></td>\n                            <td>\n                                <span class=\"badge bg-<?= $user['type'] === 'admin' ? 'danger' : ($user['type'] === 'employer' ? 'primary' : 'secondary') ?>\">\n                                    <?= ucfirst($user['type']) ?>\n                                </span>\n                            </td>\n                            <td>\n                                <?php if ($user['verified']): ?>\n                                    <i class=\"fas fa-check-circle text-success\"></i>\n                                <?php else: ?>\n                                    <i class=\"fas fa-times-circle text-danger\"></i>\n                                <?php endif; ?>\n                            </td>\n                            <td><?= formatDate($user['created_at']) ?></td>\n                            <td>\n                                <a href=\"/admin/users/<?= $user['id'] ?>\" class=\"btn btn-sm btn-info\">View</a>\n                                <?php if ($user['type'] !== 'admin'): ?>\n                                    <form action=\"/admin/users/<?= $user['id'] ?>/delete\" method=\"POST\" class=\"d-inline\" onsubmit=\"return confirm('Are you sure?')\">\n                                        <?= csrfField() ?>\n                                        <button type=\"submit\" class=\"btn btn-sm btn-danger\">Delete</button>\n                                    </form>\n                                <?php endif; ?>\n                            </td>\n                        </tr>\n                        <?php endforeach; ?>\n                    </tbody>\n                </table>\n            </div>\n            \n            <?php if ($pagination['total_pages'] > 1): ?>\n            <nav>\n                <ul class=\"pagination justify-content-center\">\n                    <?php for ($i = 1; $i <= $pagination['total_pages']; $i++): ?>\n                        <li class=\"page-item <?= $i === $pagination['current_page'] ? 'active' : '' ?>\">\n                            <a class=\"page-link\" href=\"?page=<?= $i ?><?= !empty($_GET['type']) ? '&type=' . $_GET['type'] : '' ?><?= !empty($_GET['search']) ? '&search=' . urlencode($_GET['search']) : '' ?>\">\n                                <?= $i ?>\n                            </a>\n                        </li>\n                    <?php endfor; ?>\n                </ul>\n            </nav>\n            <?php endif; ?>\n        </div>\n    </div>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":4999,"size_tokens":null},"includes/csrf.php":{"content":"<?php\n/**\n * CSRF Protection\n */\n\n// Generate CSRF token\nfunction generateCSRFToken() {\n    initSession();\n    if (!isset($_SESSION['csrf_token'])) {\n        $_SESSION['csrf_token'] = bin2hex(random_bytes(32));\n    }\n    return $_SESSION['csrf_token'];\n}\n\n// Get CSRF token\nfunction getCSRFToken() {\n    initSession();\n    return $_SESSION['csrf_token'] ?? generateCSRFToken();\n}\n\n// Verify CSRF token\nfunction verifyCSRFToken($token) {\n    initSession();\n    if (!isset($_SESSION['csrf_token'])) {\n        return false;\n    }\n    return hash_equals($_SESSION['csrf_token'], $token);\n}\n\n// Render CSRF input field\nfunction csrfField() {\n    $token = getCSRFToken();\n    return '<input type=\"hidden\" name=\"csrf_token\" value=\"' . htmlspecialchars($token) . '\">';\n}\n\n// Check CSRF token from POST request\nfunction checkCSRF() {\n    if ($_SERVER['REQUEST_METHOD'] === 'POST') {\n        $token = $_POST['csrf_token'] ?? '';\n        if (!verifyCSRFToken($token)) {\n            http_response_code(403);\n            die('CSRF token validation failed');\n        }\n    }\n}\n","path":null,"size_bytes":1063,"size_tokens":null},"app/views/admin/view_job.php":{"content":"<?php\n$meta = generateMetaTags('View Job - Admin', 'Job details');\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container mt-5\">\n    <div class=\"row\">\n        <div class=\"col-md-8\">\n            <div class=\"card shadow mb-4\">\n                <div class=\"card-body\">\n                    <div class=\"d-flex justify-content-between align-items-start mb-3\">\n                        <div>\n                            <h1 class=\"h2 mb-2\"><?= htmlspecialchars($job['title']) ?></h1>\n                            <p class=\"text-muted mb-0\">\n                                <i class=\"fas fa-building\"></i> <?= htmlspecialchars($job['employer_name']) ?>\n                            </p>\n                        </div>\n                        <span class=\"badge bg-<?= $job['status'] === 'Approved' ? 'success' : ($job['status'] === 'Pending' ? 'warning' : 'danger') ?>\">\n                            <?= $job['status'] ?>\n                        </span>\n                    </div>\n                    \n                    <hr>\n                    \n                    <div class=\"row mb-4\">\n                        <div class=\"col-md-6\">\n                            <h5 class=\"text-muted small\">Location</h5>\n                            <p><i class=\"fas fa-map-marker-alt\"></i> <?= htmlspecialchars($job['location']) ?></p>\n                        </div>\n                        <div class=\"col-md-6\">\n                            <h5 class=\"text-muted small\">Job Type</h5>\n                            <p><?= htmlspecialchars($job['type']) ?></p>\n                        </div>\n                    </div>\n                    \n                    <div class=\"row mb-4\">\n                        <div class=\"col-md-6\">\n                            <h5 class=\"text-muted small\">Category</h5>\n                            <p><?= htmlspecialchars($job['category_name']) ?></p>\n                        </div>\n                        <div class=\"col-md-6\">\n                            <h5 class=\"text-muted small\">Salary</h5>\n                            <p><?= $job['salary'] ? formatSalary($job['salary']) : 'Not specified' ?></p>\n                        </div>\n                    </div>\n                    \n                    <div class=\"row mb-4\">\n                        <div class=\"col-md-6\">\n                            <h5 class=\"text-muted small\">Posted Date</h5>\n                            <p><?= formatDate($job['created_at']) ?></p>\n                        </div>\n                        <div class=\"col-md-6\">\n                            <h5 class=\"text-muted small\">Experience Required</h5>\n                            <p><?= htmlspecialchars($job['experience_required'] ?? 'Not specified') ?></p>\n                        </div>\n                    </div>\n                    \n                    <hr>\n                    \n                    <h3 class=\"h5 mb-3\">Job Description</h3>\n                    <div class=\"job-description bg-light p-3 rounded\">\n                        <?= nl2br(htmlspecialchars($job['description'])) ?>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"col-md-4\">\n            <div class=\"card shadow\">\n                <div class=\"card-header bg-primary text-white\">\n                    <h5 class=\"mb-0\">Actions</h5>\n                </div>\n                <div class=\"card-body\">\n                    <?php if ($job['status'] === 'Pending'): ?>\n                        <form action=\"/admin/jobs/<?= $job['id'] ?>/approve\" method=\"POST\" class=\"mb-2\">\n                            <?= csrfField() ?>\n                            <button type=\"submit\" class=\"btn btn-success w-100\">\n                                <i class=\"fas fa-check\"></i> Approve Job\n                            </button>\n                        </form>\n                        <form action=\"/admin/jobs/<?= $job['id'] ?>/reject\" method=\"POST\" class=\"mb-2\">\n                            <?= csrfField() ?>\n                            <button type=\"submit\" class=\"btn btn-warning w-100\">\n                                <i class=\"fas fa-times\"></i> Reject Job\n                            </button>\n                        </form>\n                    <?php endif; ?>\n                    \n                    <form action=\"/admin/jobs/<?= $job['id'] ?>/delete\" method=\"POST\" class=\"mb-2\" onsubmit=\"return confirm('Are you sure you want to delete this job?')\">\n                        <?= csrfField() ?>\n                        <button type=\"submit\" class=\"btn btn-danger w-100\">\n                            <i class=\"fas fa-trash\"></i> Delete Job\n                        </button>\n                    </form>\n                    \n                    <a href=\"/admin/jobs\" class=\"btn btn-secondary w-100\">\n                        <i class=\"fas fa-arrow-left\"></i> Back to Jobs\n                    </a>\n                </div>\n            </div>\n            \n            <div class=\"card shadow mt-3\">\n                <div class=\"card-header\">\n                    <h5 class=\"mb-0\">Job Statistics</h5>\n                </div>\n                <div class=\"card-body\">\n                    <p class=\"mb-2\">\n                        <strong>Applications:</strong> \n                        <span class=\"badge bg-info\">0</span>\n                    </p>\n                    <p class=\"mb-0\">\n                        <strong>Views:</strong>\n                        <span class=\"badge bg-secondary\">0</span>\n                    </p>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":5603,"size_tokens":null},"public/assets/css/style.css":{"content":"/* ConnectWith9 Job Portal Styles */\n\n:root {\n    --primary-color: #0d6efd;\n    --secondary-color: #6c757d;\n    --success-color: #198754;\n    --danger-color: #dc3545;\n    --warning-color: #ffc107;\n    --info-color: #0dcaf0;\n}\n\nbody {\n    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;\n    min-height: 100vh;\n    display: flex;\n    flex-direction: column;\n}\n\nmain {\n    flex: 1;\n}\n\n.hero-section {\n    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\n    min-height: 400px;\n}\n\n.hover-shadow {\n    transition: all 0.3s ease;\n}\n\n.hover-shadow:hover {\n    box-shadow: 0 0.5rem 1rem rgba(0, 0, 0, 0.15) !important;\n    transform: translateY(-5px);\n}\n\n.card {\n    border-radius: 10px;\n    overflow: hidden;\n}\n\n.navbar {\n    box-shadow: 0 2px 4px rgba(0,0,0,0.1);\n}\n\n.btn {\n    border-radius: 5px;\n    padding: 0.5rem 1.5rem;\n    transition: all 0.3s ease;\n}\n\n.btn:hover {\n    transform: translateY(-2px);\n    box-shadow: 0 4px 8px rgba(0,0,0,0.15);\n}\n\n.job-description {\n    line-height: 1.8;\n    white-space: pre-wrap;\n}\n\n.badge {\n    padding: 0.5em 0.8em;\n    font-weight: 500;\n}\n\nfooter {\n    margin-top: auto;\n}\n\nfooter a {\n    text-decoration: none;\n    transition: opacity 0.3s ease;\n}\n\n/* Button Loader Spinner */\n.btn-spinner {\n    display: inline-block;\n    width: 14px;\n    height: 14px;\n    border: 2px solid rgba(255, 255, 255, 0.3);\n    border-top-color: white;\n    border-radius: 50%;\n    animation: spin 0.8s linear infinite;\n    margin-right: 8px;\n    vertical-align: middle;\n}\n\n@keyframes spin {\n    0% { transform: rotate(0deg); }\n    100% { transform: rotate(360deg); }\n}\n\n.btn:disabled {\n    pointer-events: none;\n}\n\nfooter a:hover {\n    opacity: 0.8;\n}\n\n/* Animations */\n@keyframes fadeIn {\n    from {\n        opacity: 0;\n        transform: translateY(20px);\n    }\n    to {\n        opacity: 1;\n        transform: translateY(0);\n    }\n}\n\n.card {\n    animation: fadeIn 0.5s ease;\n}\n\n/* Responsive */\n@media (max-width: 768px) {\n    .hero-section h1 {\n        font-size: 2rem;\n    }\n    \n    .display-4 {\n        font-size: 2.5rem;\n    }\n}\n\n/* Form styles */\n.form-control:focus,\n.form-select:focus {\n    border-color: var(--primary-color);\n    box-shadow: 0 0 0 0.25rem rgba(13, 110, 253, 0.25);\n}\n\n/* Pagination */\n.pagination .page-link {\n    color: var(--primary-color);\n}\n\n.pagination .page-item.active .page-link {\n    background-color: var(--primary-color);\n    border-color: var(--primary-color);\n}\n\n/* Alert messages */\n.alert {\n    border-radius: 8px;\n    border: none;\n}\n\n/* Table styles */\n.table-responsive {\n    border-radius: 8px;\n}\n\n.table thead {\n    background-color: #f8f9fa;\n}\n\n/* Loading spinner */\n.spinner {\n    display: inline-block;\n    width: 20px;\n    height: 20px;\n    border: 3px solid rgba(255,255,255,.3);\n    border-radius: 50%;\n    border-top-color: #fff;\n    animation: spin 1s ease-in-out infinite;\n}\n\n@keyframes spin {\n    to { transform: rotate(360deg); }\n}\n\n/* Sticky top adjustment */\n.sticky-top {\n    z-index: 1020;\n}\n\n/* Navbar dropdown z-index fix */\n.navbar .dropdown-menu {\n    z-index: 9999;\n}\n\n.navbar .dropdown {\n    position: relative;\n}\n\n/* Ensure dropdowns appear above all content */\n.dropdown-menu.show {\n    z-index: 9999 !important;\n}\n\n/* Fix for notification and profile dropdowns */\n.notification-dropdown,\n#userDropdown + .dropdown-menu {\n    z-index: 9999 !important;\n}\n","path":null,"size_bytes":3370,"size_tokens":null},"scripts/setup_database.php":{"content":"<?php\n/**\n * Database Setup Script\n * Run this to create tables and insert sample data\n */\n\nrequire_once __DIR__ . '/../config/database.php';\n\ntry {\n    $db = getDB();\n    \n    echo \"Reading SQL file...\\n\";\n    $sql = file_get_contents(__DIR__ . '/../docs/sample_data.sql');\n    \n    if ($sql === false) {\n        die(\"Error: Could not read SQL file\\n\");\n    }\n    \n    echo \"Executing SQL statements...\\n\";\n    \n    // Remove comments\n    $sql = preg_replace('/--.*$/m', '', $sql);\n    \n    // Split SQL file by semicolons and execute each statement\n    $statements = explode(';', $sql);\n    \n    $successCount = 0;\n    $errorCount = 0;\n    \n    foreach ($statements as $statement) {\n        $statement = trim($statement);\n        \n        // Skip empty statements\n        if (empty($statement)) {\n            continue;\n        }\n        \n        try {\n            $db->exec($statement);\n            $successCount++;\n            \n            // Show what was executed\n            $firstLine = strtok($statement, \"\\n\");\n            echo \"✓ \" . substr($firstLine, 0, 60) . \"...\\n\";\n            \n        } catch (PDOException $e) {\n            echo \"Warning: \" . $e->getMessage() . \"\\n\";\n            $errorCount++;\n        }\n    }\n    \n    echo \"\\n✓ Database setup completed!\\n\";\n    echo \"Statements executed successfully: $successCount\\n\";\n    if ($errorCount > 0) {\n        echo \"Statements with warnings: $errorCount\\n\";\n    }\n    echo \"\\nDefault login credentials:\\n\";\n    echo \"Admin: admin@connectwith9.com / password123\\n\";\n    echo \"Employer: employer1@example.com / password123\\n\";\n    echo \"Job Seeker: jobseeker1@example.com / password123\\n\";\n    \n} catch (Exception $e) {\n    die(\"Error: \" . $e->getMessage() . \"\\n\");\n}\n","path":null,"size_bytes":1735,"size_tokens":null},"app/views/common/header.php":{"content":"<?php\nrequire_once __DIR__ . '/../../../includes/functions.php';\nrequire_once __DIR__ . '/../../../includes/seo.php';\n\ninitSession();\n$currentUser = getCurrentUser();\n?>\n<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <?php\n    if (isset($meta)) {\n        renderMetaTags($meta);\n    } else {\n        echo '<title>' . APP_NAME . '</title>';\n    }\n    ?>\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n    <link href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\" rel=\"stylesheet\">\n    <link href=\"<?= asset('css/style.css') ?>\" rel=\"stylesheet\">\n    <?php if (isset($schema)): ?>\n    <script type=\"application/ld+json\">\n    <?= $schema ?>\n    </script>\n    <?php endif; ?>\n</head>\n<body>\n    <!-- Page Loader Overlay -->\n    <div id=\"pageLoader\" class=\"page-loader-overlay\" style=\"display: none;\">\n        <div class=\"page-loader-content\">\n            <div class=\"page-loader-spinner\"></div>\n            <p class=\"page-loader-text\">Loading...</p>\n        </div>\n    </div>\n    \n    <nav class=\"navbar navbar-expand-lg navbar-dark bg-primary\">\n        <div class=\"container\">\n            <a class=\"navbar-brand\" href=\"/\">\n                <i class=\"fas fa-briefcase\"></i> ConnectWith9\n            </a>\n            <?php if ($currentUser && $currentUser['type'] !== USER_TYPE_ADMIN): ?>\n            <!-- Mobile-only icons (outside hamburger) -->\n            <div class=\"d-flex align-items-center d-lg-none order-lg-2 me-2\">\n                <!-- Chat Icon (Mobile) -->\n                <a class=\"nav-link position-relative text-white px-2\" href=\"/chat\" title=\"Messages\">\n                    <i class=\"fas fa-comments\"></i>\n                    <span id=\"chatBadgeMobile\" class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger\" style=\"display: none; font-size: 0.6rem;\">\n                        0\n                    </span>\n                </a>\n                \n                <!-- Notification Bell (Mobile) -->\n                <div class=\"dropdown\">\n                    <a class=\"nav-link position-relative text-white px-2 dropdown-toggle\" href=\"#\" id=\"notificationDropdownMobile\" role=\"button\" data-bs-toggle=\"dropdown\" title=\"Notifications\">\n                        <i class=\"fas fa-bell\"></i>\n                        <span id=\"notificationBadgeMobile\" class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger\" style=\"display: none; font-size: 0.6rem;\">\n                            0\n                        </span>\n                    </a>\n                    <div class=\"dropdown-menu dropdown-menu-end notification-dropdown\" style=\"width: 280px; max-height: 350px; overflow-y: auto;\">\n                        <div class=\"dropdown-header d-flex justify-content-between align-items-center\">\n                            <span><strong>Notifications</strong></span>\n                            <button type=\"button\" class=\"btn btn-sm btn-link text-primary p-0\" onclick=\"markAllNotificationsRead()\">Mark all read</button>\n                        </div>\n                        <div class=\"dropdown-divider\"></div>\n                        <div id=\"notificationListMobile\">\n                            <div class=\"text-center py-3 text-muted\">\n                                <i class=\"fas fa-spinner fa-spin\"></i> Loading...\n                            </div>\n                        </div>\n                        <div class=\"dropdown-divider\"></div>\n                        <a class=\"dropdown-item text-primary text-center\" href=\"/notifications\">View All Notifications</a>\n                    </div>\n                </div>\n            </div>\n            <?php endif; ?>\n            \n            <button class=\"navbar-toggler\" type=\"button\" data-bs-toggle=\"collapse\" data-bs-target=\"#navbarNav\">\n                <span class=\"navbar-toggler-icon\"></span>\n            </button>\n            <div class=\"collapse navbar-collapse\" id=\"navbarNav\">\n                <ul class=\"navbar-nav ms-auto\">\n                    <li class=\"nav-item\">\n                        <a class=\"nav-link\" href=\"/\">Home</a>\n                    </li>\n                    <li class=\"nav-item\">\n                        <a class=\"nav-link\" href=\"/jobs\">Browse Jobs</a>\n                    </li>\n                    <?php if ($currentUser): ?>\n                        <?php if ($currentUser['type'] === USER_TYPE_ADMIN): ?>\n                            <li class=\"nav-item\">\n                                <a class=\"nav-link\" href=\"/admin/dashboard\">Dashboard</a>\n                            </li>\n                            <li class=\"nav-item\">\n                                <a class=\"nav-link\" href=\"/admin/candidates\">Candidates</a>\n                            </li>\n                            <li class=\"nav-item\">\n                                <a class=\"nav-link\" href=\"/admin/reports\"><i class=\"fas fa-flag\"></i> Reports</a>\n                            </li>\n                        <?php elseif ($currentUser['type'] === USER_TYPE_EMPLOYER): ?>\n                            <li class=\"nav-item\">\n                                <a class=\"nav-link\" href=\"/employer/dashboard\">Dashboard</a>\n                            </li>\n                            <li class=\"nav-item\">\n                                <a class=\"nav-link\" href=\"/employer/post-job\">Post Job</a>\n                            </li>\n                            <li class=\"nav-item\">\n                                <a class=\"nav-link\" href=\"/employer/candidates\">Find Candidates</a>\n                            </li>\n                        <?php else: ?>\n                            <li class=\"nav-item\">\n                                <a class=\"nav-link\" href=\"/jobseeker/dashboard\">Dashboard</a>\n                            </li>\n                            <li class=\"nav-item\">\n                                <a class=\"nav-link\" href=\"/jobseeker/profile\">My Profile</a>\n                            </li>\n                        <?php endif; ?>\n                        \n                        <?php if ($currentUser['type'] !== USER_TYPE_ADMIN): ?>\n                        <!-- Chat Icon (Desktop only) -->\n                        <li class=\"nav-item d-none d-lg-block\">\n                            <a class=\"nav-link position-relative\" href=\"/chat\" title=\"Messages\">\n                                <i class=\"fas fa-comments\"></i>\n                                <span id=\"chatBadge\" class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger\" style=\"display: none; font-size: 0.6rem;\">\n                                    0\n                                </span>\n                            </a>\n                        </li>\n                        \n                        <!-- Notification Bell (Desktop only) -->\n                        <li class=\"nav-item dropdown d-none d-lg-block\">\n                            <a class=\"nav-link position-relative dropdown-toggle\" href=\"#\" id=\"notificationDropdown\" role=\"button\" data-bs-toggle=\"dropdown\" title=\"Notifications\">\n                                <i class=\"fas fa-bell\"></i>\n                                <span id=\"notificationBadge\" class=\"position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger\" style=\"display: none; font-size: 0.6rem;\">\n                                    0\n                                </span>\n                            </a>\n                            <div class=\"dropdown-menu dropdown-menu-end notification-dropdown\" style=\"width: 320px; max-height: 400px; overflow-y: auto;\">\n                                <div class=\"dropdown-header d-flex justify-content-between align-items-center\">\n                                    <span><strong>Notifications</strong></span>\n                                    <button type=\"button\" class=\"btn btn-sm btn-link text-primary p-0\" onclick=\"markAllNotificationsRead()\">Mark all read</button>\n                                </div>\n                                <div class=\"dropdown-divider\"></div>\n                                <div id=\"notificationList\">\n                                    <div class=\"text-center py-3 text-muted\">\n                                        <i class=\"fas fa-spinner fa-spin\"></i> Loading...\n                                    </div>\n                                </div>\n                                <div class=\"dropdown-divider\"></div>\n                                <a class=\"dropdown-item text-primary text-center\" href=\"/notifications\">View All Notifications</a>\n                            </div>\n                        </li>\n                        <?php else: ?>\n                        <!-- Create Notification Icon (for admin only) -->\n                        <li class=\"nav-item\">\n                            <a class=\"nav-link\" href=\"/admin/notifications\" title=\"Create Notification\">\n                                <i class=\"fas fa-bullhorn\"></i>\n                            </a>\n                        </li>\n                        <?php endif; ?>\n                        \n                        <li class=\"nav-item dropdown\">\n                            <a class=\"nav-link dropdown-toggle\" href=\"#\" id=\"userDropdown\" role=\"button\" data-bs-toggle=\"dropdown\">\n                                <i class=\"fas fa-user\"></i> <?= htmlspecialchars($currentUser['name']) ?>\n                            </a>\n                            <ul class=\"dropdown-menu dropdown-menu-end\">\n                                <?php if ($currentUser['type'] === USER_TYPE_JOBSEEKER): ?>\n                                    <li><a class=\"dropdown-item\" href=\"/jobseeker/profile\"><i class=\"fas fa-id-card\"></i> My Profile</a></li>\n                                    <li><a class=\"dropdown-item\" href=\"/jobseeker/applications\"><i class=\"fas fa-file-alt\"></i> My Applications</a></li>\n                                    <li><a class=\"dropdown-item\" href=\"/chat\"><i class=\"fas fa-comments\"></i> Messages</a></li>\n                                    <li><hr class=\"dropdown-divider\"></li>\n                                <?php elseif ($currentUser['type'] === USER_TYPE_EMPLOYER): ?>\n                                    <li><a class=\"dropdown-item\" href=\"/employer/jobs\"><i class=\"fas fa-briefcase\"></i> My Jobs</a></li>\n                                    <li><a class=\"dropdown-item\" href=\"/employer/candidates\"><i class=\"fas fa-users\"></i> Browse Candidates</a></li>\n                                    <li><a class=\"dropdown-item\" href=\"/chat\"><i class=\"fas fa-comments\"></i> Messages</a></li>\n                                    <li><hr class=\"dropdown-divider\"></li>\n                                <?php elseif ($currentUser['type'] === USER_TYPE_ADMIN): ?>\n                                    <li><a class=\"dropdown-item\" href=\"/admin/users\"><i class=\"fas fa-users\"></i> Manage Users</a></li>\n                                    <li><a class=\"dropdown-item\" href=\"/admin/jobs\"><i class=\"fas fa-briefcase\"></i> Manage Jobs</a></li>\n                                    <li><a class=\"dropdown-item\" href=\"/admin/candidates\"><i class=\"fas fa-user-graduate\"></i> Browse Candidates</a></li>\n                                    <li><a class=\"dropdown-item\" href=\"/admin/reports\"><i class=\"fas fa-flag\"></i> Reports</a></li>\n                                    <li><a class=\"dropdown-item\" href=\"/admin/notifications\"><i class=\"fas fa-bullhorn\"></i> System Notifications</a></li>\n                                    <li><hr class=\"dropdown-divider\"></li>\n                                <?php endif; ?>\n                                <li><a class=\"dropdown-item\" href=\"/logout\"><i class=\"fas fa-sign-out-alt\"></i> Logout</a></li>\n                            </ul>\n                        </li>\n                    <?php else: ?>\n                        <li class=\"nav-item\">\n                            <a class=\"nav-link\" href=\"/login\">Login</a>\n                        </li>\n                        <li class=\"nav-item\">\n                            <a class=\"nav-link btn btn-light text-primary ms-2\" style=\"background-color: white !important;\" href=\"/register\">Register</a>\n                        </li>\n                    <?php endif; ?>\n                </ul>\n            </div>\n        </div>\n    </nav>\n    \n    <main class=\"py-4\">\n","path":null,"size_bytes":12448,"size_tokens":null},"app/models/Job.php":{"content":"<?php\n/**\n * Job Model\n */\n\nrequire_once __DIR__ . '/../../config/database.php';\nrequire_once __DIR__ . '/../../config/constants.php';\n\nclass Job {\n    private $db;\n    \n    public function __construct() {\n        $this->db = getDB();\n    }\n    \n    // Create new job\n    public function create($data) {\n        $sql = \"INSERT INTO jobs (title, description, category_id, employer_id, location, salary, type, status) \n                VALUES (:title, :description, :category_id, :employer_id, :location, :salary, :type, :status)\";\n        \n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([\n            ':title' => $data['title'],\n            ':description' => $data['description'],\n            ':category_id' => $data['category_id'],\n            ':employer_id' => $data['employer_id'],\n            ':location' => $data['location'],\n            ':salary' => $data['salary'] ?? null,\n            ':type' => $data['type'] ?? JOB_TYPE_FULLTIME,\n            ':status' => $data['status'] ?? JOB_STATUS_PENDING\n        ]);\n        \n        return $this->db->lastInsertId();\n    }\n    \n    // Get job by ID with employer details\n    public function findById($id) {\n        $sql = \"SELECT j.*, u.name as employer_name, u.email as employer_email, \n                c.name as category_name, c.slug as category_slug\n                FROM jobs j\n                LEFT JOIN users u ON j.employer_id = u.id\n                LEFT JOIN categories c ON j.category_id = c.id\n                WHERE j.id = :id LIMIT 1\";\n        \n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':id' => $id]);\n        return $stmt->fetch();\n    }\n    \n    // Get all jobs with filters\n    public function getAll($filters = []) {\n        $sql = \"SELECT j.*, u.name as employer_name, c.name as category_name, c.slug as category_slug\n                FROM jobs j\n                LEFT JOIN users u ON j.employer_id = u.id\n                LEFT JOIN categories c ON j.category_id = c.id\n                WHERE 1=1\";\n        \n        $params = [];\n        \n        if (!empty($filters['status'])) {\n            $sql .= \" AND j.status = :status\";\n            $params[':status'] = $filters['status'];\n        }\n        \n        if (!empty($filters['employer_id'])) {\n            $sql .= \" AND j.employer_id = :employer_id\";\n            $params[':employer_id'] = $filters['employer_id'];\n        }\n        \n        if (!empty($filters['category_id'])) {\n            $sql .= \" AND j.category_id = :category_id\";\n            $params[':category_id'] = $filters['category_id'];\n        }\n        \n        if (!empty($filters['type'])) {\n            $sql .= \" AND j.type = :type\";\n            $params[':type'] = $filters['type'];\n        }\n        \n        if (!empty($filters['location'])) {\n            $sql .= \" AND j.location LIKE :location\";\n            $params[':location'] = '%' . $filters['location'] . '%';\n        }\n        \n        if (!empty($filters['search'])) {\n            $sql .= \" AND (j.title LIKE :search1 OR j.description LIKE :search2)\";\n            $params[':search1'] = '%' . $filters['search'] . '%';\n            $params[':search2'] = '%' . $filters['search'] . '%';\n        }\n        \n        $sql .= \" ORDER BY j.created_at DESC\";\n        \n        if (!empty($filters['limit'])) {\n            $sql .= \" LIMIT :limit OFFSET :offset\";\n        }\n        \n        $stmt = $this->db->prepare($sql);\n        \n        foreach ($params as $key => $value) {\n            $stmt->bindValue($key, $value);\n        }\n        \n        if (!empty($filters['limit'])) {\n            $stmt->bindValue(':limit', (int)$filters['limit'], PDO::PARAM_INT);\n            $stmt->bindValue(':offset', (int)($filters['offset'] ?? 0), PDO::PARAM_INT);\n        }\n        \n        $stmt->execute();\n        return $stmt->fetchAll();\n    }\n    \n    // Count jobs\n    public function count($filters = []) {\n        $sql = \"SELECT COUNT(*) as total FROM jobs WHERE 1=1\";\n        $params = [];\n        \n        if (!empty($filters['status'])) {\n            $sql .= \" AND status = :status\";\n            $params[':status'] = $filters['status'];\n        }\n        \n        if (!empty($filters['employer_id'])) {\n            $sql .= \" AND employer_id = :employer_id\";\n            $params[':employer_id'] = $filters['employer_id'];\n        }\n        \n        $stmt = $this->db->prepare($sql);\n        $stmt->execute($params);\n        $result = $stmt->fetch();\n        return $result['total'];\n    }\n    \n    // Update job\n    public function update($id, $data) {\n        $fields = [];\n        $params = [':id' => $id];\n        \n        $allowedFields = ['title', 'description', 'category_id', 'location', 'salary', 'type', 'status'];\n        \n        foreach ($data as $key => $value) {\n            if (in_array($key, $allowedFields)) {\n                $fields[] = \"$key = :$key\";\n                $params[\":$key\"] = $value;\n            }\n        }\n        \n        if (empty($fields)) {\n            return false;\n        }\n        \n        $sql = \"UPDATE jobs SET \" . implode(', ', $fields) . \" WHERE id = :id\";\n        $stmt = $this->db->prepare($sql);\n        return $stmt->execute($params);\n    }\n    \n    // Delete job\n    public function delete($id) {\n        $sql = \"DELETE FROM jobs WHERE id = :id\";\n        $stmt = $this->db->prepare($sql);\n        return $stmt->execute([':id' => $id]);\n    }\n    \n    // Get latest jobs\n    public function getLatest($limit = 10) {\n        return $this->getAll(['status' => JOB_STATUS_APPROVED, 'limit' => $limit]);\n    }\n    \n    // Search jobs (for autocomplete)\n    public function search($query, $limit = 10) {\n        $sql = \"SELECT DISTINCT title FROM jobs \n                WHERE status = :status AND title LIKE :query \n                LIMIT :limit\";\n        \n        $stmt = $this->db->prepare($sql);\n        $stmt->bindValue(':status', JOB_STATUS_APPROVED);\n        $stmt->bindValue(':query', '%' . $query . '%');\n        $stmt->bindValue(':limit', $limit, PDO::PARAM_INT);\n        $stmt->execute();\n        \n        return $stmt->fetchAll();\n    }\n    \n    // Get jobs by category\n    public function getByCategory($categoryId, $limit = null) {\n        return $this->getAll([\n            'category_id' => $categoryId,\n            'status' => JOB_STATUS_APPROVED,\n            'limit' => $limit\n        ]);\n    }\n}\n","path":null,"size_bytes":6325,"size_tokens":null},"app/views/jobs/show.php":{"content":"<?php\n$meta = generateMetaTags(\n    $job['title'] . ' - ' . $job['location'],\n    substr(strip_tags($job['description']), 0, 155),\n    $job['title'] . ', ' . $job['location'] . ', ' . $job['category_name']\n);\n\n$schema = generateJobSchema($job);\n\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container\">\n    <?php if ($error = getFlash('error')): ?>\n        <div class=\"alert alert-danger\"><?= $error ?></div>\n    <?php endif; ?>\n    \n    <?php if ($success = getFlash('success')): ?>\n        <div class=\"alert alert-success\"><?= $success ?></div>\n    <?php endif; ?>\n    \n    <div class=\"row\">\n        <div class=\"col-md-8\">\n            <div class=\"card shadow\">\n                <div class=\"card-body\">\n                    <h1 class=\"h2\"><?= htmlspecialchars($job['title']) ?></h1>\n                    \n                    <div class=\"mb-3\">\n                        <p class=\"text-muted mb-1\">\n                            <i class=\"fas fa-building\"></i> <?= htmlspecialchars($job['employer_name']) ?>\n                        </p>\n                        <p class=\"text-muted mb-1\">\n                            <i class=\"fas fa-map-marker-alt\"></i> <?= htmlspecialchars($job['location']) ?>\n                        </p>\n                        <p class=\"mb-2\">\n                            <span class=\"badge bg-info\"><?= htmlspecialchars($job['type']) ?></span>\n                            <span class=\"badge bg-secondary\"><?= htmlspecialchars($job['category_name']) ?></span>\n                            <?php if ($job['salary']): ?>\n                                <span class=\"badge bg-success\"><?= formatSalary($job['salary']) ?></span>\n                            <?php endif; ?>\n                        </p>\n                        <p class=\"text-muted d-flex align-items-center justify-content-between\">\n                            <small><i class=\"fas fa-clock\"></i> Posted <?= formatDate($job['created_at']) ?></small>\n                            <?php if (isLoggedIn() && (getCurrentUser()['status'] ?? 'active') === 'active' && getCurrentUser()['type'] !== USER_TYPE_ADMIN): ?>\n                                <button type=\"button\" class=\"btn btn-sm btn-outline-danger\" onclick=\"openReportModal('job', <?= $job['id'] ?>)\">\n                                    <i class=\"fas fa-flag\"></i> Report\n                                </button>\n                            <?php endif; ?>\n                        </p>\n                    </div>\n                    \n                    <hr>\n                    \n                    <h3 class=\"h5\">Job Description</h3>\n                    <div class=\"job-description\">\n                        <?= nl2br(htmlspecialchars($job['description'])) ?>\n                    </div>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"col-md-4\">\n            <div class=\"card shadow sticky-top\" style=\"top: 20px;\">\n                <div class=\"card-body\">\n                    <?php if (isLoggedIn()): ?>\n                        <?php $user = getCurrentUser(); ?>\n                        <?php if ($user['type'] === USER_TYPE_JOBSEEKER): ?>\n                            <?php if ($hasApplied): ?>\n                                <div class=\"alert alert-success\">\n                                    <i class=\"fas fa-check-circle\"></i> You have already applied for this job\n                                </div>\n                            <?php else: ?>\n                                <h5 class=\"card-title\">Apply for this Job</h5>\n                                <form action=\"/jobs/<?= $job['id'] ?>/apply\" method=\"POST\" enctype=\"multipart/form-data\">\n                                    <?= csrfField() ?>\n                                    \n                                    <div class=\"mb-3\">\n                                        <label for=\"resume\" class=\"form-label\">Upload Resume *</label>\n                                        <input type=\"file\" class=\"form-control\" id=\"resume\" name=\"resume\" accept=\".pdf,.doc,.docx,.txt\" required>\n                                        <small class=\"text-muted\">PDF, DOC, DOCX, TXT (Max 5MB)</small>\n                                    </div>\n                                    \n                                    <button type=\"submit\" class=\"btn btn-primary w-100\">\n                                        <i class=\"fas fa-paper-plane\"></i> Submit Application\n                                    </button>\n                                </form>\n                            <?php endif; ?>\n                        <?php else: ?>\n                            <div class=\"alert alert-info\">\n                                Only job seekers can apply for jobs\n                            </div>\n                        <?php endif; ?>\n                    <?php else: ?>\n                        <h5 class=\"card-title\">Apply for this Job</h5>\n                        <p>Please login to apply for this job</p>\n                        <a href=\"/login\" class=\"btn btn-primary w-100\">Login to Apply</a>\n                        <a href=\"/register\" class=\"btn btn-outline-primary w-100 mt-2\">Register</a>\n                    <?php endif; ?>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":5299,"size_tokens":null},"app/views/employer/candidates.php":{"content":"<?php\n$meta = generateMetaTags('Browse Candidates', 'Search and filter job seekers');\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container my-5\">\n    <h2><i class=\"fas fa-users\"></i> Browse Candidates</h2>\n    \n    <!-- Search/Filter Form -->\n    <div class=\"card shadow mb-4\">\n        <div class=\"card-body\">\n            <form action=\"/employer/candidates\" method=\"GET\">\n                <div class=\"row g-3\">\n                    <div class=\"col-md-3\">\n                        <label class=\"form-label\">City</label>\n                        <input type=\"text\" name=\"city\" class=\"form-control\" \n                               value=\"<?= htmlspecialchars($_GET['city'] ?? '') ?>\" placeholder=\"e.g., Mumbai\">\n                    </div>\n                    <div class=\"col-md-3\">\n                        <label class=\"form-label\">State</label>\n                        <input type=\"text\" name=\"state\" class=\"form-control\"\n                               value=\"<?= htmlspecialchars($_GET['state'] ?? '') ?>\" placeholder=\"e.g., Maharashtra\">\n                    </div>\n                    <div class=\"col-md-3\">\n                        <label class=\"form-label\">Skill</label>\n                        <input type=\"text\" name=\"skill\" class=\"form-control\"\n                               value=\"<?= htmlspecialchars($_GET['skill'] ?? '') ?>\" placeholder=\"e.g., PHP, JavaScript\">\n                    </div>\n                    <div class=\"col-md-3\">\n                        <label class=\"form-label\">Min Experience (Years)</label>\n                        <input type=\"number\" name=\"min_experience\" class=\"form-control\" min=\"0\"\n                               value=\"<?= htmlspecialchars($_GET['min_experience'] ?? '') ?>\">\n                    </div>\n                    <div class=\"col-md-3\">\n                        <label class=\"form-label\">Max Experience (Years)</label>\n                        <input type=\"number\" name=\"max_experience\" class=\"form-control\" min=\"0\"\n                               value=\"<?= htmlspecialchars($_GET['max_experience'] ?? '') ?>\">\n                    </div>\n                    <div class=\"col-md-3\">\n                        <label class=\"form-label\">Availability</label>\n                        <select name=\"availability\" class=\"form-control\">\n                            <option value=\"\">Any</option>\n                            <option value=\"immediate\" <?= ($_GET['availability'] ?? '') === 'immediate' ? 'selected' : '' ?>>Immediate</option>\n                            <option value=\"15_days\" <?= ($_GET['availability'] ?? '') === '15_days' ? 'selected' : '' ?>>15 Days</option>\n                            <option value=\"1_month\" <?= ($_GET['availability'] ?? '') === '1_month' ? 'selected' : '' ?>>1 Month</option>\n                            <option value=\"2_months\" <?= ($_GET['availability'] ?? '') === '2_months' ? 'selected' : '' ?>>2 Months</option>\n                            <option value=\"3_months\" <?= ($_GET['availability'] ?? '') === '3_months' ? 'selected' : '' ?>>3+ Months</option>\n                        </select>\n                    </div>\n                    <div class=\"col-md-3 d-flex align-items-end\">\n                        <button type=\"submit\" class=\"btn btn-primary w-100\">\n                            <i class=\"fas fa-search\"></i> Search Candidates\n                        </button>\n                    </div>\n                    <div class=\"col-md-3 d-flex align-items-end\">\n                        <a href=\"/employer/candidates\" class=\"btn btn-secondary w-100\">\n                            <i class=\"fas fa-redo\"></i> Reset Filters\n                        </a>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n\n    <!-- Candidates List -->\n    <p class=\"text-muted\">Found <?= count($candidates) ?> candidates</p>\n    \n    <?php if (empty($candidates)): ?>\n        <div class=\"alert alert-info\">\n            No candidates found. Try adjusting your search filters.\n        </div>\n    <?php else: ?>\n        <div class=\"row\">\n            <?php foreach ($candidates as $candidate): ?>\n                <div class=\"col-md-6 mb-4\">\n                    <div class=\"card shadow h-100\">\n                        <div class=\"card-body\">\n                            <div class=\"d-flex\">\n                                <?php if ($candidate['profile_picture']): ?>\n                                    <img src=\"/uploads/profiles/<?= htmlspecialchars($candidate['profile_picture']) ?>\" \n                                         alt=\"Profile\" class=\"rounded-circle me-3\" style=\"width: 80px; height: 80px; object-fit: cover;\">\n                                <?php else: ?>\n                                    <div class=\"bg-primary text-white rounded-circle me-3 d-flex align-items-center justify-content-center\" \n                                         style=\"width: 80px; height: 80px; font-size: 32px;\">\n                                        <i class=\"fas fa-user\"></i>\n                                    </div>\n                                <?php endif; ?>\n                                \n                                <div class=\"flex-grow-1\">\n                                    <?php $isSelected = isset($selectedCandidates[$candidate['id']]); ?>\n                                    <h5 class=\"mb-1\">\n                                        <?= htmlspecialchars($candidate['name']) ?>\n                                        <?php if ($isSelected): ?>\n                                            <span class=\"badge bg-success ms-2\"><i class=\"fas fa-check-circle\"></i> Selected</span>\n                                        <?php endif; ?>\n                                    </h5>\n                                    <?php if ($candidate['headline']): ?>\n                                        <p class=\"text-muted mb-2\"><?= htmlspecialchars($candidate['headline']) ?></p>\n                                    <?php endif; ?>\n                                    <?php if ($isSelected): ?>\n                                        <p class=\"mb-1 text-success small\">\n                                            <i class=\"fas fa-briefcase\"></i> Selected for: <?= htmlspecialchars($selectedCandidates[$candidate['id']]['job_title']) ?>\n                                        </p>\n                                    <?php endif; ?>\n                                    \n                                    <p class=\"mb-1\">\n                                        <?php if ($candidate['city']): ?>\n                                            <span class=\"badge bg-secondary\">\n                                                <i class=\"fas fa-map-marker-alt\"></i> <?= htmlspecialchars($candidate['city']) ?>, <?= htmlspecialchars($candidate['state']) ?>\n                                            </span>\n                                        <?php endif; ?>\n                                        <?php if ($candidate['total_experience_years']): ?>\n                                            <span class=\"badge bg-info\">\n                                                <i class=\"fas fa-briefcase\"></i> <?= $candidate['total_experience_years'] ?> years exp\n                                            </span>\n                                        <?php endif; ?>\n                                        <?php if ($candidate['availability']): ?>\n                                            <span class=\"badge bg-success\">\n                                                <i class=\"fas fa-clock\"></i> <?= ucfirst(str_replace('_', ' ', $candidate['availability'])) ?>\n                                            </span>\n                                        <?php endif; ?>\n                                    </p>\n                                    \n                                    <?php if ($candidate['skills']): ?>\n                                        <p class=\"mb-2\">\n                                            <strong>Skills:</strong> \n                                            <small><?= htmlspecialchars(substr($candidate['skills'], 0, 100)) ?><?= strlen($candidate['skills']) > 100 ? '...' : '' ?></small>\n                                        </p>\n                                    <?php endif; ?>\n                                    \n                                    <div class=\"mt-2\">\n                                        <a href=\"/employer/candidates/<?= $candidate['id'] ?>\" class=\"btn btn-sm btn-primary\">\n                                            <i class=\"fas fa-eye\"></i> View Full Profile\n                                        </a>\n                                        <?php if ($isSelected): ?>\n                                            <a href=\"/chat/<?= $selectedCandidates[$candidate['id']]['conversation_id'] ?>\" class=\"btn btn-sm btn-success\">\n                                                <i class=\"fas fa-comment\"></i> Message\n                                            </a>\n                                        <?php endif; ?>\n                                        <?php if ($candidate['resume_file']): ?>\n                                            <a href=\"/uploads/resumes/<?= htmlspecialchars($candidate['resume_file']) ?>\" \n                                               target=\"_blank\" class=\"btn btn-sm btn-outline-success\">\n                                                <i class=\"fas fa-file-pdf\"></i> Resume\n                                            </a>\n                                        <?php endif; ?>\n                                        <?php if (getCurrentUser()['type'] !== USER_TYPE_ADMIN): ?>\n                                        <button type=\"button\" class=\"btn btn-sm btn-outline-danger\" onclick=\"openReportModal('user', <?= $candidate['id'] ?>)\">\n                                            <i class=\"fas fa-flag\"></i> Report\n                                        </button>\n                                        <?php endif; ?>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            <?php endforeach; ?>\n        </div>\n    <?php endif; ?>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":10283,"size_tokens":null},"app/views/auth/reset-password.php":{"content":"<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Reset Password - <?= APP_NAME ?></title>\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css\" rel=\"stylesheet\">\n    <link href=\"https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css\" rel=\"stylesheet\">\n</head>\n<body class=\"bg-light\">\n    <?php require __DIR__ . '/../common/header.php'; ?>\n    \n    <div class=\"container mt-5\">\n        <div class=\"row justify-content-center\">\n            <div class=\"col-md-5\">\n                <div class=\"card shadow\">\n                    <div class=\"card-body p-4\">\n                        <div class=\"text-center mb-4\">\n                            <i class=\"fas fa-lock fa-3x text-primary mb-3\"></i>\n                            <h2 class=\"mb-2\">Reset Password</h2>\n                            <p class=\"text-muted\">Enter your new password below.</p>\n                        </div>\n                        \n                        <?php if (hasFlash('error')): ?>\n                            <div class=\"alert alert-danger\"><?= getFlash('error') ?></div>\n                        <?php endif; ?>\n                        \n                        <?php if (hasFlash('success')): ?>\n                            <div class=\"alert alert-success\"><?= getFlash('success') ?></div>\n                        <?php endif; ?>\n                        \n                        <form method=\"POST\" action=\"/reset-password\" id=\"resetForm\">\n                            <?= csrfField() ?>\n                            <input type=\"hidden\" name=\"token\" value=\"<?= htmlspecialchars($_GET['token'] ?? '') ?>\">\n                            \n                            <div class=\"mb-3\">\n                                <label for=\"password\" class=\"form-label\">New Password</label>\n                                <div class=\"input-group\">\n                                    <input type=\"password\" class=\"form-control\" id=\"password\" name=\"password\" \n                                           placeholder=\"Enter new password\" required minlength=\"6\">\n                                    <button class=\"btn btn-outline-secondary\" type=\"button\" id=\"togglePassword\">\n                                        <i class=\"fas fa-eye\"></i>\n                                    </button>\n                                </div>\n                                <small class=\"text-muted\">Minimum 6 characters</small>\n                            </div>\n                            \n                            <div class=\"mb-3\">\n                                <label for=\"confirm_password\" class=\"form-label\">Confirm New Password</label>\n                                <div class=\"input-group\">\n                                    <input type=\"password\" class=\"form-control\" id=\"confirm_password\" \n                                           name=\"confirm_password\" placeholder=\"Re-enter new password\" \n                                           required minlength=\"6\">\n                                    <button class=\"btn btn-outline-secondary\" type=\"button\" id=\"toggleConfirmPassword\">\n                                        <i class=\"fas fa-eye\"></i>\n                                    </button>\n                                </div>\n                            </div>\n                            \n                            <div class=\"mb-3\">\n                                <div class=\"progress\" style=\"height: 5px;\">\n                                    <div class=\"progress-bar\" id=\"passwordStrength\" role=\"progressbar\" style=\"width: 0%\"></div>\n                                </div>\n                                <small id=\"strengthText\" class=\"text-muted\"></small>\n                            </div>\n                            \n                            <button type=\"submit\" class=\"btn btn-primary w-100\">\n                                <i class=\"fas fa-check me-2\"></i>Reset Password\n                            </button>\n                        </form>\n                        \n                        <hr class=\"my-4\">\n                        \n                        <div class=\"text-center\">\n                            <p class=\"mb-0\">\n                                Remember your password? <a href=\"/login\">Login here</a>\n                            </p>\n                        </div>\n                    </div>\n                </div>\n                \n                <div class=\"card mt-3 bg-success bg-opacity-10 border-success\">\n                    <div class=\"card-body\">\n                        <h6 class=\"card-title\"><i class=\"fas fa-shield-alt me-2\"></i>Password Security Tips</h6>\n                        <ul class=\"small mb-0\">\n                            <li>Use at least 8 characters (minimum 6 required)</li>\n                            <li>Include uppercase and lowercase letters</li>\n                            <li>Add numbers and special characters</li>\n                            <li>Avoid common words or personal information</li>\n                            <li>Don't reuse passwords from other sites</li>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <script>\n        // Toggle password visibility\n        document.getElementById('togglePassword').addEventListener('click', function() {\n            const password = document.getElementById('password');\n            const icon = this.querySelector('i');\n            \n            if (password.type === 'password') {\n                password.type = 'text';\n                icon.classList.remove('fa-eye');\n                icon.classList.add('fa-eye-slash');\n            } else {\n                password.type = 'password';\n                icon.classList.remove('fa-eye-slash');\n                icon.classList.add('fa-eye');\n            }\n        });\n        \n        document.getElementById('toggleConfirmPassword').addEventListener('click', function() {\n            const password = document.getElementById('confirm_password');\n            const icon = this.querySelector('i');\n            \n            if (password.type === 'password') {\n                password.type = 'text';\n                icon.classList.remove('fa-eye');\n                icon.classList.add('fa-eye-slash');\n            } else {\n                password.type = 'password';\n                icon.classList.remove('fa-eye-slash');\n                icon.classList.add('fa-eye');\n            }\n        });\n        \n        // Password strength indicator\n        document.getElementById('password').addEventListener('input', function() {\n            const password = this.value;\n            const strengthBar = document.getElementById('passwordStrength');\n            const strengthText = document.getElementById('strengthText');\n            \n            let strength = 0;\n            if (password.length >= 6) strength += 20;\n            if (password.length >= 10) strength += 20;\n            if (/[a-z]/.test(password)) strength += 20;\n            if (/[A-Z]/.test(password)) strength += 20;\n            if (/[0-9]/.test(password)) strength += 10;\n            if (/[^a-zA-Z0-9]/.test(password)) strength += 10;\n            \n            strengthBar.style.width = strength + '%';\n            \n            if (strength < 40) {\n                strengthBar.className = 'progress-bar bg-danger';\n                strengthText.textContent = 'Weak password';\n                strengthText.className = 'text-danger small';\n            } else if (strength < 70) {\n                strengthBar.className = 'progress-bar bg-warning';\n                strengthText.textContent = 'Medium password';\n                strengthText.className = 'text-warning small';\n            } else {\n                strengthBar.className = 'progress-bar bg-success';\n                strengthText.textContent = 'Strong password';\n                strengthText.className = 'text-success small';\n            }\n        });\n        \n        // Form validation\n        document.getElementById('resetForm').addEventListener('submit', function(e) {\n            const password = document.getElementById('password').value;\n            const confirmPassword = document.getElementById('confirm_password').value;\n            \n            if (password !== confirmPassword) {\n                e.preventDefault();\n                alert('Passwords do not match!');\n                return false;\n            }\n            \n            if (password.length < 6) {\n                e.preventDefault();\n                alert('Password must be at least 6 characters long!');\n                return false;\n            }\n        });\n    </script>\n    \n    <?php require __DIR__ . '/../common/footer.php'; ?>\n</body>\n</html>\n","path":null,"size_bytes":8820,"size_tokens":null},"IMPORTANT_DATABASE_SETUP.md":{"content":"# IMPORTANT: Database Connection Setup Required\n\n## Current Status\n\nThe ConnectWith9 Job Portal application is **fully built and running**, but it **cannot connect to the remote MySQL database** yet. This is a normal infrastructure setup requirement.\n\n## Why This is Happening\n\nThe remote database server (srv1642.hstgr.io) requires **IP whitelisting** for security. The Replit server's IP address must be added to the allowed list on Hostinger before the database can be accessed.\n\n## Error You'll See\n\n```\nDatabase Connection Error: SQLSTATE[HY000] [1045] Access denied for user 'u647904474_connect9job'@'34.19.105.207'\n```\n\nThis error means the connection is reaching the database server, but the IP address (34.19.105.207) is not whitelisted yet.\n\n## How to Fix This\n\n### Option 1: Whitelist the Replit IP (Recommended)\n\n1. **Log in to your Hostinger account** at https://hpanel.hostinger.com\n\n2. **Navigate to MySQL Databases**:\n   - Go to \"Databases\" → \"MySQL Databases\"\n   - Or find \"Remote MySQL\" in the hosting panel\n\n3. **Add the IP to whitelist**:\n   - Look for \"Remote MySQL\" or \"Remote Database Access\"\n   - Click \"Add IP Address\" or \"Manage Access Hosts\"\n   - Add this IP: **34.19.105.207** (or the IP shown in your error message)\n   - You can also add **%** to allow all IPs (less secure, only for development)\n\n4. **Save and wait**:\n   - Save the changes\n   - Wait 2-5 minutes for the changes to propagate\n   - Refresh your Replit application\n\n5. **Test the connection**:\n   - Run: `php scripts/setup_database.php`\n   - If successful, you'll see: \"Database setup completed!\"\n\n### Option 2: Use Environment Variables (If credentials are different)\n\nIf your Hostinger credentials have changed or are different:\n\n1. Set environment variables in Replit:\n   - Go to Replit \"Secrets\" tab (lock icon on left sidebar)\n   - Add these secrets:\n     - `DB_HOST` = srv1642.hstgr.io\n     - `DB_NAME` = u647904474_connect9job\n     - `DB_USER` = u647904474_connect9job\n     - `DB_PASS` = Hostinger@1234#\n\n2. The application will automatically use these values instead of the defaults\n\n### Option 3: Use Local Development Database (Temporary)\n\nIf you want to test the application without the remote database:\n\n1. **Install MySQL locally**:\n   ```bash\n   # This is automatically available in Replit\n   ```\n\n2. **Create local database**:\n   ```bash\n   mysql -u root -e \"CREATE DATABASE jobportal;\"\n   ```\n\n3. **Update config/env.php**:\n   Change the database credentials to:\n   ```php\n   define('DB_HOST', 'localhost');\n   define('DB_NAME', 'jobportal');\n   define('DB_USER', 'root');\n   define('DB_PASS', '');\n   ```\n\n4. **Run setup**:\n   ```bash\n   php scripts/setup_database.php\n   ```\n\n## What Works Right Now\n\nEven without database access, the application structure is complete:\n\n✅ **Application Structure**: All files and folders created\n✅ **MVC Architecture**: Controllers, Models, Views properly organized\n✅ **Security Features**: CSRF protection, password hashing, login throttling\n✅ **Routing System**: Clean URLs with .htaccess\n✅ **SEO Implementation**: Meta tags, Schema.org markup\n✅ **Responsive UI**: Bootstrap 5 with custom styling\n✅ **File Upload**: Resume validation and handling\n✅ **Three User Roles**: Admin, Employer, Job Seeker dashboards\n\n## What Needs Database Access\n\n❌ **User Authentication**: Login/Register (needs users table)\n❌ **Job Listings**: Browse/Post jobs (needs jobs table)\n❌ **Applications**: Submit/View applications (needs applications table)\n❌ **Admin Panel**: User/Job management (needs all tables)\n\n## Verification Steps\n\nOnce the IP is whitelisted, verify everything works:\n\n1. **Run database setup**:\n   ```bash\n   php scripts/setup_database.php\n   ```\n   \n2. **Access the application**: http://localhost:5000\n\n3. **Test login with default admin account**:\n   - Email: admin@connectwith9.com\n   - Password: password123\n\n4. **Verify these pages work**:\n   - Homepage: http://localhost:5000/\n   - Browse Jobs: http://localhost:5000/jobs\n   - Login: http://localhost:5000/login\n   - Register: http://localhost:5000/register\n   - Admin Dashboard: http://localhost:5000/admin/dashboard (after login)\n\n## Default User Accounts\n\nAfter database setup, you can log in with:\n\n**Admin**:\n- Email: admin@connectwith9.com\n- Password: password123\n\n**Employer**:\n- Email: employer1@example.com\n- Password: password123\n\n**Job Seeker**:\n- Email: jobseeker1@example.com  \n- Password: password123\n\n**⚠️ IMPORTANT**: Change these passwords immediately!\n\n## Need Help?\n\nIf you continue to have database connection issues after whitelisting the IP:\n\n1. **Check Hostinger Status**: Ensure the database server is running\n2. **Verify Credentials**: Confirm username and password are correct\n3. **Test Connection**: Use a MySQL client to test the connection\n4. **Contact Hostinger Support**: They can verify IP whitelisting is working\n\n## Application is Ready!\n\nThe entire ConnectWith9 Job Portal application is **complete and ready to use** once the database connection is established. All code, security features, and functionality have been implemented according to your specifications.\n","path":null,"size_bytes":5136,"size_tokens":null},"app/views/admin/candidates.php":{"content":"<?php\n$meta = generateMetaTags('Browse Candidates', 'Search and filter job seekers');\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container my-5\">\n    <h2><i class=\"fas fa-users\"></i> Browse Candidates</h2>\n    \n    <!-- Search/Filter Form -->\n    <div class=\"card shadow mb-4\">\n        <div class=\"card-body\">\n            <form action=\"/admin/candidates\" method=\"GET\">\n                <div class=\"row g-3\">\n                    <div class=\"col-md-3\">\n                        <label class=\"form-label\">City</label>\n                        <input type=\"text\" name=\"city\" class=\"form-control\" \n                               value=\"<?= htmlspecialchars($_GET['city'] ?? '') ?>\" placeholder=\"e.g., Mumbai\">\n                    </div>\n                    <div class=\"col-md-3\">\n                        <label class=\"form-label\">State</label>\n                        <input type=\"text\" name=\"state\" class=\"form-control\"\n                               value=\"<?= htmlspecialchars($_GET['state'] ?? '') ?>\" placeholder=\"e.g., Maharashtra\">\n                    </div>\n                    <div class=\"col-md-3\">\n                        <label class=\"form-label\">Skill</label>\n                        <input type=\"text\" name=\"skill\" class=\"form-control\"\n                               value=\"<?= htmlspecialchars($_GET['skill'] ?? '') ?>\" placeholder=\"e.g., PHP, JavaScript\">\n                    </div>\n                    <div class=\"col-md-3\">\n                        <label class=\"form-label\">Min Experience (Years)</label>\n                        <input type=\"number\" name=\"min_experience\" class=\"form-control\" min=\"0\"\n                               value=\"<?= htmlspecialchars($_GET['min_experience'] ?? '') ?>\">\n                    </div>\n                    <div class=\"col-md-3\">\n                        <label class=\"form-label\">Max Experience (Years)</label>\n                        <input type=\"number\" name=\"max_experience\" class=\"form-control\" min=\"0\"\n                               value=\"<?= htmlspecialchars($_GET['max_experience'] ?? '') ?>\">\n                    </div>\n                    <div class=\"col-md-3\">\n                        <label class=\"form-label\">Availability</label>\n                        <select name=\"availability\" class=\"form-control\">\n                            <option value=\"\">Any</option>\n                            <option value=\"immediate\" <?= ($_GET['availability'] ?? '') === 'immediate' ? 'selected' : '' ?>>Immediate</option>\n                            <option value=\"15_days\" <?= ($_GET['availability'] ?? '') === '15_days' ? 'selected' : '' ?>>15 Days</option>\n                            <option value=\"1_month\" <?= ($_GET['availability'] ?? '') === '1_month' ? 'selected' : '' ?>>1 Month</option>\n                            <option value=\"2_months\" <?= ($_GET['availability'] ?? '') === '2_months' ? 'selected' : '' ?>>2 Months</option>\n                            <option value=\"3_months\" <?= ($_GET['availability'] ?? '') === '3_months' ? 'selected' : '' ?>>3+ Months</option>\n                        </select>\n                    </div>\n                    <div class=\"col-md-3 d-flex align-items-end\">\n                        <button type=\"submit\" class=\"btn btn-primary w-100\">\n                            <i class=\"fas fa-search\"></i> Search Candidates\n                        </button>\n                    </div>\n                    <div class=\"col-md-3 d-flex align-items-end\">\n                        <a href=\"/admin/candidates\" class=\"btn btn-secondary w-100\">\n                            <i class=\"fas fa-redo\"></i> Reset Filters\n                        </a>\n                    </div>\n                </div>\n            </form>\n        </div>\n    </div>\n\n    <!-- Candidates List -->\n    <p class=\"text-muted\">Found <?= count($candidates) ?> candidates</p>\n    \n    <?php if (empty($candidates)): ?>\n        <div class=\"alert alert-info\">\n            No candidates found. Try adjusting your search filters.\n        </div>\n    <?php else: ?>\n        <div class=\"row\">\n            <?php foreach ($candidates as $candidate): ?>\n                <div class=\"col-md-6 mb-4\">\n                    <div class=\"card shadow h-100\">\n                        <div class=\"card-body\">\n                            <div class=\"d-flex\">\n                                <?php if ($candidate['profile_picture']): ?>\n                                    <img src=\"/uploads/profiles/<?= htmlspecialchars($candidate['profile_picture']) ?>\" \n                                         alt=\"Profile\" class=\"rounded-circle me-3\" style=\"width: 80px; height: 80px; object-fit: cover;\">\n                                <?php else: ?>\n                                    <div class=\"bg-primary text-white rounded-circle me-3 d-flex align-items-center justify-content-center\" \n                                         style=\"width: 80px; height: 80px; font-size: 32px;\">\n                                        <i class=\"fas fa-user\"></i>\n                                    </div>\n                                <?php endif; ?>\n                                \n                                <div class=\"flex-grow-1\">\n                                    <h5 class=\"mb-1\"><?= htmlspecialchars($candidate['name']) ?></h5>\n                                    <?php if ($candidate['headline']): ?>\n                                        <p class=\"text-muted mb-2\"><?= htmlspecialchars($candidate['headline']) ?></p>\n                                    <?php endif; ?>\n                                    \n                                    <p class=\"mb-1\">\n                                        <?php if ($candidate['city']): ?>\n                                            <span class=\"badge bg-secondary\">\n                                                <i class=\"fas fa-map-marker-alt\"></i> <?= htmlspecialchars($candidate['city']) ?>, <?= htmlspecialchars($candidate['state']) ?>\n                                            </span>\n                                        <?php endif; ?>\n                                        <?php if ($candidate['total_experience_years']): ?>\n                                            <span class=\"badge bg-info\">\n                                                <i class=\"fas fa-briefcase\"></i> <?= $candidate['total_experience_years'] ?> years exp\n                                            </span>\n                                        <?php endif; ?>\n                                        <?php if ($candidate['availability']): ?>\n                                            <span class=\"badge bg-success\">\n                                                <i class=\"fas fa-clock\"></i> <?= ucfirst(str_replace('_', ' ', $candidate['availability'])) ?>\n                                            </span>\n                                        <?php endif; ?>\n                                    </p>\n                                    \n                                    <?php if ($candidate['skills']): ?>\n                                        <p class=\"mb-2\">\n                                            <strong>Skills:</strong> \n                                            <small><?= htmlspecialchars(substr($candidate['skills'], 0, 100)) ?><?= strlen($candidate['skills']) > 100 ? '...' : '' ?></small>\n                                        </p>\n                                    <?php endif; ?>\n                                    \n                                    <div class=\"mt-2\">\n                                        <a href=\"/admin/candidates/<?= $candidate['id'] ?>\" class=\"btn btn-sm btn-primary\">\n                                            <i class=\"fas fa-eye\"></i> View Full Profile\n                                        </a>\n                                        <?php if ($candidate['resume_file']): ?>\n                                            <a href=\"/uploads/resumes/<?= htmlspecialchars($candidate['resume_file']) ?>\" \n                                               target=\"_blank\" class=\"btn btn-sm btn-outline-success\">\n                                                <i class=\"fas fa-file-pdf\"></i> Resume\n                                            </a>\n                                        <?php endif; ?>\n                                    </div>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            <?php endforeach; ?>\n        </div>\n    <?php endif; ?>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":8573,"size_tokens":null},"config/database.php":{"content":"<?php\n/**\n * Database Connection using PDO\n */\n\nrequire_once __DIR__ . '/env.php';\n\nclass Database {\n    private static $instance = null;\n    private $conn;\n    \n    private function __construct() {\n        try {\n            $dsn = \"mysql:host=\" . DB_HOST . \";dbname=\" . DB_NAME . \";charset=utf8mb4\";\n            $options = [\n                PDO::ATTR_ERRMODE => PDO::ERRMODE_EXCEPTION,\n                PDO::ATTR_DEFAULT_FETCH_MODE => PDO::FETCH_ASSOC,\n                PDO::ATTR_EMULATE_PREPARES => false,\n            ];\n            \n            $this->conn = new PDO($dsn, DB_USER, DB_PASS, $options);\n        } catch (PDOException $e) {\n            error_log(\"Database Connection Error: \" . $e->getMessage());\n            die(\"Database connection failed. Please try again later.\");\n        }\n    }\n    \n    public static function getInstance() {\n        if (self::$instance === null) {\n            self::$instance = new self();\n        }\n        return self::$instance;\n    }\n    \n    public function getConnection() {\n        return $this->conn;\n    }\n    \n    // Prevent cloning of the instance\n    private function __clone() {}\n    \n    // Prevent unserializing of the instance\n    public function __wakeup() {\n        throw new Exception(\"Cannot unserialize singleton\");\n    }\n}\n\n// Get database connection\nfunction getDB() {\n    return Database::getInstance()->getConnection();\n}\n","path":null,"size_bytes":1387,"size_tokens":null},"app/views/home.php":{"content":"<?php\n$meta = generateMetaTags(\n    'Find Your Dream Job',\n    'Browse thousands of job opportunities across multiple categories. ConnectWith9 - Connecting talent with opportunity.',\n    'jobs, careers, employment, job portal, job search'\n);\n\nrequire __DIR__ . '/common/header.php';\n?>\n\n<div class=\"hero-section bg-primary text-white py-5\">\n    <div class=\"container\">\n        <div class=\"row align-items-center\">\n            <div class=\"col-lg-6\">\n                <h1 class=\"display-4 fw-bold\">Find Your Dream Job Today</h1>\n                <p class=\"lead\">Connect with top employers and discover thousands of job opportunities.</p>\n                <a href=\"/jobs\" class=\"btn btn-light btn-lg mt-3\">Browse Jobs</a>\n                <a href=\"/register\" class=\"btn btn-outline-light btn-lg mt-3 ms-2\">Register Now</a>\n            </div>\n            <div class=\"col-lg-6\">\n                <img src=\"<?= asset('images/hero.svg') ?>\" alt=\"Job Search\" class=\"img-fluid\" onerror=\"this.style.display='none'\">\n            </div>\n        </div>\n    </div>\n</div>\n\n<div class=\"container mt-5\">\n    <div class=\"row\">\n        <div class=\"col-md-12\">\n            <h2 class=\"text-center mb-4\">Latest Job Opportunities</h2>\n        </div>\n    </div>\n    \n    <div class=\"row\">\n        <?php foreach ($latestJobs as $job): ?>\n        <div class=\"col-md-6 col-lg-4 mb-4\">\n            <div class=\"card h-100 shadow-sm\">\n                <div class=\"card-body\">\n                    <h5 class=\"card-title\">\n                        <a href=\"/jobs/<?= $job['id'] ?>\" class=\"text-decoration-none\">\n                            <?= htmlspecialchars($job['title']) ?>\n                        </a>\n                    </h5>\n                    <p class=\"text-muted mb-2\">\n                        <i class=\"fas fa-building\"></i> <?= htmlspecialchars($job['employer_name']) ?>\n                    </p>\n                    <p class=\"text-muted mb-2\">\n                        <i class=\"fas fa-map-marker-alt\"></i> <?= htmlspecialchars($job['location']) ?>\n                    </p>\n                    <p class=\"mb-2\">\n                        <span class=\"badge bg-info\"><?= htmlspecialchars($job['type']) ?></span>\n                        <span class=\"badge bg-secondary\"><?= htmlspecialchars($job['category_name']) ?></span>\n                    </p>\n                    <p class=\"card-text\"><?= truncate(strip_tags($job['description']), 100) ?></p>\n                    <a href=\"/jobs/<?= $job['id'] ?>\" class=\"btn btn-primary btn-sm\">View Details</a>\n                </div>\n                <div class=\"card-footer text-muted\">\n                    <small><i class=\"fas fa-clock\"></i> <?= formatDate($job['created_at']) ?></small>\n                </div>\n            </div>\n        </div>\n        <?php endforeach; ?>\n    </div>\n    \n    <div class=\"text-center mt-4\">\n        <a href=\"/jobs\" class=\"btn btn-outline-primary btn-lg\">View All Jobs</a>\n    </div>\n</div>\n\n<div class=\"bg-light py-5 mt-5\">\n    <div class=\"container\">\n        <h2 class=\"text-center mb-5\">Browse by Category</h2>\n        <div class=\"row\">\n            <?php foreach ($categories as $category): ?>\n            <div class=\"col-md-4 col-lg-3 mb-3\">\n                <a href=\"/jobs?category=<?= $category['id'] ?>\" class=\"text-decoration-none\">\n                    <div class=\"card text-center shadow-sm hover-shadow\">\n                        <div class=\"card-body\">\n                            <h5 class=\"card-title\"><?= htmlspecialchars($category['name']) ?></h5>\n                            <p class=\"text-muted\"><?= $category['job_count'] ?> jobs</p>\n                        </div>\n                    </div>\n                </a>\n            </div>\n            <?php endforeach; ?>\n        </div>\n    </div>\n</div>\n\n<?php require __DIR__ . '/common/footer.php'; ?>\n","path":null,"size_bytes":3806,"size_tokens":null},"app/models/JobSeekerProfile.php":{"content":"<?php\nrequire_once __DIR__ . '/../../config/database.php';\n\nclass JobSeekerProfile {\n    private $db;\n    \n    public function __construct() {\n        $this->db = getDB();\n    }\n    \n    // Main Profile Methods\n    public function getProfile($userId) {\n        $stmt = $this->db->prepare(\"\n            SELECT * FROM jobseeker_profiles WHERE user_id = :user_id\n        \");\n        $stmt->execute(['user_id' => $userId]);\n        return $stmt->fetch(PDO::FETCH_ASSOC);\n    }\n    \n    public function createProfile($data) {\n        $stmt = $this->db->prepare(\"\n            INSERT INTO jobseeker_profiles (\n                user_id, headline, summary, phone, address, city, state, country,\n                postal_code, date_of_birth, gender, linkedin_url, github_url,\n                portfolio_url, total_experience_years, current_salary, expected_salary,\n                notice_period, availability, willing_to_relocate\n            ) VALUES (\n                :user_id, :headline, :summary, :phone, :address, :city, :state, :country,\n                :postal_code, :date_of_birth, :gender, :linkedin_url, :github_url,\n                :portfolio_url, :total_experience_years, :current_salary, :expected_salary,\n                :notice_period, :availability, :willing_to_relocate\n            )\n        \");\n        \n        return $stmt->execute($data);\n    }\n    \n    public function updateProfile($userId, $data) {\n        $data['user_id'] = $userId;\n        \n        $stmt = $this->db->prepare(\"\n            UPDATE jobseeker_profiles SET\n                headline = :headline,\n                summary = :summary,\n                phone = :phone,\n                address = :address,\n                city = :city,\n                state = :state,\n                country = :country,\n                postal_code = :postal_code,\n                date_of_birth = :date_of_birth,\n                gender = :gender,\n                linkedin_url = :linkedin_url,\n                github_url = :github_url,\n                portfolio_url = :portfolio_url,\n                total_experience_years = :total_experience_years,\n                current_salary = :current_salary,\n                expected_salary = :expected_salary,\n                notice_period = :notice_period,\n                availability = :availability,\n                willing_to_relocate = :willing_to_relocate\n            WHERE user_id = :user_id\n        \");\n        \n        return $stmt->execute($data);\n    }\n    \n    public function updateProfilePicture($userId, $filename) {\n        $stmt = $this->db->prepare(\"\n            UPDATE jobseeker_profiles SET profile_picture = :filename\n            WHERE user_id = :user_id\n        \");\n        return $stmt->execute(['user_id' => $userId, 'filename' => $filename]);\n    }\n    \n    public function updateResume($userId, $filename) {\n        $stmt = $this->db->prepare(\"\n            UPDATE jobseeker_profiles SET resume_file = :filename\n            WHERE user_id = :user_id\n        \");\n        return $stmt->execute(['user_id' => $userId, 'filename' => $filename]);\n    }\n    \n    // Work Experience Methods\n    public function getWorkExperiences($userId) {\n        $stmt = $this->db->prepare(\"\n            SELECT * FROM work_experiences\n            WHERE user_id = :user_id\n            ORDER BY is_current DESC, start_date DESC\n        \");\n        $stmt->execute(['user_id' => $userId]);\n        return $stmt->fetchAll(PDO::FETCH_ASSOC);\n    }\n    \n    public function addWorkExperience($data) {\n        $stmt = $this->db->prepare(\"\n            INSERT INTO work_experiences (\n                user_id, job_title, company_name, location, employment_type,\n                start_date, end_date, is_current, description, achievements\n            ) VALUES (\n                :user_id, :job_title, :company_name, :location, :employment_type,\n                :start_date, :end_date, :is_current, :description, :achievements\n            )\n        \");\n        return $stmt->execute($data);\n    }\n    \n    public function updateWorkExperience($id, $userId, $data) {\n        $data['id'] = $id;\n        $data['user_id'] = $userId;\n        \n        $stmt = $this->db->prepare(\"\n            UPDATE work_experiences SET\n                job_title = :job_title,\n                company_name = :company_name,\n                location = :location,\n                employment_type = :employment_type,\n                start_date = :start_date,\n                end_date = :end_date,\n                is_current = :is_current,\n                description = :description,\n                achievements = :achievements\n            WHERE id = :id AND user_id = :user_id\n        \");\n        return $stmt->execute($data);\n    }\n    \n    public function deleteWorkExperience($id, $userId) {\n        $stmt = $this->db->prepare(\"\n            DELETE FROM work_experiences WHERE id = :id AND user_id = :user_id\n        \");\n        return $stmt->execute(['id' => $id, 'user_id' => $userId]);\n    }\n    \n    // Education Methods\n    public function getEducation($userId) {\n        $stmt = $this->db->prepare(\"\n            SELECT * FROM education\n            WHERE user_id = :user_id\n            ORDER BY end_date DESC\n        \");\n        $stmt->execute(['user_id' => $userId]);\n        return $stmt->fetchAll(PDO::FETCH_ASSOC);\n    }\n    \n    public function addEducation($data) {\n        $stmt = $this->db->prepare(\"\n            INSERT INTO education (\n                user_id, degree, field_of_study, institution, location,\n                start_date, end_date, grade, description\n            ) VALUES (\n                :user_id, :degree, :field_of_study, :institution, :location,\n                :start_date, :end_date, :grade, :description\n            )\n        \");\n        return $stmt->execute($data);\n    }\n    \n    public function deleteEducation($id, $userId) {\n        $stmt = $this->db->prepare(\"\n            DELETE FROM education WHERE id = :id AND user_id = :user_id\n        \");\n        return $stmt->execute(['id' => $id, 'user_id' => $userId]);\n    }\n    \n    // Skills Methods\n    public function getSkills($userId) {\n        $stmt = $this->db->prepare(\"\n            SELECT * FROM skills\n            WHERE user_id = :user_id\n            ORDER BY proficiency DESC, skill_name ASC\n        \");\n        $stmt->execute(['user_id' => $userId]);\n        return $stmt->fetchAll(PDO::FETCH_ASSOC);\n    }\n    \n    public function addSkill($data) {\n        $stmt = $this->db->prepare(\"\n            INSERT INTO skills (user_id, skill_name, proficiency, years_of_experience)\n            VALUES (:user_id, :skill_name, :proficiency, :years_of_experience)\n        \");\n        return $stmt->execute($data);\n    }\n    \n    public function deleteSkill($id, $userId) {\n        $stmt = $this->db->prepare(\"\n            DELETE FROM skills WHERE id = :id AND user_id = :user_id\n        \");\n        return $stmt->execute(['id' => $id, 'user_id' => $userId]);\n    }\n    \n    // Certifications Methods\n    public function getCertifications($userId) {\n        $stmt = $this->db->prepare(\"\n            SELECT * FROM certifications\n            WHERE user_id = :user_id\n            ORDER BY issue_date DESC\n        \");\n        $stmt->execute(['user_id' => $userId]);\n        return $stmt->fetchAll(PDO::FETCH_ASSOC);\n    }\n    \n    public function addCertification($data) {\n        $stmt = $this->db->prepare(\"\n            INSERT INTO certifications (\n                user_id, certification_name, issuing_organization, issue_date,\n                expiry_date, credential_id, credential_url, description\n            ) VALUES (\n                :user_id, :certification_name, :issuing_organization, :issue_date,\n                :expiry_date, :credential_id, :credential_url, :description\n            )\n        \");\n        return $stmt->execute($data);\n    }\n    \n    public function deleteCertification($id, $userId) {\n        $stmt = $this->db->prepare(\"\n            DELETE FROM certifications WHERE id = :id AND user_id = :user_id\n        \");\n        return $stmt->execute(['id' => $id, 'user_id' => $userId]);\n    }\n    \n    // Languages Methods\n    public function getLanguages($userId) {\n        $stmt = $this->db->prepare(\"\n            SELECT * FROM languages\n            WHERE user_id = :user_id\n            ORDER BY proficiency DESC\n        \");\n        $stmt->execute(['user_id' => $userId]);\n        return $stmt->fetchAll(PDO::FETCH_ASSOC);\n    }\n    \n    public function addLanguage($data) {\n        $stmt = $this->db->prepare(\"\n            INSERT INTO languages (user_id, language_name, proficiency)\n            VALUES (:user_id, :language_name, :proficiency)\n        \");\n        return $stmt->execute($data);\n    }\n    \n    public function deleteLanguage($id, $userId) {\n        $stmt = $this->db->prepare(\"\n            DELETE FROM languages WHERE id = :id AND user_id = :user_id\n        \");\n        return $stmt->execute(['id' => $id, 'user_id' => $userId]);\n    }\n    \n    // Projects Methods\n    public function getProjects($userId) {\n        $stmt = $this->db->prepare(\"\n            SELECT * FROM projects\n            WHERE user_id = :user_id\n            ORDER BY is_ongoing DESC, end_date DESC\n        \");\n        $stmt->execute(['user_id' => $userId]);\n        return $stmt->fetchAll(PDO::FETCH_ASSOC);\n    }\n    \n    public function addProject($data) {\n        $stmt = $this->db->prepare(\"\n            INSERT INTO projects (\n                user_id, project_name, project_url, description,\n                technologies_used, start_date, end_date, is_ongoing\n            ) VALUES (\n                :user_id, :project_name, :project_url, :description,\n                :technologies_used, :start_date, :end_date, :is_ongoing\n            )\n        \");\n        return $stmt->execute($data);\n    }\n    \n    public function deleteProject($id, $userId) {\n        $stmt = $this->db->prepare(\"\n            DELETE FROM projects WHERE id = :id AND user_id = :user_id\n        \");\n        return $stmt->execute(['id' => $id, 'user_id' => $userId]);\n    }\n    \n    // Admin & Employer - Get all candidates with filters\n    public function searchCandidates($filters = []) {\n        $sql = \"SELECT \n                    u.id, u.name, u.email,\n                    jp.headline, jp.city, jp.state, jp.total_experience_years,\n                    jp.expected_salary, jp.availability, jp.profile_picture,\n                    jp.resume_file, jp.willing_to_relocate,\n                    GROUP_CONCAT(DISTINCT s.skill_name) as skills\n                FROM users u\n                LEFT JOIN jobseeker_profiles jp ON u.id = jp.user_id\n                LEFT JOIN skills s ON u.id = s.user_id\n                WHERE u.type = 'jobseeker'\";\n        \n        $params = [];\n        \n        if (!empty($filters['city'])) {\n            $sql .= \" AND jp.city LIKE :city\";\n            $params['city'] = '%' . $filters['city'] . '%';\n        }\n        \n        if (!empty($filters['state'])) {\n            $sql .= \" AND jp.state LIKE :state\";\n            $params['state'] = '%' . $filters['state'] . '%';\n        }\n        \n        if (!empty($filters['min_experience'])) {\n            $sql .= \" AND jp.total_experience_years >= :min_exp\";\n            $params['min_exp'] = $filters['min_experience'];\n        }\n        \n        if (!empty($filters['max_experience'])) {\n            $sql .= \" AND jp.total_experience_years <= :max_exp\";\n            $params['max_exp'] = $filters['max_experience'];\n        }\n        \n        if (!empty($filters['availability'])) {\n            $sql .= \" AND jp.availability = :availability\";\n            $params['availability'] = $filters['availability'];\n        }\n        \n        if (!empty($filters['skill'])) {\n            $sql .= \" AND s.skill_name LIKE :skill\";\n            $params['skill'] = '%' . $filters['skill'] . '%';\n        }\n        \n        $sql .= \" GROUP BY u.id ORDER BY jp.updated_at DESC\";\n        \n        $stmt = $this->db->prepare($sql);\n        $stmt->execute($params);\n        return $stmt->fetchAll(PDO::FETCH_ASSOC);\n    }\n    \n    // Get complete profile with all sections\n    public function getCompleteProfile($userId) {\n        return [\n            'profile' => $this->getProfile($userId),\n            'work_experiences' => $this->getWorkExperiences($userId),\n            'education' => $this->getEducation($userId),\n            'skills' => $this->getSkills($userId),\n            'certifications' => $this->getCertifications($userId),\n            'languages' => $this->getLanguages($userId),\n            'projects' => $this->getProjects($userId)\n        ];\n    }\n}\n","path":null,"size_bytes":12547,"size_tokens":null},"app/views/employer/job-applications.php":{"content":"<?php\n$meta = generateMetaTags('Job Applications', 'View applications for ' . $job['title']);\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container\">\n    <h1 class=\"mb-4\">Applications for: <?= htmlspecialchars($job['title']) ?></h1>\n    \n    <?php if ($success = getFlash('success')): ?>\n        <div class=\"alert alert-success\"><?= $success ?></div>\n    <?php endif; ?>\n    \n    <?php if ($error = getFlash('error')): ?>\n        <div class=\"alert alert-danger\"><?= $error ?></div>\n    <?php endif; ?>\n    \n    <?php if (isset($_SESSION['selection_notification'])): ?>\n        <?php $notification = $_SESSION['selection_notification']; unset($_SESSION['selection_notification']); ?>\n        <div class=\"alert alert-info\">\n            <h5><i class=\"fas fa-bell\"></i> Send Selection Notification to <?= htmlspecialchars($notification['candidate_name']) ?></h5>\n            <p class=\"mb-2\">Click below to notify the candidate about their selection:</p>\n            <a href=\"mailto:<?= htmlspecialchars($notification['candidate_email']) ?>?subject=<?= urlencode($notification['email_subject']) ?>&body=<?= urlencode($notification['email_body']) ?>\" class=\"btn btn-primary me-2\">\n                <i class=\"fas fa-envelope\"></i> Send Email Notification\n            </a>\n            <?php if ($notification['candidate_phone']): ?>\n            <a href=\"https://wa.me/<?= htmlspecialchars($notification['candidate_phone']) ?>?text=<?= urlencode($notification['whatsapp_message']) ?>\" target=\"_blank\" class=\"btn btn-success\">\n                <i class=\"fab fa-whatsapp\"></i> Send WhatsApp Notification\n            </a>\n            <?php endif; ?>\n        </div>\n    <?php endif; ?>\n    \n    <div class=\"card mb-4\">\n        <div class=\"card-body\">\n            <h5>Job Details</h5>\n            <p class=\"mb-1\"><strong>Location:</strong> <?= htmlspecialchars($job['location']) ?></p>\n            <p class=\"mb-1\"><strong>Type:</strong> <?= htmlspecialchars($job['type']) ?></p>\n            <p class=\"mb-0\"><strong>Total Applications:</strong> <?= count($applications) ?></p>\n        </div>\n    </div>\n    \n    <?php if (empty($applications)): ?>\n        <div class=\"alert alert-info\">No applications received yet.</div>\n    <?php else: ?>\n        <div class=\"card\">\n            <div class=\"card-body\">\n                <div class=\"table-responsive\">\n                    <table class=\"table table-striped\">\n                        <thead>\n                            <tr>\n                                <th>Applicant Name</th>\n                                <th>Email</th>\n                                <th>Phone</th>\n                                <th>Applied On</th>\n                                <th>Status</th>\n                                <th>Resume</th>\n                                <th>Contact</th>\n                                <th>Action</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <?php foreach ($applications as $index => $application): ?>\n                            <?php\n                                $phone = $application['applicant_phone'] ?? '';\n                                $cleanPhone = preg_replace('/[^0-9]/', '', $phone);\n                                $email = $application['applicant_email'];\n                                $name = $application['applicant_name'];\n                                $jobTitle = $job['title'];\n                                $isSelected = ($application['status'] ?? 'pending') === 'selected';\n                            ?>\n                            <tr class=\"<?= $isSelected ? 'table-success' : '' ?>\">\n                                <td><?= htmlspecialchars($name) ?></td>\n                                <td><?= htmlspecialchars($email) ?></td>\n                                <td><?= $phone ? htmlspecialchars($phone) : '<span class=\"text-muted\">Not provided</span>' ?></td>\n                                <td><?= formatDate($application['applied_at']) ?></td>\n                                <td>\n                                    <?php if ($isSelected): ?>\n                                        <span class=\"badge bg-success\"><i class=\"fas fa-check-circle\"></i> Selected</span>\n                                    <?php else: ?>\n                                        <span class=\"badge bg-secondary\">Pending</span>\n                                    <?php endif; ?>\n                                </td>\n                                <td>\n                                    <a href=\"/public/uploads/resumes/<?= htmlspecialchars($application['resume_path']) ?>\" class=\"btn btn-sm btn-primary\" target=\"_blank\" download>\n                                        <i class=\"fas fa-download\"></i> Download\n                                    </a>\n                                </td>\n                                <td>\n                                    <a href=\"mailto:<?= htmlspecialchars($email) ?>?subject=<?= urlencode(\"Regarding your application for $jobTitle\") ?>&body=<?= urlencode(\"Dear $name,\\n\\nThank you for applying for the position of $jobTitle.\\n\\nBest regards\") ?>\" class=\"btn btn-sm btn-info text-white\" title=\"Send Email\">\n                                        <i class=\"fas fa-envelope\"></i> Email\n                                    </a>\n                                    <?php if ($cleanPhone): ?>\n                                    <a href=\"https://wa.me/<?= htmlspecialchars($cleanPhone) ?>?text=<?= urlencode(\"Hello $name, I'm reaching out regarding your application for the position of $jobTitle.\") ?>\" target=\"_blank\" class=\"btn btn-sm btn-success mt-1\" title=\"Send WhatsApp\">\n                                        <i class=\"fab fa-whatsapp\"></i> WhatsApp\n                                    </a>\n                                    <?php else: ?>\n                                    <button class=\"btn btn-sm btn-secondary mt-1\" disabled title=\"No phone number\">\n                                        <i class=\"fab fa-whatsapp\"></i> WhatsApp\n                                    </button>\n                                    <?php endif; ?>\n                                    <?php if ($isSelected): ?>\n                                    <a href=\"/chat/start/<?= $application['user_id'] ?>?job_id=<?= $job['id'] ?>\" class=\"btn btn-sm btn-primary mt-1\" title=\"Message Candidate\">\n                                        <i class=\"fas fa-comment\"></i> Message\n                                    </a>\n                                    <?php endif; ?>\n                                </td>\n                                <td>\n                                    <?php if ($isSelected): ?>\n                                        <button type=\"button\" class=\"btn btn-sm btn-outline-success\" disabled>\n                                            <i class=\"fas fa-user-check\"></i> Selected\n                                        </button>\n                                    <?php else: ?>\n                                        <form action=\"/employer/jobs/<?= $job['id'] ?>/applications/<?= $application['id'] ?>/select\" method=\"POST\" style=\"display:inline;\">\n                                            <input type=\"hidden\" name=\"csrf_token\" value=\"<?= getCSRFToken() ?>\">\n                                            <button type=\"submit\" class=\"btn btn-sm btn-success\" onclick=\"return confirm('Select this candidate? You will be prompted to send them a notification.')\">\n                                                <i class=\"fas fa-user-check\"></i> Select\n                                            </button>\n                                        </form>\n                                    <?php endif; ?>\n                                </td>\n                            </tr>\n                            <?php endforeach; ?>\n                        </tbody>\n                    </table>\n                </div>\n            </div>\n        </div>\n    <?php endif; ?>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":8054,"size_tokens":null},"app/controllers/JobSeekerController.php":{"content":"<?php\nrequire_once __DIR__ . '/../models/Job.php';\nrequire_once __DIR__ . '/../models/Application.php';\nrequire_once __DIR__ . '/../models/JobSeekerProfile.php';\nrequire_once __DIR__ . '/../../includes/functions.php';\n\nclass JobSeekerController {\n    private $jobModel;\n    private $applicationModel;\n    private $profileModel;\n    \n    public function __construct() {\n        requireRole(USER_TYPE_JOBSEEKER);\n        $this->jobModel = new Job();\n        $this->applicationModel = new Application();\n        $this->profileModel = new JobSeekerProfile();\n    }\n    \n    public function dashboard() {\n        $user = getCurrentUser();\n        \n        $stats = [\n            'applications' => $this->applicationModel->countByUser($user['id'])\n        ];\n        \n        $recentApplications = $this->applicationModel->getByUser($user['id'], 5);\n        $latestJobs = $this->jobModel->getAll(['status' => JOB_STATUS_APPROVED, 'limit' => 5]);\n        \n        require __DIR__ . '/../views/jobseeker/dashboard.php';\n    }\n    \n    public function applications() {\n        $user = getCurrentUser();\n        $applications = $this->applicationModel->getByUser($user['id']);\n        \n        require __DIR__ . '/../views/jobseeker/applications.php';\n    }\n    \n    // Profile Management\n    public function showProfile() {\n        $user = getCurrentUser();\n        $data = $this->profileModel->getCompleteProfile($user['id']);\n        $data['user'] = $user;\n        \n        require __DIR__ . '/../views/jobseeker/profile.php';\n    }\n    \n    public function editProfile() {\n        $user = getCurrentUser();\n        $data = $this->profileModel->getCompleteProfile($user['id']);\n        $data['user'] = $user;\n        \n        require __DIR__ . '/../views/jobseeker/edit_profile.php';\n    }\n    \n    public function updateBasicInfo() {\n        if (!verifyCsrfToken($_POST['csrf_token'])) {\n            setFlash('error', 'Invalid request');\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $user = getCurrentUser();\n        \n        $data = [\n            'headline' => sanitize($_POST['headline'] ?? ''),\n            'summary' => sanitize($_POST['summary'] ?? ''),\n            'phone' => sanitize($_POST['phone'] ?? ''),\n            'address' => sanitize($_POST['address'] ?? ''),\n            'city' => sanitize($_POST['city'] ?? ''),\n            'state' => sanitize($_POST['state'] ?? ''),\n            'country' => sanitize($_POST['country'] ?? 'India'),\n            'postal_code' => sanitize($_POST['postal_code'] ?? ''),\n            'date_of_birth' => $_POST['date_of_birth'] ?? null,\n            'gender' => $_POST['gender'] ?? null,\n            'linkedin_url' => sanitize($_POST['linkedin_url'] ?? ''),\n            'github_url' => sanitize($_POST['github_url'] ?? ''),\n            'portfolio_url' => sanitize($_POST['portfolio_url'] ?? ''),\n            'total_experience_years' => (int)($_POST['total_experience_years'] ?? 0),\n            'current_salary' => $_POST['current_salary'] ?? null,\n            'expected_salary' => $_POST['expected_salary'] ?? null,\n            'notice_period' => sanitize($_POST['notice_period'] ?? ''),\n            'availability' => $_POST['availability'] ?? 'immediate',\n            'willing_to_relocate' => isset($_POST['willing_to_relocate']) ? 1 : 0\n        ];\n        \n        $profile = $this->profileModel->getProfile($user['id']);\n        \n        if ($profile) {\n            $this->profileModel->updateProfile($user['id'], $data);\n        } else {\n            $data['user_id'] = $user['id'];\n            $this->profileModel->createProfile($data);\n        }\n        \n        setFlash('success', 'Profile updated successfully');\n        redirect('/jobseeker/profile');\n    }\n    \n    public function uploadProfilePicture() {\n        if (!verifyCsrfToken($_POST['csrf_token'])) {\n            setFlash('error', 'Invalid request');\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $user = getCurrentUser();\n        \n        if (!isset($_FILES['profile_picture']) || $_FILES['profile_picture']['error'] !== UPLOAD_ERR_OK) {\n            setFlash('error', 'Please select a valid image file');\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $file = $_FILES['profile_picture'];\n        $allowedTypes = ['jpg', 'jpeg', 'png', 'gif'];\n        $maxSize = 2 * 1024 * 1024; // 2MB\n        \n        $errors = validateFileUpload($file, $allowedTypes, $maxSize);\n        \n        if (!empty($errors)) {\n            setFlash('error', implode(', ', $errors));\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $uploadDir = __DIR__ . '/../../public/uploads/profiles/';\n        if (!is_dir($uploadDir)) {\n            mkdir($uploadDir, 0755, true);\n        }\n        \n        $filename = uploadFile($file, $uploadDir);\n        \n        if ($filename) {\n            $profile = $this->profileModel->getProfile($user['id']);\n            if (!$profile) {\n                $this->profileModel->createProfile(['user_id' => $user['id']]);\n            }\n            $this->profileModel->updateProfilePicture($user['id'], $filename);\n            setFlash('success', 'Profile picture updated successfully');\n        } else {\n            setFlash('error', 'Failed to upload profile picture');\n        }\n        \n        redirect('/jobseeker/profile/edit');\n    }\n    \n    public function uploadResume() {\n        if (!verifyCsrfToken($_POST['csrf_token'])) {\n            setFlash('error', 'Invalid request');\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $user = getCurrentUser();\n        \n        if (!isset($_FILES['resume']) || $_FILES['resume']['error'] !== UPLOAD_ERR_OK) {\n            setFlash('error', 'Please select a valid resume file');\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $file = $_FILES['resume'];\n        $errors = validateFileUpload($file);\n        \n        if (!empty($errors)) {\n            setFlash('error', implode(', ', $errors));\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $filename = uploadFile($file, RESUME_UPLOAD_PATH);\n        \n        if ($filename) {\n            $profile = $this->profileModel->getProfile($user['id']);\n            if (!$profile) {\n                $this->profileModel->createProfile(['user_id' => $user['id']]);\n            }\n            $this->profileModel->updateResume($user['id'], $filename);\n            setFlash('success', 'Resume uploaded successfully');\n        } else {\n            setFlash('error', 'Failed to upload resume');\n        }\n        \n        redirect('/jobseeker/profile/edit');\n    }\n    \n    // Work Experience\n    public function addWorkExperience() {\n        if (!verifyCsrfToken($_POST['csrf_token'])) {\n            setFlash('error', 'Invalid request');\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $user = getCurrentUser();\n        \n        $data = [\n            'user_id' => $user['id'],\n            'job_title' => sanitize($_POST['job_title']),\n            'company_name' => sanitize($_POST['company_name']),\n            'location' => sanitize($_POST['location'] ?? ''),\n            'employment_type' => $_POST['employment_type'] ?? 'full_time',\n            'start_date' => $_POST['start_date'],\n            'end_date' => isset($_POST['is_current']) ? null : ($_POST['end_date'] ?? null),\n            'is_current' => isset($_POST['is_current']) ? 1 : 0,\n            'description' => sanitize($_POST['description'] ?? ''),\n            'achievements' => sanitize($_POST['achievements'] ?? '')\n        ];\n        \n        $this->profileModel->addWorkExperience($data);\n        setFlash('success', 'Work experience added successfully');\n        redirect('/jobseeker/profile/edit');\n    }\n    \n    public function deleteWorkExperience() {\n        if (!verifyCsrfToken($_POST['csrf_token'])) {\n            setFlash('error', 'Invalid request');\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $user = getCurrentUser();\n        $id = $_POST['id'];\n        \n        $this->profileModel->deleteWorkExperience($id, $user['id']);\n        setFlash('success', 'Work experience deleted');\n        redirect('/jobseeker/profile/edit');\n    }\n    \n    // Education\n    public function addEducation() {\n        if (!verifyCsrfToken($_POST['csrf_token'])) {\n            setFlash('error', 'Invalid request');\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $user = getCurrentUser();\n        \n        $data = [\n            'user_id' => $user['id'],\n            'degree' => sanitize($_POST['degree']),\n            'field_of_study' => sanitize($_POST['field_of_study'] ?? ''),\n            'institution' => sanitize($_POST['institution']),\n            'location' => sanitize($_POST['location'] ?? ''),\n            'start_date' => $_POST['start_date'] ?? null,\n            'end_date' => $_POST['end_date'] ?? null,\n            'grade' => sanitize($_POST['grade'] ?? ''),\n            'description' => sanitize($_POST['description'] ?? '')\n        ];\n        \n        $this->profileModel->addEducation($data);\n        setFlash('success', 'Education added successfully');\n        redirect('/jobseeker/profile/edit');\n    }\n    \n    public function deleteEducation() {\n        if (!verifyCsrfToken($_POST['csrf_token'])) {\n            setFlash('error', 'Invalid request');\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $user = getCurrentUser();\n        $id = $_POST['id'];\n        \n        $this->profileModel->deleteEducation($id, $user['id']);\n        setFlash('success', 'Education deleted');\n        redirect('/jobseeker/profile/edit');\n    }\n    \n    // Skills\n    public function addSkill() {\n        if (!verifyCsrfToken($_POST['csrf_token'])) {\n            setFlash('error', 'Invalid request');\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $user = getCurrentUser();\n        \n        $data = [\n            'user_id' => $user['id'],\n            'skill_name' => sanitize($_POST['skill_name']),\n            'proficiency' => $_POST['proficiency'] ?? 'intermediate',\n            'years_of_experience' => (int)($_POST['years_of_experience'] ?? 0)\n        ];\n        \n        $this->profileModel->addSkill($data);\n        setFlash('success', 'Skill added successfully');\n        redirect('/jobseeker/profile/edit');\n    }\n    \n    public function deleteSkill() {\n        if (!verifyCsrfToken($_POST['csrf_token'])) {\n            setFlash('error', 'Invalid request');\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $user = getCurrentUser();\n        $id = $_POST['id'];\n        \n        $this->profileModel->deleteSkill($id, $user['id']);\n        setFlash('success', 'Skill deleted');\n        redirect('/jobseeker/profile/edit');\n    }\n    \n    // Certifications\n    public function addCertification() {\n        if (!verifyCsrfToken($_POST['csrf_token'])) {\n            setFlash('error', 'Invalid request');\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $user = getCurrentUser();\n        \n        $data = [\n            'user_id' => $user['id'],\n            'certification_name' => sanitize($_POST['certification_name']),\n            'issuing_organization' => sanitize($_POST['issuing_organization']),\n            'issue_date' => $_POST['issue_date'] ?? null,\n            'expiry_date' => $_POST['expiry_date'] ?? null,\n            'credential_id' => sanitize($_POST['credential_id'] ?? ''),\n            'credential_url' => sanitize($_POST['credential_url'] ?? ''),\n            'description' => sanitize($_POST['description'] ?? '')\n        ];\n        \n        $this->profileModel->addCertification($data);\n        setFlash('success', 'Certification added successfully');\n        redirect('/jobseeker/profile/edit');\n    }\n    \n    public function deleteCertification() {\n        if (!verifyCsrfToken($_POST['csrf_token'])) {\n            setFlash('error', 'Invalid request');\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $user = getCurrentUser();\n        $id = $_POST['id'];\n        \n        $this->profileModel->deleteCertification($id, $user['id']);\n        setFlash('success', 'Certification deleted');\n        redirect('/jobseeker/profile/edit');\n    }\n    \n    // Languages\n    public function addLanguage() {\n        if (!verifyCsrfToken($_POST['csrf_token'])) {\n            setFlash('error', 'Invalid request');\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $user = getCurrentUser();\n        \n        $data = [\n            'user_id' => $user['id'],\n            'language_name' => sanitize($_POST['language_name']),\n            'proficiency' => $_POST['proficiency'] ?? 'professional'\n        ];\n        \n        $this->profileModel->addLanguage($data);\n        setFlash('success', 'Language added successfully');\n        redirect('/jobseeker/profile/edit');\n    }\n    \n    public function deleteLanguage() {\n        if (!verifyCsrfToken($_POST['csrf_token'])) {\n            setFlash('error', 'Invalid request');\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $user = getCurrentUser();\n        $id = $_POST['id'];\n        \n        $this->profileModel->deleteLanguage($id, $user['id']);\n        setFlash('success', 'Language deleted');\n        redirect('/jobseeker/profile/edit');\n    }\n    \n    // Projects\n    public function addProject() {\n        if (!verifyCsrfToken($_POST['csrf_token'])) {\n            setFlash('error', 'Invalid request');\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $user = getCurrentUser();\n        \n        $data = [\n            'user_id' => $user['id'],\n            'project_name' => sanitize($_POST['project_name']),\n            'project_url' => sanitize($_POST['project_url'] ?? ''),\n            'description' => sanitize($_POST['description'] ?? ''),\n            'technologies_used' => sanitize($_POST['technologies_used'] ?? ''),\n            'start_date' => $_POST['start_date'] ?? null,\n            'end_date' => isset($_POST['is_ongoing']) ? null : ($_POST['end_date'] ?? null),\n            'is_ongoing' => isset($_POST['is_ongoing']) ? 1 : 0\n        ];\n        \n        $this->profileModel->addProject($data);\n        setFlash('success', 'Project added successfully');\n        redirect('/jobseeker/profile/edit');\n    }\n    \n    public function deleteProject() {\n        if (!verifyCsrfToken($_POST['csrf_token'])) {\n            setFlash('error', 'Invalid request');\n            redirect('/jobseeker/profile/edit');\n        }\n        \n        $user = getCurrentUser();\n        $id = $_POST['id'];\n        \n        $this->profileModel->deleteProject($id, $user['id']);\n        setFlash('success', 'Project deleted');\n        redirect('/jobseeker/profile/edit');\n    }\n}\n","path":null,"size_bytes":14891,"size_tokens":null},"app/views/admin/notifications.php":{"content":"<?php\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container\">\n    <h1 class=\"mb-4\"><i class=\"fas fa-bullhorn\"></i> System Notifications</h1>\n    \n    <?php if ($success = getFlash('success')): ?>\n        <div class=\"alert alert-success\"><?= $success ?></div>\n    <?php endif; ?>\n    \n    <?php if ($error = getFlash('error')): ?>\n        <div class=\"alert alert-danger\"><?= $error ?></div>\n    <?php endif; ?>\n    \n    <div class=\"row\">\n        <div class=\"col-md-8\">\n            <div class=\"card mb-4\">\n                <div class=\"card-header bg-primary text-white\">\n                    <h5 class=\"mb-0\"><i class=\"fas fa-plus-circle\"></i> Create New Notification</h5>\n                </div>\n                <div class=\"card-body\">\n                    <form action=\"/admin/notifications/send\" method=\"POST\">\n                        <input type=\"hidden\" name=\"csrf_token\" value=\"<?= getCSRFToken() ?>\">\n                        \n                        <div class=\"mb-3\">\n                            <label for=\"target_role\" class=\"form-label\">Target Audience</label>\n                            <select class=\"form-select\" id=\"target_role\" name=\"target_role\" required>\n                                <option value=\"employer\">Employers Only</option>\n                                <option value=\"jobseeker\">Job Seekers Only</option>\n                                <option value=\"all\">All Users</option>\n                            </select>\n                            <small class=\"text-muted\">Select who should receive this notification</small>\n                        </div>\n                        \n                        <div class=\"mb-3\">\n                            <label for=\"title\" class=\"form-label\">Notification Title</label>\n                            <input type=\"text\" class=\"form-control\" id=\"title\" name=\"title\" required maxlength=\"255\" placeholder=\"e.g., New Feature: Enhanced Search\">\n                        </div>\n                        \n                        <div class=\"mb-3\">\n                            <label for=\"message\" class=\"form-label\">Notification Message</label>\n                            <textarea class=\"form-control\" id=\"message\" name=\"message\" rows=\"4\" required placeholder=\"Describe the update, new feature, or announcement...\"></textarea>\n                        </div>\n                        \n                        <button type=\"submit\" class=\"btn btn-primary\" onclick=\"return confirm('Send this notification to all selected users?')\">\n                            <i class=\"fas fa-paper-plane\"></i> Send Notification\n                        </button>\n                    </form>\n                </div>\n            </div>\n            \n            <div class=\"card\">\n                <div class=\"card-header\">\n                    <h5 class=\"mb-0\"><i class=\"fas fa-history\"></i> Sent Notifications</h5>\n                </div>\n                <div class=\"card-body\">\n                    <?php if (empty($systemNotifications)): ?>\n                        <div class=\"text-center text-muted py-4\">\n                            <i class=\"fas fa-bell-slash fa-3x mb-3\"></i>\n                            <p>No notifications have been sent yet.</p>\n                        </div>\n                    <?php else: ?>\n                        <div class=\"table-responsive\">\n                            <table class=\"table table-hover\">\n                                <thead>\n                                    <tr>\n                                        <th>Title</th>\n                                        <th>Message</th>\n                                        <th>Sent To</th>\n                                        <th>Date</th>\n                                        <th>Action</th>\n                                    </tr>\n                                </thead>\n                                <tbody>\n                                    <?php foreach ($systemNotifications as $notification): ?>\n                                    <tr>\n                                        <td><strong><?= htmlspecialchars($notification['title']) ?></strong></td>\n                                        <td>\n                                            <small><?= htmlspecialchars(substr($notification['message'], 0, 80)) ?><?= strlen($notification['message']) > 80 ? '...' : '' ?></small>\n                                        </td>\n                                        <td>\n                                            <span class=\"badge bg-info\"><?= $notification['recipient_count'] ?> users</span>\n                                        </td>\n                                        <td>\n                                            <small><?= date('M j, Y g:i A', strtotime($notification['created_at'])) ?></small>\n                                        </td>\n                                        <td>\n                                            <form action=\"/admin/notifications/delete\" method=\"POST\" class=\"d-inline\" onsubmit=\"return confirm('Delete this notification from all users? This cannot be undone.')\">\n                                                <input type=\"hidden\" name=\"csrf_token\" value=\"<?= getCSRFToken() ?>\">\n                                                <input type=\"hidden\" name=\"title\" value=\"<?= htmlspecialchars($notification['title']) ?>\">\n                                                <input type=\"hidden\" name=\"message\" value=\"<?= htmlspecialchars($notification['message']) ?>\">\n                                                <button type=\"submit\" class=\"btn btn-sm btn-danger\">\n                                                    <i class=\"fas fa-trash\"></i>\n                                                </button>\n                                            </form>\n                                        </td>\n                                    </tr>\n                                    <?php endforeach; ?>\n                                </tbody>\n                            </table>\n                        </div>\n                    <?php endif; ?>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"col-md-4\">\n            <div class=\"card bg-light\">\n                <div class=\"card-body\">\n                    <h6><i class=\"fas fa-info-circle\"></i> About System Notifications</h6>\n                    <p class=\"small text-muted mb-2\">Use this feature to inform users about:</p>\n                    <ul class=\"small text-muted mb-0\">\n                        <li>New features and updates</li>\n                        <li>System maintenance notices</li>\n                        <li>Policy changes</li>\n                        <li>Important announcements</li>\n                    </ul>\n                    <hr>\n                    <p class=\"small text-muted mb-0\">\n                        <strong>Note:</strong> Notifications will appear in the user's notification bell and on their notifications page.\n                    </p>\n                </div>\n            </div>\n            \n            <div class=\"card mt-3\">\n                <div class=\"card-body\">\n                    <h6><i class=\"fas fa-lightbulb\"></i> Example Notifications</h6>\n                    <div class=\"small\">\n                        <p class=\"mb-2\"><strong>For Employers:</strong></p>\n                        <ul class=\"text-muted mb-3\">\n                            <li>New candidate filtering options</li>\n                            <li>Enhanced job posting features</li>\n                            <li>Chat feature improvements</li>\n                        </ul>\n                        <p class=\"mb-2\"><strong>For Job Seekers:</strong></p>\n                        <ul class=\"text-muted mb-0\">\n                            <li>Profile enhancement tips</li>\n                            <li>New job categories added</li>\n                            <li>Application tracking updates</li>\n                        </ul>\n                    </div>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":8093,"size_tokens":null},"app/views/notifications/index.php":{"content":"<?php\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container\">\n    <div class=\"d-flex justify-content-between align-items-center mb-4\">\n        <h1><i class=\"fas fa-bell\"></i> Notifications</h1>\n        <?php if ($unreadCount > 0): ?>\n        <button type=\"button\" class=\"btn btn-outline-primary\" onclick=\"markAllRead()\">\n            <i class=\"fas fa-check-double\"></i> Mark All as Read\n        </button>\n        <?php endif; ?>\n    </div>\n    \n    <?php if ($success = getFlash('success')): ?>\n        <div class=\"alert alert-success\"><?= $success ?></div>\n    <?php endif; ?>\n    \n    <?php if ($error = getFlash('error')): ?>\n        <div class=\"alert alert-danger\"><?= $error ?></div>\n    <?php endif; ?>\n    \n    <?php if (empty($notifications)): ?>\n        <div class=\"card\">\n            <div class=\"card-body text-center py-5\">\n                <i class=\"fas fa-bell-slash fa-3x text-muted mb-3\"></i>\n                <h5 class=\"text-muted\">No notifications yet</h5>\n                <p class=\"text-muted\">You'll receive notifications about job selections, new jobs, and more.</p>\n            </div>\n        </div>\n    <?php else: ?>\n        <div class=\"list-group\">\n            <?php foreach ($notifications as $notification): ?>\n                <?php\n                    $iconClass = 'fa-bell text-secondary';\n                    $bgClass = $notification['is_read'] ? '' : 'bg-light';\n                    \n                    switch($notification['type']) {\n                        case 'job_selected':\n                            $iconClass = 'fa-trophy text-success';\n                            break;\n                        case 'new_job':\n                            $iconClass = 'fa-briefcase text-primary';\n                            break;\n                        case 'chat_message':\n                            $iconClass = 'fa-comment text-info';\n                            break;\n                        case 'system':\n                            $iconClass = 'fa-cog text-warning';\n                            break;\n                    }\n                    \n                    $link = '#';\n                    if ($notification['type'] === 'job_selected') {\n                        $link = '/chat';\n                    } elseif ($notification['type'] === 'new_job' && $notification['related_id']) {\n                        $link = '/jobs/' . $notification['related_id'];\n                    } elseif ($notification['type'] === 'chat_message' && $notification['related_id']) {\n                        $link = '/chat/' . $notification['related_id'];\n                    }\n                ?>\n                <div class=\"list-group-item list-group-item-action <?= $bgClass ?>\" id=\"notification-<?= $notification['id'] ?>\">\n                    <div class=\"d-flex align-items-start\">\n                        <div class=\"me-3\">\n                            <i class=\"fas <?= $iconClass ?> fa-lg\"></i>\n                        </div>\n                        <div class=\"flex-grow-1\">\n                            <div class=\"d-flex justify-content-between align-items-start\">\n                                <div>\n                                    <h6 class=\"mb-1\">\n                                        <?php if ($link !== '#'): ?>\n                                            <a href=\"<?= $link ?>\" class=\"text-decoration-none text-dark\"><?= htmlspecialchars($notification['title']) ?></a>\n                                        <?php else: ?>\n                                            <?= htmlspecialchars($notification['title']) ?>\n                                        <?php endif; ?>\n                                    </h6>\n                                    <p class=\"mb-1 text-muted\"><?= htmlspecialchars($notification['message']) ?></p>\n                                    <small class=\"text-muted\">\n                                        <i class=\"fas fa-clock\"></i> <?= formatDate($notification['created_at']) ?>\n                                        <?php if ($notification['actor_name']): ?>\n                                            &middot; From: <?= htmlspecialchars($notification['actor_name']) ?>\n                                        <?php endif; ?>\n                                    </small>\n                                </div>\n                                <div class=\"ms-2\">\n                                    <?php if (!$notification['is_read']): ?>\n                                        <button type=\"button\" class=\"btn btn-sm btn-outline-primary\" onclick=\"markAsRead(<?= $notification['id'] ?>)\" title=\"Mark as read\">\n                                            <i class=\"fas fa-check\"></i>\n                                        </button>\n                                    <?php endif; ?>\n                                    <button type=\"button\" class=\"btn btn-sm btn-outline-danger\" onclick=\"deleteNotification(<?= $notification['id'] ?>)\" title=\"Delete\">\n                                        <i class=\"fas fa-trash\"></i>\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                </div>\n            <?php endforeach; ?>\n        </div>\n    <?php endif; ?>\n</div>\n\n<script>\nfunction markAsRead(id) {\n    fetch('/notifications/' + id + '/read', { method: 'POST' })\n        .then(function(response) { return response.json(); })\n        .then(function(data) {\n            if (data.success) {\n                var item = document.getElementById('notification-' + id);\n                if (item) {\n                    item.classList.remove('bg-light');\n                    var btn = item.querySelector('.btn-outline-primary');\n                    if (btn) btn.remove();\n                }\n            }\n        });\n}\n\nfunction markAllRead() {\n    fetch('/notifications/mark-all-read', { method: 'POST' })\n        .then(function(response) { return response.json(); })\n        .then(function(data) {\n            if (data.success) {\n                location.reload();\n            }\n        });\n}\n\nfunction deleteNotification(id) {\n    if (!confirm('Delete this notification?')) return;\n    \n    fetch('/notifications/' + id + '/delete', { method: 'POST' })\n        .then(function(response) { return response.json(); })\n        .then(function(data) {\n            if (data.success) {\n                var item = document.getElementById('notification-' + id);\n                if (item) item.remove();\n            }\n        });\n}\n</script>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":6601,"size_tokens":null},"scripts/add_application_status.php":{"content":"<?php\n/**\n * Add status column to applications table\n */\n\nrequire_once __DIR__ . '/../config/database.php';\n\ntry {\n    $db = getDB();\n    \n    echo \"Adding status column to applications table...\\n\";\n    \n    $sql = \"ALTER TABLE applications ADD COLUMN status VARCHAR(50) DEFAULT 'pending'\";\n    \n    try {\n        $db->exec($sql);\n        echo \"✓ Status column added successfully!\\n\";\n    } catch (PDOException $e) {\n        if (strpos($e->getMessage(), 'Duplicate column') !== false) {\n            echo \"Status column already exists.\\n\";\n        } else {\n            throw $e;\n        }\n    }\n    \n    echo \"\\n✓ Migration completed!\\n\";\n    \n} catch (Exception $e) {\n    die(\"Error: \" . $e->getMessage() . \"\\n\");\n}\n","path":null,"size_bytes":720,"size_tokens":null},"app/controllers/NotificationController.php":{"content":"<?php\nrequire_once __DIR__ . '/../models/Notification.php';\nrequire_once __DIR__ . '/../../includes/functions.php';\nrequire_once __DIR__ . '/../../includes/csrf.php';\n\nclass NotificationController {\n    private $notificationModel;\n    \n    public function __construct() {\n        $this->notificationModel = new Notification();\n    }\n    \n    public function index() {\n        $user = getCurrentUser();\n        if (!$user) {\n            redirect('/login');\n        }\n        \n        $notifications = $this->notificationModel->getByUserId($user['id']);\n        $unreadCount = $this->notificationModel->getUnreadCount($user['id']);\n        \n        $meta = generateMetaTags('Notifications', 'View your notifications');\n        require __DIR__ . '/../views/notifications/index.php';\n    }\n    \n    public function getUnreadCount() {\n        header('Content-Type: application/json');\n        \n        $user = getCurrentUser();\n        if (!$user) {\n            echo json_encode(['error' => 'Unauthorized']);\n            return;\n        }\n        \n        $count = $this->notificationModel->getUnreadCount($user['id']);\n        echo json_encode(['count' => (int)$count]);\n    }\n    \n    public function getRecent() {\n        header('Content-Type: application/json');\n        \n        $user = getCurrentUser();\n        if (!$user) {\n            echo json_encode(['error' => 'Unauthorized']);\n            return;\n        }\n        \n        $notifications = $this->notificationModel->getByUserId($user['id'], 5);\n        $unreadCount = $this->notificationModel->getUnreadCount($user['id']);\n        \n        echo json_encode([\n            'notifications' => $notifications,\n            'unread_count' => (int)$unreadCount\n        ]);\n    }\n    \n    public function poll() {\n        header('Content-Type: application/json');\n        \n        $user = getCurrentUser();\n        if (!$user) {\n            echo json_encode(['error' => 'Unauthorized']);\n            return;\n        }\n        \n        $since = $_GET['since'] ?? date('Y-m-d H:i:s', strtotime('-5 minutes'));\n        $notifications = $this->notificationModel->getUnreadSince($user['id'], $since);\n        $unreadCount = $this->notificationModel->getUnreadCount($user['id']);\n        \n        echo json_encode([\n            'notifications' => $notifications,\n            'unread_count' => (int)$unreadCount,\n            'timestamp' => date('Y-m-d H:i:s')\n        ]);\n    }\n    \n    public function markAsRead($id) {\n        header('Content-Type: application/json');\n        \n        $user = getCurrentUser();\n        if (!$user) {\n            echo json_encode(['error' => 'Unauthorized']);\n            return;\n        }\n        \n        $success = $this->notificationModel->markAsRead($id, $user['id']);\n        echo json_encode(['success' => $success]);\n    }\n    \n    public function markAllAsRead() {\n        header('Content-Type: application/json');\n        \n        $user = getCurrentUser();\n        if (!$user) {\n            echo json_encode(['error' => 'Unauthorized']);\n            return;\n        }\n        \n        $success = $this->notificationModel->markAllAsRead($user['id']);\n        echo json_encode(['success' => $success]);\n    }\n    \n    public function delete($id) {\n        $user = getCurrentUser();\n        if (!$user) {\n            redirect('/login');\n        }\n        \n        $this->notificationModel->delete($id, $user['id']);\n        \n        if (isset($_SERVER['HTTP_X_REQUESTED_WITH']) && $_SERVER['HTTP_X_REQUESTED_WITH'] === 'XMLHttpRequest') {\n            header('Content-Type: application/json');\n            echo json_encode(['success' => true]);\n        } else {\n            setFlash('success', 'Notification deleted');\n            redirect('/notifications');\n        }\n    }\n}\n","path":null,"size_bytes":3763,"size_tokens":null},"app/views/admin/reports.php":{"content":"<?php\nrequire __DIR__ . '/../common/header.php';\n\n$pendingCount = $statusCounts['pending'] ?? 0;\n$reviewedCount = $statusCounts['reviewed'] ?? 0;\n$resolvedCount = $statusCounts['resolved'] ?? 0;\n$dismissedCount = $statusCounts['dismissed'] ?? 0;\n$currentStatus = $_GET['status'] ?? '';\n?>\n\n<div class=\"container\">\n    <h1 class=\"mb-4\"><i class=\"fas fa-flag\"></i> Reports Management</h1>\n    \n    <?php if ($success = getFlash('success')): ?>\n        <div class=\"alert alert-success\"><?= $success ?></div>\n    <?php endif; ?>\n    \n    <?php if ($error = getFlash('error')): ?>\n        <div class=\"alert alert-danger\"><?= $error ?></div>\n    <?php endif; ?>\n    \n    <div class=\"row mb-4\">\n        <div class=\"col-md-3\">\n            <div class=\"card text-white bg-warning\">\n                <div class=\"card-body text-center\">\n                    <h3><?= $pendingCount ?></h3>\n                    <p class=\"mb-0\">Pending</p>\n                </div>\n            </div>\n        </div>\n        <div class=\"col-md-3\">\n            <div class=\"card text-white bg-info\">\n                <div class=\"card-body text-center\">\n                    <h3><?= $reviewedCount ?></h3>\n                    <p class=\"mb-0\">Reviewed</p>\n                </div>\n            </div>\n        </div>\n        <div class=\"col-md-3\">\n            <div class=\"card text-white bg-success\">\n                <div class=\"card-body text-center\">\n                    <h3><?= $resolvedCount ?></h3>\n                    <p class=\"mb-0\">Resolved</p>\n                </div>\n            </div>\n        </div>\n        <div class=\"col-md-3\">\n            <div class=\"card text-white bg-secondary\">\n                <div class=\"card-body text-center\">\n                    <h3><?= $dismissedCount ?></h3>\n                    <p class=\"mb-0\">Dismissed</p>\n                </div>\n            </div>\n        </div>\n    </div>\n    \n    <div class=\"card\">\n        <div class=\"card-header d-flex justify-content-between align-items-center\">\n            <h5 class=\"mb-0\"><i class=\"fas fa-list\"></i> All Reports</h5>\n            <div class=\"btn-group\">\n                <a href=\"/admin/reports\" class=\"btn btn-sm <?= empty($currentStatus) ? 'btn-primary' : 'btn-outline-primary' ?>\">All</a>\n                <a href=\"/admin/reports?status=pending\" class=\"btn btn-sm <?= $currentStatus === 'pending' ? 'btn-warning' : 'btn-outline-warning' ?>\">Pending</a>\n                <a href=\"/admin/reports?status=reviewed\" class=\"btn btn-sm <?= $currentStatus === 'reviewed' ? 'btn-info' : 'btn-outline-info' ?>\">Reviewed</a>\n                <a href=\"/admin/reports?status=resolved\" class=\"btn btn-sm <?= $currentStatus === 'resolved' ? 'btn-success' : 'btn-outline-success' ?>\">Resolved</a>\n                <a href=\"/admin/reports?status=dismissed\" class=\"btn btn-sm <?= $currentStatus === 'dismissed' ? 'btn-secondary' : 'btn-outline-secondary' ?>\">Dismissed</a>\n            </div>\n        </div>\n        <div class=\"card-body\">\n            <?php if (empty($reports)): ?>\n                <p class=\"text-muted text-center py-4\">No reports found.</p>\n            <?php else: ?>\n                <div class=\"table-responsive\">\n                    <table class=\"table table-hover\">\n                        <thead>\n                            <tr>\n                                <th>ID</th>\n                                <th>Type</th>\n                                <th>Reporter</th>\n                                <th>Message</th>\n                                <th>Status</th>\n                                <th>Date</th>\n                                <th>Actions</th>\n                            </tr>\n                        </thead>\n                        <tbody>\n                            <?php foreach ($reports as $report): ?>\n                                <tr>\n                                    <td>#<?= $report['id'] ?></td>\n                                    <td>\n                                        <?php if ($report['reported_type'] === 'job'): ?>\n                                            <span class=\"badge bg-primary\"><i class=\"fas fa-briefcase\"></i> Job</span>\n                                        <?php else: ?>\n                                            <span class=\"badge bg-secondary\"><i class=\"fas fa-user\"></i> User</span>\n                                        <?php endif; ?>\n                                    </td>\n                                    <td><?= htmlspecialchars($report['reporter_name']) ?></td>\n                                    <td><?= htmlspecialchars(substr($report['message'], 0, 50)) ?>...</td>\n                                    <td>\n                                        <?php\n                                        $statusClass = match($report['status']) {\n                                            'pending' => 'bg-warning',\n                                            'reviewed' => 'bg-info',\n                                            'resolved' => 'bg-success',\n                                            'dismissed' => 'bg-secondary',\n                                            default => 'bg-secondary'\n                                        };\n                                        ?>\n                                        <span class=\"badge <?= $statusClass ?>\"><?= ucfirst($report['status']) ?></span>\n                                    </td>\n                                    <td><?= date('M d, Y', strtotime($report['created_at'])) ?></td>\n                                    <td>\n                                        <a href=\"/admin/reports/<?= $report['id'] ?>\" class=\"btn btn-sm btn-primary\">\n                                            <i class=\"fas fa-eye\"></i> View\n                                        </a>\n                                    </td>\n                                </tr>\n                            <?php endforeach; ?>\n                        </tbody>\n                    </table>\n                </div>\n            <?php endif; ?>\n        </div>\n    </div>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":6079,"size_tokens":null},"app/controllers/ChatController.php":{"content":"<?php\nrequire_once __DIR__ . '/../models/Conversation.php';\nrequire_once __DIR__ . '/../models/Message.php';\nrequire_once __DIR__ . '/../models/Notification.php';\nrequire_once __DIR__ . '/../../includes/functions.php';\nrequire_once __DIR__ . '/../../includes/csrf.php';\n\nclass ChatController {\n    private $conversationModel;\n    private $messageModel;\n    private $notificationModel;\n    \n    public function __construct() {\n        $this->conversationModel = new Conversation();\n        $this->messageModel = new Message();\n        $this->notificationModel = new Notification();\n    }\n    \n    public function index() {\n        $user = getCurrentUser();\n        if (!$user) {\n            redirect('/login');\n        }\n        \n        $conversations = $this->conversationModel->getByUserId($user['id'], $user['type']);\n        $totalUnread = $this->conversationModel->getTotalUnreadCount($user['id']);\n        \n        $meta = generateMetaTags('Messages', 'Your conversations');\n        require __DIR__ . '/../views/chat/index.php';\n    }\n    \n    public function conversation($id) {\n        $user = getCurrentUser();\n        if (!$user) {\n            redirect('/login');\n        }\n        \n        if (!$this->conversationModel->canAccess($id, $user['id'])) {\n            setFlash('error', 'You do not have access to this conversation');\n            redirect('/chat');\n        }\n        \n        $conversation = $this->conversationModel->findById($id);\n        $messages = $this->messageModel->getByConversationId($id);\n        \n        if ($user['type'] === 'jobseeker' && empty($messages)) {\n            setFlash('error', 'This conversation is not available yet. Please wait for the employer to contact you.');\n            redirect('/chat');\n        }\n        \n        $conversations = $this->conversationModel->getByUserId($user['id'], $user['type']);\n        \n        $this->messageModel->markAsRead($id, $user['id']);\n        \n        $otherPartyName = $user['type'] === 'employer' ? $conversation['candidate_name'] : $conversation['employer_name'];\n        $currentUser = $user;\n        \n        $meta = generateMetaTags('Chat with ' . $otherPartyName, 'Conversation about ' . $conversation['job_title']);\n        require __DIR__ . '/../views/chat/conversation.php';\n    }\n    \n    public function sendMessage($conversationId) {\n        header('Content-Type: application/json');\n        \n        $user = getCurrentUser();\n        if (!$user) {\n            echo json_encode(['error' => 'Unauthorized']);\n            return;\n        }\n        \n        $csrfToken = $_POST['csrf_token'] ?? '';\n        if (!verifyCSRFToken($csrfToken)) {\n            echo json_encode(['error' => 'Invalid security token. Please refresh the page.']);\n            return;\n        }\n        \n        if (!$this->conversationModel->canAccess($conversationId, $user['id'])) {\n            echo json_encode(['error' => 'Access denied']);\n            return;\n        }\n        \n        $message = trim($_POST['message'] ?? '');\n        $hasAttachment = !empty($_FILES['attachment']) && $_FILES['attachment']['error'] === UPLOAD_ERR_OK;\n        \n        if (empty($message) && !$hasAttachment) {\n            echo json_encode(['error' => 'Please enter a message or attach a file']);\n            return;\n        }\n        \n        $existingMessages = $this->messageModel->getByConversationId($conversationId, 1);\n        if (empty($existingMessages) && $user['type'] !== 'employer') {\n            echo json_encode(['error' => 'Only employers can send the first message. Please wait for the employer to contact you.']);\n            return;\n        }\n        \n        $attachmentData = [];\n        if ($hasAttachment) {\n            $uploadResult = $this->handleAttachmentUpload($_FILES['attachment']);\n            if ($uploadResult['error']) {\n                echo json_encode(['error' => $uploadResult['error']]);\n                return;\n            }\n            $attachmentData = $uploadResult;\n        }\n        \n        $messageData = [\n            'conversation_id' => $conversationId,\n            'sender_id' => $user['id'],\n            'message' => $message\n        ];\n        \n        if (!empty($attachmentData)) {\n            $messageData['attachment_path'] = $attachmentData['path'];\n            $messageData['attachment_name'] = $attachmentData['name'];\n            $messageData['attachment_type'] = $attachmentData['type'];\n        }\n        \n        $messageId = $this->messageModel->create($messageData);\n        \n        if ($messageId) {\n            $newMessage = $this->messageModel->findById($messageId);\n            echo json_encode([\n                'success' => true,\n                'message' => $newMessage\n            ]);\n        } else {\n            $errorMsg = 'Failed to send message';\n            if (!empty($attachmentData)) {\n                $errorMsg .= '. The attachment may have failed to save to the database.';\n            }\n            echo json_encode(['error' => $errorMsg]);\n        }\n    }\n    \n    private function handleAttachmentUpload($file) {\n        $allowedTypes = [\n            'image/jpeg' => ['jpg', 'jpeg'],\n            'image/png' => ['png'],\n            'image/gif' => ['gif'],\n            'image/webp' => ['webp'],\n            'application/pdf' => ['pdf'],\n            'application/msword' => ['doc'],\n            'application/vnd.openxmlformats-officedocument.wordprocessingml.document' => ['docx'],\n            'application/vnd.ms-excel' => ['xls'],\n            'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' => ['xlsx'],\n            'text/plain' => ['txt'],\n            'application/zip' => ['zip']\n        ];\n        \n        $allowedExtensions = ['jpg', 'jpeg', 'png', 'gif', 'webp', 'pdf', 'doc', 'docx', 'xls', 'xlsx', 'txt', 'zip'];\n        \n        $maxSize = 10 * 1024 * 1024;\n        \n        if ($file['size'] > $maxSize) {\n            return ['error' => 'File size exceeds 10MB limit'];\n        }\n        \n        $fileExt = strtolower(pathinfo($file['name'], PATHINFO_EXTENSION));\n        if (!in_array($fileExt, $allowedExtensions)) {\n            return ['error' => 'File extension not allowed. Allowed: JPG, PNG, GIF, PDF, DOC, DOCX, XLS, XLSX, TXT, ZIP'];\n        }\n        \n        $mimeType = mime_content_type($file['tmp_name']);\n        if (!isset($allowedTypes[$mimeType])) {\n            return ['error' => 'File type not allowed. Allowed: images, PDF, DOC, DOCX, XLS, XLSX, TXT, ZIP'];\n        }\n        \n        if (!in_array($fileExt, $allowedTypes[$mimeType])) {\n            return ['error' => 'File extension does not match file content'];\n        }\n        \n        $originalName = pathinfo($file['name'], PATHINFO_FILENAME);\n        $safeOriginalName = preg_replace('/[^a-zA-Z0-9_-]/', '_', $originalName);\n        $newFileName = $safeOriginalName . '_' . uniqid() . '.' . $fileExt;\n        \n        $uploadDir = __DIR__ . '/../../public/uploads/chat_attachments/';\n        if (!is_dir($uploadDir)) {\n            mkdir($uploadDir, 0755, true);\n        }\n        \n        $targetPath = $uploadDir . $newFileName;\n        \n        if (move_uploaded_file($file['tmp_name'], $targetPath)) {\n            return [\n                'path' => '/uploads/chat_attachments/' . $newFileName,\n                'name' => $file['name'],\n                'type' => $mimeType,\n                'error' => null\n            ];\n        }\n        \n        return ['error' => 'Failed to upload file'];\n    }\n    \n    public function getMessages($conversationId) {\n        header('Content-Type: application/json');\n        \n        $user = getCurrentUser();\n        if (!$user) {\n            echo json_encode(['error' => 'Unauthorized']);\n            return;\n        }\n        \n        if (!$this->conversationModel->canAccess($conversationId, $user['id'])) {\n            echo json_encode(['error' => 'Access denied']);\n            return;\n        }\n        \n        $messages = $this->messageModel->getByConversationId($conversationId);\n        \n        if ($user['type'] === 'jobseeker' && empty($messages)) {\n            echo json_encode([\n                'success' => true,\n                'messages' => []\n            ]);\n            return;\n        }\n        \n        $lastMessageId = $_GET['last_id'] ?? 0;\n        \n        if ($lastMessageId > 0) {\n            $messages = $this->messageModel->getNewMessages($conversationId, $lastMessageId);\n        }\n        \n        $this->messageModel->markAsRead($conversationId, $user['id']);\n        \n        echo json_encode([\n            'success' => true,\n            'messages' => $messages\n        ]);\n    }\n    \n    public function getUnreadCount() {\n        header('Content-Type: application/json');\n        \n        $user = getCurrentUser();\n        if (!$user) {\n            echo json_encode(['error' => 'Unauthorized']);\n            return;\n        }\n        \n        $count = $this->conversationModel->getTotalUnreadCount($user['id']);\n        echo json_encode(['count' => (int)$count]);\n    }\n    \n    public function startConversation($candidateId) {\n        $user = getCurrentUser();\n        if (!$user) {\n            redirect('/login');\n        }\n        \n        if ($user['type'] !== 'employer') {\n            setFlash('error', 'Only employers can start conversations');\n            redirect('/chat');\n        }\n        \n        $jobId = $_GET['job_id'] ?? null;\n        if (!$jobId) {\n            setFlash('error', 'Job ID is required');\n            redirect('/chat');\n        }\n        \n        $conversation = $this->conversationModel->findByParticipants($user['id'], $candidateId, $jobId);\n        \n        if ($conversation) {\n            redirect('/chat/' . $conversation['id']);\n        } else {\n            setFlash('error', 'No conversation found for this candidate. Please select them first.');\n            redirect('/employer/jobs/' . $jobId . '/applications');\n        }\n    }\n}\n","path":null,"size_bytes":9912,"size_tokens":null},"app/models/Conversation.php":{"content":"<?php\nrequire_once __DIR__ . '/../../config/database.php';\n\nclass Conversation {\n    private $db;\n    \n    public function __construct() {\n        $this->db = getDB();\n    }\n    \n    public function create($data) {\n        $sql = \"INSERT INTO conversations (employer_id, candidate_id, job_id, application_id, status) \n                VALUES (:employer_id, :candidate_id, :job_id, :application_id, :status)\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([\n            ':employer_id' => $data['employer_id'],\n            ':candidate_id' => $data['candidate_id'],\n            ':job_id' => $data['job_id'],\n            ':application_id' => $data['application_id'],\n            ':status' => $data['status'] ?? 'active'\n        ]);\n        return $this->db->lastInsertId();\n    }\n    \n    public function findById($id) {\n        $sql = \"SELECT c.*, \n                j.title as job_title,\n                emp.name as employer_name,\n                cand.name as candidate_name\n                FROM conversations c\n                JOIN jobs j ON c.job_id = j.id\n                JOIN users emp ON c.employer_id = emp.id\n                JOIN users cand ON c.candidate_id = cand.id\n                WHERE c.id = :id\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':id' => $id]);\n        return $stmt->fetch();\n    }\n    \n    public function findByParticipants($employerId, $candidateId, $jobId) {\n        $sql = \"SELECT * FROM conversations \n                WHERE employer_id = :employer_id \n                AND candidate_id = :candidate_id \n                AND job_id = :job_id\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([\n            ':employer_id' => $employerId,\n            ':candidate_id' => $candidateId,\n            ':job_id' => $jobId\n        ]);\n        return $stmt->fetch();\n    }\n    \n    public function getByUserId($userId, $role) {\n        if ($role === 'employer') {\n            $sql = \"SELECT c.*, \n                    j.title as job_title,\n                    cand.name as other_party_name,\n                    cand.id as other_party_id,\n                    (SELECT COUNT(*) FROM conversation_messages cm \n                     WHERE cm.conversation_id = c.id AND cm.sender_id != :user_id1 AND cm.is_read = 0) as unread_count,\n                    (SELECT message FROM conversation_messages cm2 \n                     WHERE cm2.conversation_id = c.id \n                     ORDER BY cm2.created_at DESC LIMIT 1) as last_message,\n                    (SELECT created_at FROM conversation_messages cm3 \n                     WHERE cm3.conversation_id = c.id \n                     ORDER BY cm3.created_at DESC LIMIT 1) as last_message_time\n                    FROM conversations c\n                    JOIN jobs j ON c.job_id = j.id\n                    JOIN users cand ON c.candidate_id = cand.id\n                    WHERE c.employer_id = :user_id2 AND c.status = 'active'\n                    ORDER BY last_message_time DESC\";\n        } else {\n            $sql = \"SELECT c.*, \n                    j.title as job_title,\n                    emp.name as other_party_name,\n                    emp.id as other_party_id,\n                    (SELECT COUNT(*) FROM conversation_messages cm \n                     WHERE cm.conversation_id = c.id AND cm.sender_id != :user_id1 AND cm.is_read = 0) as unread_count,\n                    (SELECT message FROM conversation_messages cm2 \n                     WHERE cm2.conversation_id = c.id \n                     ORDER BY cm2.created_at DESC LIMIT 1) as last_message,\n                    (SELECT created_at FROM conversation_messages cm3 \n                     WHERE cm3.conversation_id = c.id \n                     ORDER BY cm3.created_at DESC LIMIT 1) as last_message_time,\n                    (SELECT COUNT(*) FROM conversation_messages cm4 \n                     WHERE cm4.conversation_id = c.id) as message_count\n                    FROM conversations c\n                    JOIN jobs j ON c.job_id = j.id\n                    JOIN users emp ON c.employer_id = emp.id\n                    WHERE c.candidate_id = :user_id2 AND c.status = 'active'\n                    HAVING message_count > 0\n                    ORDER BY last_message_time DESC\";\n        }\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':user_id1' => $userId, ':user_id2' => $userId]);\n        return $stmt->fetchAll();\n    }\n    \n    public function getTotalUnreadCount($userId) {\n        $sql = \"SELECT COUNT(*) as count FROM conversation_messages cm\n                JOIN conversations c ON cm.conversation_id = c.id\n                WHERE (c.employer_id = :user_id OR c.candidate_id = :user_id2)\n                AND cm.sender_id != :user_id3\n                AND cm.is_read = 0\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([\n            ':user_id' => $userId,\n            ':user_id2' => $userId,\n            ':user_id3' => $userId\n        ]);\n        $result = $stmt->fetch();\n        return $result['count'];\n    }\n    \n    public function canAccess($conversationId, $userId) {\n        $sql = \"SELECT id FROM conversations \n                WHERE id = :id AND (employer_id = :user_id OR candidate_id = :user_id2)\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([\n            ':id' => $conversationId,\n            ':user_id' => $userId,\n            ':user_id2' => $userId\n        ]);\n        return $stmt->fetch() !== false;\n    }\n    \n    public function close($id) {\n        $sql = \"UPDATE conversations SET status = 'closed' WHERE id = :id\";\n        $stmt = $this->db->prepare($sql);\n        return $stmt->execute([':id' => $id]);\n    }\n    \n    public function getSelectedCandidatesByEmployer($employerId) {\n        $sql = \"SELECT c.candidate_id, c.id as conversation_id, c.job_id, j.title as job_title\n                FROM conversations c\n                JOIN jobs j ON c.job_id = j.id\n                WHERE c.employer_id = :employer_id AND c.status = 'active'\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':employer_id' => $employerId]);\n        $results = $stmt->fetchAll();\n        \n        $selected = [];\n        foreach ($results as $row) {\n            $selected[$row['candidate_id']] = [\n                'conversation_id' => $row['conversation_id'],\n                'job_id' => $row['job_id'],\n                'job_title' => $row['job_title']\n            ];\n        }\n        return $selected;\n    }\n}\n","path":null,"size_bytes":6458,"size_tokens":null},"app/models/Message.php":{"content":"<?php\nrequire_once __DIR__ . '/../../config/database.php';\n\nclass Message {\n    private $db;\n    \n    public function __construct() {\n        $this->db = getDB();\n    }\n    \n    public function create($data) {\n        try {\n            $hasAttachment = !empty($data['attachment_path']);\n            \n            if ($hasAttachment) {\n                $sql = \"INSERT INTO conversation_messages (conversation_id, sender_id, message, attachment_path, attachment_name, attachment_type) \n                        VALUES (:conversation_id, :sender_id, :message, :attachment_path, :attachment_name, :attachment_type)\";\n                $stmt = $this->db->prepare($sql);\n                $stmt->execute([\n                    ':conversation_id' => $data['conversation_id'],\n                    ':sender_id' => $data['sender_id'],\n                    ':message' => $data['message'] ?? '',\n                    ':attachment_path' => $data['attachment_path'],\n                    ':attachment_name' => $data['attachment_name'],\n                    ':attachment_type' => $data['attachment_type']\n                ]);\n            } else {\n                $sql = \"INSERT INTO conversation_messages (conversation_id, sender_id, message) \n                        VALUES (:conversation_id, :sender_id, :message)\";\n                $stmt = $this->db->prepare($sql);\n                $stmt->execute([\n                    ':conversation_id' => $data['conversation_id'],\n                    ':sender_id' => $data['sender_id'],\n                    ':message' => $data['message']\n                ]);\n            }\n            return $this->db->lastInsertId();\n        } catch (PDOException $e) {\n            error_log(\"Message create error: \" . $e->getMessage());\n            return false;\n        }\n    }\n    \n    public function getByConversationId($conversationId, $limit = 50, $offset = 0) {\n        $sql = \"SELECT m.*, u.name as sender_name \n                FROM conversation_messages m\n                JOIN users u ON m.sender_id = u.id\n                WHERE m.conversation_id = :conversation_id\n                ORDER BY m.created_at ASC\n                LIMIT :limit OFFSET :offset\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->bindValue(':conversation_id', $conversationId, PDO::PARAM_INT);\n        $stmt->bindValue(':limit', $limit, PDO::PARAM_INT);\n        $stmt->bindValue(':offset', $offset, PDO::PARAM_INT);\n        $stmt->execute();\n        return $stmt->fetchAll();\n    }\n    \n    public function getNewMessages($conversationId, $lastMessageId) {\n        $sql = \"SELECT m.*, u.name as sender_name \n                FROM conversation_messages m\n                JOIN users u ON m.sender_id = u.id\n                WHERE m.conversation_id = :conversation_id AND m.id > :last_id\n                ORDER BY m.created_at ASC\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([\n            ':conversation_id' => $conversationId,\n            ':last_id' => $lastMessageId\n        ]);\n        return $stmt->fetchAll();\n    }\n    \n    public function markAsRead($conversationId, $userId) {\n        $sql = \"UPDATE conversation_messages \n                SET is_read = 1 \n                WHERE conversation_id = :conversation_id \n                AND sender_id != :user_id \n                AND is_read = 0\";\n        $stmt = $this->db->prepare($sql);\n        return $stmt->execute([\n            ':conversation_id' => $conversationId,\n            ':user_id' => $userId\n        ]);\n    }\n    \n    public function findById($id) {\n        $sql = \"SELECT m.*, u.name as sender_name \n                FROM conversation_messages m\n                JOIN users u ON m.sender_id = u.id\n                WHERE m.id = :id\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':id' => $id]);\n        return $stmt->fetch();\n    }\n}\n","path":null,"size_bytes":3822,"size_tokens":null},"app/models/Report.php":{"content":"<?php\nrequire_once __DIR__ . '/../../config/database.php';\n\nclass Report {\n    private $db;\n    \n    public function __construct() {\n        $this->db = getDB();\n    }\n    \n    public function create($data) {\n        $sql = \"INSERT INTO reports (reporter_id, reported_type, reported_id, message) \n                VALUES (:reporter_id, :reported_type, :reported_id, :message)\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([\n            ':reporter_id' => $data['reporter_id'],\n            ':reported_type' => $data['reported_type'],\n            ':reported_id' => $data['reported_id'],\n            ':message' => $data['message']\n        ]);\n        return $this->db->lastInsertId();\n    }\n    \n    public function findById($id) {\n        $sql = \"SELECT r.*, \n                u.name as reporter_name, u.email as reporter_email\n                FROM reports r\n                JOIN users u ON r.reporter_id = u.id\n                WHERE r.id = :id\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':id' => $id]);\n        return $stmt->fetch();\n    }\n    \n    public function getAll($status = null, $limit = 50, $offset = 0) {\n        $sql = \"SELECT r.*, \n                u.name as reporter_name, u.email as reporter_email\n                FROM reports r\n                JOIN users u ON r.reporter_id = u.id\";\n        \n        $params = [];\n        if ($status) {\n            $sql .= \" WHERE r.status = :status\";\n            $params[':status'] = $status;\n        }\n        \n        $sql .= \" ORDER BY r.created_at DESC LIMIT :limit OFFSET :offset\";\n        \n        $stmt = $this->db->prepare($sql);\n        foreach ($params as $key => $value) {\n            $stmt->bindValue($key, $value);\n        }\n        $stmt->bindValue(':limit', $limit, PDO::PARAM_INT);\n        $stmt->bindValue(':offset', $offset, PDO::PARAM_INT);\n        $stmt->execute();\n        return $stmt->fetchAll();\n    }\n    \n    public function getPendingCount() {\n        $sql = \"SELECT COUNT(*) as count FROM reports WHERE status = 'pending'\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute();\n        $result = $stmt->fetch();\n        return $result['count'];\n    }\n    \n    public function getCountByStatus() {\n        $sql = \"SELECT status, COUNT(*) as count FROM reports GROUP BY status\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute();\n        return $stmt->fetchAll(PDO::FETCH_KEY_PAIR);\n    }\n    \n    public function updateStatus($id, $status, $adminNotes = null) {\n        $sql = \"UPDATE reports SET status = :status, admin_notes = :notes WHERE id = :id\";\n        $stmt = $this->db->prepare($sql);\n        return $stmt->execute([\n            ':id' => $id,\n            ':status' => $status,\n            ':notes' => $adminNotes\n        ]);\n    }\n    \n    public function hasReported($reporterId, $reportedType, $reportedId) {\n        $sql = \"SELECT id FROM reports \n                WHERE reporter_id = :reporter_id \n                AND reported_type = :reported_type \n                AND reported_id = :reported_id\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([\n            ':reporter_id' => $reporterId,\n            ':reported_type' => $reportedType,\n            ':reported_id' => $reportedId\n        ]);\n        return $stmt->fetch() !== false;\n    }\n    \n    public function delete($id) {\n        $sql = \"DELETE FROM reports WHERE id = :id\";\n        $stmt = $this->db->prepare($sql);\n        return $stmt->execute([':id' => $id]);\n    }\n    \n    public function getReportedJobDetails($jobId) {\n        $sql = \"SELECT j.*, u.name as employer_name, u.email as employer_email\n                FROM jobs j\n                JOIN users u ON j.employer_id = u.id\n                WHERE j.id = :id\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':id' => $jobId]);\n        return $stmt->fetch();\n    }\n    \n    public function getReportedUserDetails($userId) {\n        $sql = \"SELECT id, name, email, type, status, created_at FROM users WHERE id = :id\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':id' => $userId]);\n        return $stmt->fetch();\n    }\n}\n","path":null,"size_bytes":4158,"size_tokens":null},"app/models/Notification.php":{"content":"<?php\nrequire_once __DIR__ . '/../../config/database.php';\n\nclass Notification {\n    private $db;\n    \n    public function __construct() {\n        $this->db = getDB();\n    }\n    \n    public function create($data) {\n        $sql = \"INSERT INTO notifications (recipient_id, actor_id, related_type, related_id, type, title, message) \n                VALUES (:recipient_id, :actor_id, :related_type, :related_id, :type, :title, :message)\";\n        $stmt = $this->db->prepare($sql);\n        return $stmt->execute([\n            ':recipient_id' => $data['recipient_id'],\n            ':actor_id' => $data['actor_id'] ?? null,\n            ':related_type' => $data['related_type'] ?? 'system',\n            ':related_id' => $data['related_id'] ?? null,\n            ':type' => $data['type'],\n            ':title' => $data['title'],\n            ':message' => $data['message']\n        ]);\n    }\n    \n    public function getByUserId($userId, $limit = 20, $offset = 0) {\n        $sql = \"SELECT n.*, u.name as actor_name \n                FROM notifications n\n                LEFT JOIN users u ON n.actor_id = u.id\n                WHERE n.recipient_id = :user_id\n                ORDER BY n.created_at DESC\n                LIMIT :limit OFFSET :offset\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->bindValue(':user_id', $userId, PDO::PARAM_INT);\n        $stmt->bindValue(':limit', $limit, PDO::PARAM_INT);\n        $stmt->bindValue(':offset', $offset, PDO::PARAM_INT);\n        $stmt->execute();\n        return $stmt->fetchAll();\n    }\n    \n    public function getUnreadCount($userId) {\n        $sql = \"SELECT COUNT(*) as count FROM notifications WHERE recipient_id = :user_id AND is_read = 0\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':user_id' => $userId]);\n        $result = $stmt->fetch();\n        return $result['count'];\n    }\n    \n    public function markAsRead($id, $userId) {\n        $sql = \"UPDATE notifications SET is_read = 1 WHERE id = :id AND recipient_id = :user_id\";\n        $stmt = $this->db->prepare($sql);\n        return $stmt->execute([':id' => $id, ':user_id' => $userId]);\n    }\n    \n    public function markAllAsRead($userId) {\n        $sql = \"UPDATE notifications SET is_read = 1 WHERE recipient_id = :user_id AND is_read = 0\";\n        $stmt = $this->db->prepare($sql);\n        return $stmt->execute([':user_id' => $userId]);\n    }\n    \n    public function delete($id, $userId) {\n        $sql = \"DELETE FROM notifications WHERE id = :id AND recipient_id = :user_id\";\n        $stmt = $this->db->prepare($sql);\n        return $stmt->execute([':id' => $id, ':user_id' => $userId]);\n    }\n    \n    public function getUnreadSince($userId, $since) {\n        $sql = \"SELECT n.*, u.name as actor_name \n                FROM notifications n\n                LEFT JOIN users u ON n.actor_id = u.id\n                WHERE n.recipient_id = :user_id AND n.created_at > :since\n                ORDER BY n.created_at DESC\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute([':user_id' => $userId, ':since' => $since]);\n        return $stmt->fetchAll();\n    }\n    \n    public function notifyJobSeekerSelected($candidateId, $employerId, $jobId, $applicationId, $jobTitle, $companyName) {\n        return $this->create([\n            'recipient_id' => $candidateId,\n            'actor_id' => $employerId,\n            'related_type' => 'application',\n            'related_id' => $applicationId,\n            'type' => 'job_selected',\n            'title' => 'Congratulations! You have been selected',\n            'message' => \"You have been selected for the position of $jobTitle at $companyName. You can now chat with the employer.\"\n        ]);\n    }\n    \n    public function notifyNewJob($candidateId, $jobId, $jobTitle, $companyName) {\n        return $this->create([\n            'recipient_id' => $candidateId,\n            'actor_id' => null,\n            'related_type' => 'job',\n            'related_id' => $jobId,\n            'type' => 'new_job',\n            'title' => 'New Job Posted',\n            'message' => \"A new job has been posted: $jobTitle at $companyName\"\n        ]);\n    }\n    \n    public function notifySystemUpdate($userId, $title, $message) {\n        return $this->create([\n            'recipient_id' => $userId,\n            'actor_id' => null,\n            'related_type' => 'system',\n            'related_id' => null,\n            'type' => 'system',\n            'title' => $title,\n            'message' => $message\n        ]);\n    }\n    \n    public function notifyNewChatMessage($recipientId, $senderId, $conversationId, $senderName) {\n        return $this->create([\n            'recipient_id' => $recipientId,\n            'actor_id' => $senderId,\n            'related_type' => 'application',\n            'related_id' => $conversationId,\n            'type' => 'chat_message',\n            'title' => 'New Message',\n            'message' => \"You have a new message from $senderName\"\n        ]);\n    }\n    \n    public function getJobSeekersByRole() {\n        $sql = \"SELECT id FROM users WHERE type = 'jobseeker'\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute();\n        return $stmt->fetchAll(PDO::FETCH_COLUMN);\n    }\n    \n    public function getEmployersByRole() {\n        $sql = \"SELECT id FROM users WHERE type = 'employer'\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->execute();\n        return $stmt->fetchAll(PDO::FETCH_COLUMN);\n    }\n    \n    public function getSystemNotifications($limit = 50) {\n        $sql = \"SELECT title, message, type, MIN(created_at) as created_at, COUNT(*) as recipient_count\n                FROM notifications \n                WHERE type = 'system' AND related_type = 'system'\n                GROUP BY title, message, type\n                ORDER BY MIN(created_at) DESC\n                LIMIT :limit\";\n        $stmt = $this->db->prepare($sql);\n        $stmt->bindValue(':limit', $limit, PDO::PARAM_INT);\n        $stmt->execute();\n        return $stmt->fetchAll();\n    }\n    \n    public function deleteSystemNotificationsByContent($title, $message) {\n        $sql = \"DELETE FROM notifications WHERE type = 'system' AND related_type = 'system' AND title = :title AND message = :message\";\n        $stmt = $this->db->prepare($sql);\n        return $stmt->execute([':title' => $title, ':message' => $message]);\n    }\n}\n","path":null,"size_bytes":6328,"size_tokens":null},"app/controllers/ReportController.php":{"content":"<?php\nrequire_once __DIR__ . '/../models/Report.php';\nrequire_once __DIR__ . '/../../includes/functions.php';\nrequire_once __DIR__ . '/../../includes/csrf.php';\n\nclass ReportController {\n    private $reportModel;\n    \n    public function __construct() {\n        $this->reportModel = new Report();\n    }\n    \n    public function submitReport() {\n        header('Content-Type: application/json');\n        \n        $user = getCurrentUser();\n        if (!$user) {\n            echo json_encode(['error' => 'You must be logged in to report']);\n            return;\n        }\n        \n        $csrfToken = $_POST['csrf_token'] ?? '';\n        if (!verifyCSRFToken($csrfToken)) {\n            echo json_encode(['error' => 'Security token expired. Please refresh the page and try again.']);\n            return;\n        }\n        \n        if ($user['status'] !== 'active') {\n            echo json_encode(['error' => 'Your account must be verified to report']);\n            return;\n        }\n        \n        $reportedType = sanitize($_POST['reported_type'] ?? '');\n        $reportedId = (int)($_POST['reported_id'] ?? 0);\n        $message = sanitize($_POST['message'] ?? '');\n        \n        if (!in_array($reportedType, ['job', 'user'])) {\n            echo json_encode(['error' => 'Invalid report type']);\n            return;\n        }\n        \n        if ($reportedId <= 0) {\n            echo json_encode(['error' => 'Invalid item to report']);\n            return;\n        }\n        \n        if (empty($message) || strlen($message) < 10) {\n            echo json_encode(['error' => 'Please provide a detailed reason (at least 10 characters)']);\n            return;\n        }\n        \n        if ($this->reportModel->hasReported($user['id'], $reportedType, $reportedId)) {\n            echo json_encode(['error' => 'You have already reported this item']);\n            return;\n        }\n        \n        $reportId = $this->reportModel->create([\n            'reporter_id' => $user['id'],\n            'reported_type' => $reportedType,\n            'reported_id' => $reportedId,\n            'message' => $message\n        ]);\n        \n        if ($reportId) {\n            echo json_encode(['success' => true, 'message' => 'Report submitted successfully. Admin will review it.']);\n        } else {\n            echo json_encode(['error' => 'Failed to submit report. Please try again.']);\n        }\n    }\n}\n","path":null,"size_bytes":2385,"size_tokens":null},"app/views/admin/view_report.php":{"content":"<?php\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container\">\n    <div class=\"d-flex justify-content-between align-items-center mb-4\">\n        <h1><i class=\"fas fa-flag\"></i> Report #<?= $report['id'] ?></h1>\n        <a href=\"/admin/reports\" class=\"btn btn-outline-secondary\">\n            <i class=\"fas fa-arrow-left\"></i> Back to Reports\n        </a>\n    </div>\n    \n    <?php if ($success = getFlash('success')): ?>\n        <div class=\"alert alert-success\"><?= $success ?></div>\n    <?php endif; ?>\n    \n    <?php if ($error = getFlash('error')): ?>\n        <div class=\"alert alert-danger\"><?= $error ?></div>\n    <?php endif; ?>\n    \n    <div class=\"row\">\n        <div class=\"col-md-6\">\n            <div class=\"card mb-4\">\n                <div class=\"card-header\">\n                    <h5 class=\"mb-0\"><i class=\"fas fa-info-circle\"></i> Report Details</h5>\n                </div>\n                <div class=\"card-body\">\n                    <table class=\"table table-borderless\">\n                        <tr>\n                            <th width=\"30%\">Type:</th>\n                            <td>\n                                <?php if ($report['reported_type'] === 'job'): ?>\n                                    <span class=\"badge bg-primary\"><i class=\"fas fa-briefcase\"></i> Job Report</span>\n                                <?php else: ?>\n                                    <span class=\"badge bg-secondary\"><i class=\"fas fa-user\"></i> User Report</span>\n                                <?php endif; ?>\n                            </td>\n                        </tr>\n                        <tr>\n                            <th>Reporter:</th>\n                            <td><?= htmlspecialchars($report['reporter_name']) ?> (<?= htmlspecialchars($report['reporter_email']) ?>)</td>\n                        </tr>\n                        <tr>\n                            <th>Status:</th>\n                            <td>\n                                <?php\n                                $statusClass = match($report['status']) {\n                                    'pending' => 'bg-warning',\n                                    'reviewed' => 'bg-info',\n                                    'resolved' => 'bg-success',\n                                    'dismissed' => 'bg-secondary',\n                                    default => 'bg-secondary'\n                                };\n                                ?>\n                                <span class=\"badge <?= $statusClass ?>\"><?= ucfirst($report['status']) ?></span>\n                            </td>\n                        </tr>\n                        <tr>\n                            <th>Reported On:</th>\n                            <td><?= date('F d, Y h:i A', strtotime($report['created_at'])) ?></td>\n                        </tr>\n                    </table>\n                    \n                    <h6 class=\"mt-3\">Report Message:</h6>\n                    <div class=\"bg-light p-3 rounded\">\n                        <?= nl2br(htmlspecialchars($report['message'])) ?>\n                    </div>\n                    \n                    <?php if ($report['admin_notes']): ?>\n                        <h6 class=\"mt-3\">Admin Notes:</h6>\n                        <div class=\"bg-info bg-opacity-10 p-3 rounded\">\n                            <?= nl2br(htmlspecialchars($report['admin_notes'])) ?>\n                        </div>\n                    <?php endif; ?>\n                </div>\n            </div>\n            \n            <div class=\"card\">\n                <div class=\"card-header\">\n                    <h5 class=\"mb-0\"><i class=\"fas fa-cog\"></i> Update Status</h5>\n                </div>\n                <div class=\"card-body\">\n                    <form action=\"/admin/reports/<?= $report['id'] ?>/update\" method=\"POST\">\n                        <input type=\"hidden\" name=\"csrf_token\" value=\"<?= getCSRFToken() ?>\">\n                        \n                        <div class=\"mb-3\">\n                            <label for=\"status\" class=\"form-label\">Status</label>\n                            <select class=\"form-select\" id=\"status\" name=\"status\" required>\n                                <option value=\"pending\" <?= $report['status'] === 'pending' ? 'selected' : '' ?>>Pending</option>\n                                <option value=\"reviewed\" <?= $report['status'] === 'reviewed' ? 'selected' : '' ?>>Reviewed</option>\n                                <option value=\"resolved\" <?= $report['status'] === 'resolved' ? 'selected' : '' ?>>Resolved</option>\n                                <option value=\"dismissed\" <?= $report['status'] === 'dismissed' ? 'selected' : '' ?>>Dismissed</option>\n                            </select>\n                        </div>\n                        \n                        <div class=\"mb-3\">\n                            <label for=\"admin_notes\" class=\"form-label\">Admin Notes</label>\n                            <textarea class=\"form-control\" id=\"admin_notes\" name=\"admin_notes\" rows=\"3\"><?= htmlspecialchars($report['admin_notes'] ?? '') ?></textarea>\n                        </div>\n                        \n                        <button type=\"submit\" class=\"btn btn-primary\">\n                            <i class=\"fas fa-save\"></i> Update Status\n                        </button>\n                    </form>\n                </div>\n            </div>\n        </div>\n        \n        <div class=\"col-md-6\">\n            <div class=\"card\">\n                <div class=\"card-header\">\n                    <h5 class=\"mb-0\">\n                        <?php if ($report['reported_type'] === 'job'): ?>\n                            <i class=\"fas fa-briefcase\"></i> Reported Job\n                        <?php else: ?>\n                            <i class=\"fas fa-user\"></i> Reported User\n                        <?php endif; ?>\n                    </h5>\n                </div>\n                <div class=\"card-body\">\n                    <?php if ($reportedItem): ?>\n                        <?php if ($report['reported_type'] === 'job'): ?>\n                            <table class=\"table table-borderless\">\n                                <tr>\n                                    <th width=\"30%\">Job Title:</th>\n                                    <td><?= htmlspecialchars($reportedItem['title']) ?></td>\n                                </tr>\n                                <tr>\n                                    <th>Employer:</th>\n                                    <td><?= htmlspecialchars($reportedItem['employer_name']) ?></td>\n                                </tr>\n                                <tr>\n                                    <th>Email:</th>\n                                    <td><?= htmlspecialchars($reportedItem['employer_email']) ?></td>\n                                </tr>\n                                <tr>\n                                    <th>Location:</th>\n                                    <td><?= htmlspecialchars($reportedItem['location'] ?? 'N/A') ?></td>\n                                </tr>\n                                <tr>\n                                    <th>Status:</th>\n                                    <td>\n                                        <?php\n                                        $jobStatusClass = match($reportedItem['status'] ?? '') {\n                                            'approved' => 'bg-success',\n                                            'pending' => 'bg-warning',\n                                            'rejected' => 'bg-danger',\n                                            default => 'bg-secondary'\n                                        };\n                                        ?>\n                                        <span class=\"badge <?= $jobStatusClass ?>\"><?= ucfirst($reportedItem['status'] ?? 'Unknown') ?></span>\n                                    </td>\n                                </tr>\n                            </table>\n                            <a href=\"/admin/jobs/<?= $reportedItem['id'] ?>\" class=\"btn btn-outline-primary\">\n                                <i class=\"fas fa-eye\"></i> View Job Details\n                            </a>\n                            <form action=\"/admin/jobs/<?= $reportedItem['id'] ?>/reject\" method=\"POST\" class=\"d-inline\">\n                                <input type=\"hidden\" name=\"csrf_token\" value=\"<?= getCSRFToken() ?>\">\n                                <button type=\"submit\" class=\"btn btn-danger\" onclick=\"return confirm('Reject this job?')\">\n                                    <i class=\"fas fa-ban\"></i> Reject Job\n                                </button>\n                            </form>\n                        <?php else: ?>\n                            <table class=\"table table-borderless\">\n                                <tr>\n                                    <th width=\"30%\">Name:</th>\n                                    <td><?= htmlspecialchars($reportedItem['name']) ?></td>\n                                </tr>\n                                <tr>\n                                    <th>Email:</th>\n                                    <td><?= htmlspecialchars($reportedItem['email']) ?></td>\n                                </tr>\n                                <tr>\n                                    <th>Type:</th>\n                                    <td><span class=\"badge bg-info\"><?= ucfirst($reportedItem['type']) ?></span></td>\n                                </tr>\n                                <tr>\n                                    <th>Status:</th>\n                                    <td>\n                                        <?php\n                                        $userStatusClass = $reportedItem['status'] === 'active' ? 'bg-success' : 'bg-danger';\n                                        ?>\n                                        <span class=\"badge <?= $userStatusClass ?>\"><?= ucfirst($reportedItem['status']) ?></span>\n                                    </td>\n                                </tr>\n                                <tr>\n                                    <th>Joined:</th>\n                                    <td><?= date('M d, Y', strtotime($reportedItem['created_at'])) ?></td>\n                                </tr>\n                            </table>\n                            <a href=\"/admin/users/<?= $reportedItem['id'] ?>\" class=\"btn btn-outline-primary\">\n                                <i class=\"fas fa-eye\"></i> View User Details\n                            </a>\n                        <?php endif; ?>\n                    <?php else: ?>\n                        <p class=\"text-muted\">The reported item has been deleted or is no longer available.</p>\n                    <?php endif; ?>\n                </div>\n            </div>\n            \n            <div class=\"card mt-4\">\n                <div class=\"card-header bg-danger text-white\">\n                    <h5 class=\"mb-0\"><i class=\"fas fa-trash\"></i> Delete Report</h5>\n                </div>\n                <div class=\"card-body\">\n                    <p class=\"text-muted\">Once deleted, this report cannot be recovered.</p>\n                    <form action=\"/admin/reports/<?= $report['id'] ?>/delete\" method=\"POST\">\n                        <input type=\"hidden\" name=\"csrf_token\" value=\"<?= getCSRFToken() ?>\">\n                        <button type=\"submit\" class=\"btn btn-danger\" onclick=\"return confirm('Are you sure you want to delete this report?')\">\n                            <i class=\"fas fa-trash\"></i> Delete Report\n                        </button>\n                    </form>\n                </div>\n            </div>\n        </div>\n    </div>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":11738,"size_tokens":null},"scripts/create_tables.php":{"content":"<?php\nrequire_once __DIR__ . '/../config/database.php';\n\necho \"Creating database tables...\\n\\n\";\n\n$db = getDB();\n\n$tables = [\n    'notifications' => \"\n        CREATE TABLE IF NOT EXISTS notifications (\n            id INT AUTO_INCREMENT PRIMARY KEY,\n            recipient_id INT NOT NULL,\n            actor_id INT NULL,\n            related_type ENUM('job', 'application', 'system') NOT NULL DEFAULT 'system',\n            related_id INT NULL,\n            type ENUM('job_selected', 'new_job', 'system', 'chat_message') NOT NULL,\n            title VARCHAR(255) NOT NULL,\n            message TEXT NOT NULL,\n            is_read TINYINT(1) NOT NULL DEFAULT 0,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n            INDEX idx_recipient_read (recipient_id, is_read),\n            INDEX idx_created (created_at)\n        ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n    \",\n    'conversations' => \"\n        CREATE TABLE IF NOT EXISTS conversations (\n            id INT AUTO_INCREMENT PRIMARY KEY,\n            employer_id INT NOT NULL,\n            candidate_id INT NOT NULL,\n            job_id INT NOT NULL,\n            application_id INT NOT NULL,\n            status ENUM('active', 'closed') NOT NULL DEFAULT 'active',\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n            updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n            UNIQUE KEY unique_conversation (employer_id, candidate_id, job_id),\n            INDEX idx_employer (employer_id),\n            INDEX idx_candidate (candidate_id)\n        ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n    \",\n    'conversation_messages' => \"\n        CREATE TABLE IF NOT EXISTS conversation_messages (\n            id INT AUTO_INCREMENT PRIMARY KEY,\n            conversation_id INT NOT NULL,\n            sender_id INT NOT NULL,\n            message TEXT NOT NULL,\n            is_read TINYINT(1) NOT NULL DEFAULT 0,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n            INDEX idx_conversation (conversation_id),\n            INDEX idx_sender (sender_id),\n            INDEX idx_created (created_at)\n        ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4\n    \",\n    'reports' => \"\n        CREATE TABLE IF NOT EXISTS reports (\n            id INT AUTO_INCREMENT PRIMARY KEY,\n            reporter_id INT NOT NULL,\n            reported_type ENUM('job', 'user') NOT NULL,\n            reported_id INT NOT NULL,\n            message TEXT NOT NULL,\n            status ENUM('pending', 'reviewed', 'resolved', 'dismissed') DEFAULT 'pending',\n            admin_notes TEXT,\n            created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n            updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,\n            INDEX idx_reported (reported_type, reported_id),\n            INDEX idx_status (status),\n            INDEX idx_created (created_at)\n        ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci\n    \"\n];\n\nforeach ($tables as $name => $sql) {\n    echo \"Creating table: $name\\n\";\n    try {\n        $db->exec($sql);\n        echo \"  ✓ $name created successfully\\n\";\n    } catch (PDOException $e) {\n        if (strpos($e->getMessage(), 'already exists') !== false) {\n            echo \"  ✓ $name already exists\\n\";\n        } else {\n            echo \"  ✗ Error: \" . $e->getMessage() . \"\\n\";\n        }\n    }\n}\n\necho \"\\nVerifying tables exist:\\n\";\nforeach (array_keys($tables) as $table) {\n    try {\n        $result = $db->query(\"SHOW TABLES LIKE '$table'\");\n        if ($result->rowCount() > 0) {\n            echo \"  ✓ $table exists\\n\";\n        } else {\n            echo \"  ✗ $table does NOT exist\\n\";\n        }\n    } catch (PDOException $e) {\n        echo \"  ✗ Error checking $table: \" . $e->getMessage() . \"\\n\";\n    }\n}\n\necho \"\\nDone!\\n\";\n","path":null,"size_bytes":3766,"size_tokens":null},"app/views/chat/conversation.php":{"content":"<?php\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<style>\n.chat-container {\n    display: flex;\n    height: calc(100vh - 200px);\n    min-height: 500px;\n}\n.chat-sidebar {\n    width: 300px;\n    border-right: 1px solid #dee2e6;\n    overflow-y: auto;\n}\n.chat-main {\n    flex: 1;\n    display: flex;\n    flex-direction: column;\n}\n.chat-header {\n    padding: 15px;\n    border-bottom: 1px solid #dee2e6;\n    background: #f8f9fa;\n}\n.chat-messages {\n    flex: 1;\n    overflow-y: auto;\n    padding: 15px;\n    background: #f0f2f5;\n}\n.chat-input {\n    padding: 15px;\n    border-top: 1px solid #dee2e6;\n    background: white;\n}\n.message {\n    max-width: 70%;\n    margin-bottom: 10px;\n    padding: 10px 15px;\n    border-radius: 15px;\n    position: relative;\n}\n.message-sent {\n    margin-left: auto;\n    background: #0d6efd;\n    color: white;\n    border-bottom-right-radius: 5px;\n}\n.message-received {\n    background: white;\n    border-bottom-left-radius: 5px;\n    box-shadow: 0 1px 2px rgba(0,0,0,0.1);\n}\n.message-time {\n    font-size: 0.7rem;\n    opacity: 0.7;\n    margin-top: 5px;\n}\n.message-sent .message-time {\n    text-align: right;\n}\n@media (max-width: 768px) {\n    .chat-sidebar {\n        display: none;\n    }\n    .chat-container {\n        height: calc(100vh - 150px);\n    }\n}\n.chat-input .input-group {\n    align-items: flex-end;\n}\n.chat-input .input-group textarea {\n    max-height: 150px;\n    min-height: 38px;\n}\n.chat-input .input-group .btn {\n    height: 38px;\n    flex-shrink: 0;\n}\n.chat-input .btn .spinner-border {\n    width: 1rem;\n    height: 1rem;\n    border-width: 2px;\n}\n.message-pending {\n    opacity: 0.7;\n}\n.message-error {\n    background: #f8d7da !important;\n    color: #842029 !important;\n}\n</style>\n\n<div class=\"container-fluid px-0\">\n    <div class=\"chat-container\">\n        <div class=\"chat-sidebar d-none d-md-block\">\n            <div class=\"p-3 border-bottom\">\n                <h6 class=\"mb-0\"><i class=\"fas fa-comments\"></i> Conversations</h6>\n            </div>\n            <div class=\"list-group list-group-flush\">\n                <?php foreach ($conversations as $conv): ?>\n                    <?php $isActive = $conv['id'] == $conversation['id']; ?>\n                    <a href=\"/chat/<?= $conv['id'] ?>\" class=\"list-group-item list-group-item-action <?= $isActive ? 'active' : '' ?>\">\n                        <div class=\"d-flex align-items-center\">\n                            <div class=\"me-2\">\n                                <div class=\"<?= $isActive ? 'bg-white text-primary' : 'bg-primary text-white' ?> rounded-circle d-flex align-items-center justify-content-center\" style=\"width: 35px; height: 35px;\">\n                                    <i class=\"fas fa-user\" style=\"font-size: 0.8rem;\"></i>\n                                </div>\n                            </div>\n                            <div class=\"flex-grow-1 overflow-hidden\">\n                                <div class=\"fw-bold text-truncate\" style=\"font-size: 0.9rem;\">\n                                    <?= htmlspecialchars($conv['other_party_name']) ?>\n                                </div>\n                                <small class=\"text-truncate d-block <?= $isActive ? 'text-white-50' : 'text-muted' ?>\">\n                                    <?= htmlspecialchars($conv['job_title']) ?>\n                                </small>\n                            </div>\n                            <?php if (($conv['unread_count'] ?? 0) > 0 && !$isActive): ?>\n                                <span class=\"badge bg-danger\"><?= $conv['unread_count'] ?></span>\n                            <?php endif; ?>\n                        </div>\n                    </a>\n                <?php endforeach; ?>\n            </div>\n        </div>\n        \n        <div class=\"chat-main\">\n            <div class=\"chat-header\">\n                <div class=\"d-flex align-items-center\">\n                    <a href=\"/chat\" class=\"btn btn-link text-dark d-md-none me-2\">\n                        <i class=\"fas fa-arrow-left\"></i>\n                    </a>\n                    <div class=\"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center me-3\" style=\"width: 40px; height: 40px;\">\n                        <i class=\"fas fa-user\"></i>\n                    </div>\n                    <div>\n                        <h6 class=\"mb-0\"><?= htmlspecialchars($otherPartyName) ?></h6>\n                        <small class=\"text-muted\">\n                            <i class=\"fas fa-briefcase\"></i> <?= htmlspecialchars($conversation['job_title']) ?>\n                        </small>\n                    </div>\n                </div>\n            </div>\n            \n            <div class=\"chat-messages\" id=\"chatMessages\">\n                <?php if (empty($messages)): ?>\n                    <div class=\"text-center text-muted py-5\" id=\"emptyState\">\n                        <i class=\"fas fa-comment-dots fa-3x mb-3\"></i>\n                        <?php if ($currentUser['type'] === 'employer'): ?>\n                            <p>No messages yet. Send your first message to start the conversation!</p>\n                        <?php else: ?>\n                            <p>No messages yet. The employer will send you a message soon.</p>\n                            <small class=\"text-info\"><i class=\"fas fa-info-circle\"></i> Employers send the first message in conversations</small>\n                        <?php endif; ?>\n                    </div>\n                <?php else: ?>\n                    <?php foreach ($messages as $message): ?>\n                        <?php $isSent = $message['sender_id'] == $currentUser['id']; ?>\n                        <div class=\"message <?= $isSent ? 'message-sent' : 'message-received' ?>\" data-message-id=\"<?= $message['id'] ?>\">\n                            <?php if (!empty($message['attachment_path'])): ?>\n                                <?php \n                                $isImage = strpos($message['attachment_type'] ?? '', 'image/') === 0;\n                                $attachName = htmlspecialchars($message['attachment_name'] ?? 'Attachment');\n                                ?>\n                                <div class=\"message-attachment mb-2\">\n                                    <?php if ($isImage): ?>\n                                        <a href=\"<?= htmlspecialchars($message['attachment_path']) ?>\" target=\"_blank\" class=\"d-block\">\n                                            <img src=\"<?= htmlspecialchars($message['attachment_path']) ?>\" alt=\"<?= $attachName ?>\" class=\"img-fluid rounded\" style=\"max-width: 200px; max-height: 200px;\">\n                                        </a>\n                                    <?php else: ?>\n                                        <a href=\"<?= htmlspecialchars($message['attachment_path']) ?>\" target=\"_blank\" class=\"btn btn-sm <?= $isSent ? 'btn-light' : 'btn-outline-primary' ?> d-flex align-items-center\" style=\"max-width: 200px;\">\n                                            <i class=\"fas fa-file-download me-2\"></i>\n                                            <span class=\"text-truncate\"><?= $attachName ?></span>\n                                        </a>\n                                    <?php endif; ?>\n                                </div>\n                            <?php endif; ?>\n                            <?php if (!empty($message['message'])): ?>\n                                <div><?= nl2br(htmlspecialchars($message['message'])) ?></div>\n                            <?php endif; ?>\n                            <div class=\"message-time\">\n                                <?= date('M j, g:i A', strtotime($message['created_at'])) ?>\n                                <?php if ($isSent && $message['is_read']): ?>\n                                    <i class=\"fas fa-check-double ms-1\"></i>\n                                <?php endif; ?>\n                            </div>\n                        </div>\n                    <?php endforeach; ?>\n                <?php endif; ?>\n            </div>\n            \n            <div class=\"chat-input\">\n                <?php $canSendFirstMessage = !empty($messages) || $currentUser['type'] === 'employer'; ?>\n                <?php if ($canSendFirstMessage): ?>\n                    <?php if ($currentUser['type'] === 'employer'): ?>\n                    <div class=\"mb-2\">\n                        <div class=\"dropdown\">\n                            <button class=\"btn btn-sm btn-outline-secondary dropdown-toggle\" type=\"button\" id=\"templateDropdown\" data-bs-toggle=\"dropdown\" aria-expanded=\"false\">\n                                <i class=\"fas fa-file-alt\"></i> Message Templates\n                            </button>\n                            <ul class=\"dropdown-menu dropdown-menu-end\" aria-labelledby=\"templateDropdown\" style=\"min-width: 300px;\">\n                                <li><h6 class=\"dropdown-header\">Quick Templates</h6></li>\n                                <li><a class=\"dropdown-item template-item\" href=\"#\" data-template=\"interview_invite\">\n                                    <i class=\"fas fa-calendar-check text-success\"></i> Interview Invitation\n                                </a></li>\n                                <li><a class=\"dropdown-item template-item\" href=\"#\" data-template=\"follow_up\">\n                                    <i class=\"fas fa-clock text-info\"></i> Follow Up\n                                </a></li>\n                                <li><a class=\"dropdown-item template-item\" href=\"#\" data-template=\"next_steps\">\n                                    <i class=\"fas fa-tasks text-primary\"></i> Next Steps\n                                </a></li>\n                                <li><a class=\"dropdown-item template-item\" href=\"#\" data-template=\"documents_request\">\n                                    <i class=\"fas fa-folder text-warning\"></i> Request Documents\n                                </a></li>\n                                <li><a class=\"dropdown-item template-item\" href=\"#\" data-template=\"welcome\">\n                                    <i class=\"fas fa-handshake text-secondary\"></i> Welcome Message\n                                </a></li>\n                            </ul>\n                        </div>\n                    </div>\n                    <?php endif; ?>\n                    <form id=\"messageForm\" class=\"no-loader\" onsubmit=\"sendMessage(event)\" enctype=\"multipart/form-data\">\n                        <input type=\"hidden\" id=\"csrfToken\" value=\"<?= getCSRFToken() ?>\">\n                        <div id=\"attachmentPreview\" class=\"mb-2\" style=\"display: none;\">\n                            <div class=\"d-flex align-items-center bg-light rounded p-2\">\n                                <i class=\"fas fa-paperclip me-2 text-primary\"></i>\n                                <span id=\"attachmentName\" class=\"text-truncate flex-grow-1\" style=\"max-width: 200px;\"></span>\n                                <button type=\"button\" class=\"btn btn-sm btn-outline-danger ms-2\" onclick=\"removeAttachment()\">\n                                    <i class=\"fas fa-times\"></i>\n                                </button>\n                            </div>\n                        </div>\n                        <div class=\"input-group\">\n                            <label class=\"btn btn-outline-secondary\" for=\"attachmentInput\" title=\"Attach file\">\n                                <i class=\"fas fa-paperclip\"></i>\n                            </label>\n                            <input type=\"file\" id=\"attachmentInput\" name=\"attachment\" class=\"d-none\" accept=\"image/*,.pdf,.doc,.docx,.xls,.xlsx,.txt,.zip\" onchange=\"handleAttachmentSelect(this)\">\n                            <textarea class=\"form-control\" id=\"messageInput\" placeholder=\"Type your message...\" autocomplete=\"off\" rows=\"1\" style=\"resize: none; overflow: hidden;\"></textarea>\n                            <button type=\"submit\" class=\"btn btn-primary\" id=\"sendBtn\">\n                                <i class=\"fas fa-paper-plane\"></i>\n                            </button>\n                        </div>\n                        <small class=\"text-muted mt-1 d-block\">Attach: Images, PDF, DOC, DOCX, XLS, XLSX, TXT, ZIP (max 10MB)</small>\n                    </form>\n                <?php else: ?>\n                    <div class=\"alert alert-info mb-0\" id=\"waitingMessage\">\n                        <i class=\"fas fa-info-circle\"></i> Please wait for the employer to send the first message before you can reply.\n                    </div>\n                <?php endif; ?>\n            </div>\n        </div>\n    </div>\n</div>\n\n<script>\nvar conversationId = <?= $conversation['id'] ?>;\nvar currentUserId = <?= $currentUser['id'] ?>;\nvar lastMessageId = <?= !empty($messages) ? end($messages)['id'] : 0 ?>;\nvar chatMessages = document.getElementById('chatMessages');\nvar messageInput = document.getElementById('messageInput');\nvar sendBtn = document.getElementById('sendBtn');\nvar jobTitle = <?= json_encode($conversation['job_title']) ?>;\nvar candidateName = <?= json_encode($otherPartyName) ?>;\n\nvar messageTemplates = {\n    'interview_invite': 'Hi ' + candidateName + ',\\n\\nThank you for applying for the ' + jobTitle + ' position. We were impressed by your profile and would like to invite you for an interview.\\n\\nPlease let us know your availability for the next few days, and we will schedule a convenient time.\\n\\nLooking forward to speaking with you!',\n    'follow_up': 'Hi ' + candidateName + ',\\n\\nI wanted to follow up regarding your application for the ' + jobTitle + ' position. We are still reviewing candidates and will update you shortly.\\n\\nIf you have any questions in the meantime, feel free to reach out.\\n\\nThank you for your patience!',\n    'next_steps': 'Hi ' + candidateName + ',\\n\\nThank you for the great conversation! Here are the next steps in our hiring process:\\n\\n1. [Step 1]\\n2. [Step 2]\\n3. [Step 3]\\n\\nPlease let me know if you have any questions.',\n    'documents_request': 'Hi ' + candidateName + ',\\n\\nAs we proceed with your application for the ' + jobTitle + ' role, we would need you to provide the following documents:\\n\\n- Updated resume\\n- Portfolio/work samples (if applicable)\\n- References\\n\\nPlease share these at your earliest convenience. Thank you!',\n    'welcome': 'Hi ' + candidateName + ',\\n\\nWelcome! Thank you for your interest in the ' + jobTitle + ' position at our company.\\n\\nI am excited to connect with you and discuss how your skills and experience align with this opportunity.\\n\\nFeel free to share more about yourself or ask any questions you might have.'\n};\n\ndocument.querySelectorAll('.template-item').forEach(function(item) {\n    item.addEventListener('click', function(e) {\n        e.preventDefault();\n        var templateKey = this.dataset.template;\n        if (messageTemplates[templateKey]) {\n            messageInput.value = messageTemplates[templateKey];\n            messageInput.style.height = 'auto';\n            messageInput.style.height = messageInput.scrollHeight + 'px';\n            messageInput.focus();\n        }\n    });\n});\n\nmessageInput.addEventListener('input', function() {\n    this.style.height = 'auto';\n    this.style.height = Math.min(this.scrollHeight, 150) + 'px';\n});\n\nfunction scrollToBottom() {\n    chatMessages.scrollTop = chatMessages.scrollHeight;\n}\n\nfunction formatTime(dateString) {\n    var date = new Date(dateString);\n    return date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }) + ', ' + \n           date.toLocaleTimeString('en-US', { hour: 'numeric', minute: '2-digit' });\n}\n\nfunction escapeHtml(text) {\n    var div = document.createElement('div');\n    div.textContent = text;\n    return div.innerHTML;\n}\n\nvar tempMessageId = 0;\nvar pendingMessages = {};\n\nfunction addMessage(message, isSent, isPending) {\n    var div = document.createElement('div');\n    div.className = 'message ' + (isSent ? 'message-sent' : 'message-received');\n    if (isPending) {\n        div.classList.add('message-pending');\n    }\n    div.dataset.messageId = message.id;\n    \n    if (message.attachment_path) {\n        var attachDiv = document.createElement('div');\n        attachDiv.className = 'message-attachment mb-2';\n        \n        var isImage = (message.attachment_type || '').indexOf('image/') === 0;\n        var attachName = escapeHtml(message.attachment_name || 'Attachment');\n        \n        if (isImage) {\n            attachDiv.innerHTML = '<a href=\"' + escapeHtml(message.attachment_path) + '\" target=\"_blank\" class=\"d-block\">' +\n                '<img src=\"' + escapeHtml(message.attachment_path) + '\" alt=\"' + attachName + '\" class=\"img-fluid rounded\" style=\"max-width: 200px; max-height: 200px;\">' +\n                '</a>';\n        } else {\n            var btnClass = isSent ? 'btn-light' : 'btn-outline-primary';\n            attachDiv.innerHTML = '<a href=\"' + escapeHtml(message.attachment_path) + '\" target=\"_blank\" class=\"btn btn-sm ' + btnClass + ' d-flex align-items-center\" style=\"max-width: 200px;\">' +\n                '<i class=\"fas fa-file-download me-2\"></i>' +\n                '<span class=\"text-truncate\">' + attachName + '</span>' +\n                '</a>';\n        }\n        div.appendChild(attachDiv);\n    }\n    \n    if (message.message) {\n        var content = document.createElement('div');\n        content.innerHTML = escapeHtml(message.message).replace(/\\n/g, '<br>');\n        div.appendChild(content);\n    }\n    \n    var time = document.createElement('div');\n    time.className = 'message-time';\n    time.textContent = formatTime(message.created_at);\n    if (isPending) {\n        time.innerHTML += ' <i class=\"fas fa-clock\" style=\"font-size: 0.6rem;\"></i>';\n    }\n    div.appendChild(time);\n    \n    var emptyState = chatMessages.querySelector('.text-center.text-muted');\n    if (emptyState) emptyState.remove();\n    \n    chatMessages.appendChild(div);\n    scrollToBottom();\n    \n    return div;\n}\n\nfunction confirmMessage(tempId, realMessage) {\n    var pendingEl = document.querySelector('[data-message-id=\"temp_' + tempId + '\"]');\n    if (pendingEl) {\n        pendingEl.dataset.messageId = realMessage.id;\n        pendingEl.classList.remove('message-pending');\n        var timeEl = pendingEl.querySelector('.message-time');\n        if (timeEl) {\n            timeEl.innerHTML = formatTime(realMessage.created_at);\n        }\n    }\n    delete pendingMessages[tempId];\n}\n\nfunction failMessage(tempId, errorMsg) {\n    var pendingEl = document.querySelector('[data-message-id=\"temp_' + tempId + '\"]');\n    if (pendingEl) {\n        pendingEl.classList.remove('message-pending');\n        pendingEl.classList.add('message-error');\n        var timeEl = pendingEl.querySelector('.message-time');\n        if (timeEl) {\n            timeEl.innerHTML = '<i class=\"fas fa-exclamation-circle text-danger\"></i> Failed to send';\n        }\n    }\n    delete pendingMessages[tempId];\n    if (errorMsg) {\n        alert(errorMsg);\n    }\n}\n\nvar attachmentInput = document.getElementById('attachmentInput');\nvar attachmentPreview = document.getElementById('attachmentPreview');\nvar attachmentNameEl = document.getElementById('attachmentName');\nvar selectedFile = null;\n\nfunction handleAttachmentSelect(input) {\n    if (input.files && input.files[0]) {\n        var file = input.files[0];\n        var maxSize = 10 * 1024 * 1024;\n        \n        if (file.size > maxSize) {\n            alert('File size exceeds 10MB limit');\n            input.value = '';\n            return;\n        }\n        \n        selectedFile = file;\n        attachmentNameEl.textContent = file.name;\n        attachmentPreview.style.display = 'block';\n    }\n}\n\nfunction removeAttachment() {\n    selectedFile = null;\n    attachmentInput.value = '';\n    attachmentPreview.style.display = 'none';\n    attachmentNameEl.textContent = '';\n}\n\nfunction sendMessage(e) {\n    e.preventDefault();\n    \n    var message = messageInput.value.trim();\n    var hasAttachment = selectedFile !== null;\n    \n    if (!message && !hasAttachment) return;\n    \n    tempMessageId++;\n    var currentTempId = tempMessageId;\n    \n    var tempMessage = {\n        id: 'temp_' + currentTempId,\n        message: message,\n        created_at: new Date().toISOString(),\n        sender_id: currentUserId,\n        attachment_name: hasAttachment ? selectedFile.name : null,\n        attachment_path: null,\n        attachment_type: hasAttachment ? selectedFile.type : null\n    };\n    \n    if (hasAttachment && selectedFile.type.indexOf('image/') === 0) {\n        tempMessage.attachment_path = URL.createObjectURL(selectedFile);\n    }\n    \n    pendingMessages[currentTempId] = message;\n    addMessage(tempMessage, true, true);\n    \n    var formData = new FormData();\n    formData.append('message', message);\n    formData.append('csrf_token', document.getElementById('csrfToken').value);\n    if (hasAttachment) {\n        formData.append('attachment', selectedFile);\n    }\n    \n    messageInput.value = '';\n    messageInput.style.height = '38px';\n    messageInput.focus();\n    removeAttachment();\n    \n    fetch('/chat/' + conversationId + '/send', {\n        method: 'POST',\n        body: formData\n    })\n    .then(function(response) { return response.json(); })\n    .then(function(data) {\n        if (data.success && data.message) {\n            confirmMessage(currentTempId, data.message);\n            lastMessageId = Math.max(lastMessageId, data.message.id);\n        } else if (data.error) {\n            failMessage(currentTempId, data.error);\n        }\n    })\n    .catch(function(err) {\n        console.error('Send error:', err);\n        failMessage(currentTempId, 'Failed to send message. Please try again.');\n    });\n}\n\nfunction pollMessages() {\n    fetch('/chat/' + conversationId + '/messages?last_id=' + lastMessageId)\n        .then(function(response) { return response.json(); })\n        .then(function(data) {\n            if (data.success && data.messages && data.messages.length > 0) {\n                data.messages.forEach(function(msg) {\n                    var existingMsg = document.querySelector('[data-message-id=\"' + msg.id + '\"]');\n                    if (!existingMsg && msg.sender_id != currentUserId) {\n                        addMessage(msg, false, false);\n                        lastMessageId = Math.max(lastMessageId, msg.id);\n                    } else if (!existingMsg && msg.sender_id == currentUserId) {\n                        lastMessageId = Math.max(lastMessageId, msg.id);\n                    }\n                });\n            }\n        })\n        .catch(function(err) {\n            console.log('Poll error:', err);\n        });\n}\n\nscrollToBottom();\nsetInterval(pollMessages, 3000);\nmessageInput.focus();\n</script>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":22687,"size_tokens":null},"app/views/chat/index.php":{"content":"<?php\nrequire __DIR__ . '/../common/header.php';\n?>\n\n<div class=\"container\">\n    <div class=\"d-flex justify-content-between align-items-center mb-4\">\n        <h1><i class=\"fas fa-comments\"></i> Messages</h1>\n        <?php if ($totalUnread > 0): ?>\n            <span class=\"badge bg-danger\"><?= $totalUnread ?> unread</span>\n        <?php endif; ?>\n    </div>\n    \n    <?php if ($success = getFlash('success')): ?>\n        <div class=\"alert alert-success\"><?= $success ?></div>\n    <?php endif; ?>\n    \n    <?php if ($error = getFlash('error')): ?>\n        <div class=\"alert alert-danger\"><?= $error ?></div>\n    <?php endif; ?>\n    \n    <?php if (empty($conversations)): ?>\n        <div class=\"card\">\n            <div class=\"card-body text-center py-5\">\n                <i class=\"fas fa-comment-slash fa-3x text-muted mb-3\"></i>\n                <h5 class=\"text-muted\">No conversations yet</h5>\n                <?php if ($currentUser['type'] === USER_TYPE_JOBSEEKER): ?>\n                    <p class=\"text-muted\">You'll be able to chat with employers after you get selected for a job.</p>\n                <?php else: ?>\n                    <p class=\"text-muted\">Select a candidate from your job applications to start a conversation.</p>\n                <?php endif; ?>\n            </div>\n        </div>\n    <?php else: ?>\n        <div class=\"list-group\">\n            <?php foreach ($conversations as $conversation): ?>\n                <?php\n                    $hasUnread = ($conversation['unread_count'] ?? 0) > 0;\n                    $bgClass = $hasUnread ? 'bg-light' : '';\n                ?>\n                <a href=\"/chat/<?= $conversation['id'] ?>\" class=\"list-group-item list-group-item-action <?= $bgClass ?>\">\n                    <div class=\"d-flex align-items-center\">\n                        <div class=\"me-3\">\n                            <div class=\"bg-primary text-white rounded-circle d-flex align-items-center justify-content-center\" style=\"width: 50px; height: 50px;\">\n                                <i class=\"fas fa-user\"></i>\n                            </div>\n                        </div>\n                        <div class=\"flex-grow-1\">\n                            <div class=\"d-flex justify-content-between align-items-start\">\n                                <div>\n                                    <h6 class=\"mb-1\">\n                                        <?= htmlspecialchars($conversation['other_party_name']) ?>\n                                        <?php if ($hasUnread): ?>\n                                            <span class=\"badge bg-danger ms-1\"><?= $conversation['unread_count'] ?></span>\n                                        <?php endif; ?>\n                                    </h6>\n                                    <p class=\"mb-1 text-muted small\">\n                                        <i class=\"fas fa-briefcase\"></i> <?= htmlspecialchars($conversation['job_title']) ?>\n                                    </p>\n                                    <?php if ($conversation['last_message']): ?>\n                                        <p class=\"mb-0 text-muted small text-truncate\" style=\"max-width: 300px;\">\n                                            <?= htmlspecialchars(substr($conversation['last_message'], 0, 50)) ?>...\n                                        </p>\n                                    <?php else: ?>\n                                        <p class=\"mb-0 text-muted small fst-italic\">No messages yet</p>\n                                    <?php endif; ?>\n                                </div>\n                                <div class=\"text-end\">\n                                    <?php if ($conversation['last_message_time']): ?>\n                                        <small class=\"text-muted\"><?= formatDate($conversation['last_message_time']) ?></small>\n                                    <?php endif; ?>\n                                </div>\n                            </div>\n                        </div>\n                        <div class=\"ms-2\">\n                            <i class=\"fas fa-chevron-right text-muted\"></i>\n                        </div>\n                    </div>\n                </a>\n            <?php endforeach; ?>\n        </div>\n    <?php endif; ?>\n</div>\n\n<?php require __DIR__ . '/../common/footer.php'; ?>\n","path":null,"size_bytes":4320,"size_tokens":null},"scripts/run_migrations.php":{"content":"<?php\nrequire_once __DIR__ . '/../config/database.php';\n\necho \"Running database migrations...\\n\\n\";\n\n$db = getDB();\n\n$migrations = [\n    '003_notifications_chat.sql',\n    '004_reports.sql'\n];\n\nforeach ($migrations as $migration) {\n    $file = __DIR__ . '/../database/migrations/' . $migration;\n    if (!file_exists($file)) {\n        echo \"Migration file not found: $migration\\n\";\n        continue;\n    }\n    \n    echo \"Running migration: $migration\\n\";\n    $sql = file_get_contents($file);\n    \n    $statements = array_filter(\n        array_map('trim', explode(';', $sql)),\n        function($stmt) {\n            return !empty($stmt) && !preg_match('/^--/', $stmt);\n        }\n    );\n    \n    foreach ($statements as $statement) {\n        if (empty(trim($statement))) continue;\n        \n        try {\n            $db->exec($statement);\n            echo \"  - Statement executed successfully\\n\";\n        } catch (PDOException $e) {\n            if (strpos($e->getMessage(), 'already exists') !== false) {\n                echo \"  - Table already exists, skipping\\n\";\n            } else {\n                echo \"  - Error: \" . $e->getMessage() . \"\\n\";\n            }\n        }\n    }\n    echo \"\\n\";\n}\n\necho \"Migrations complete!\\n\";\n\necho \"\\nVerifying tables exist:\\n\";\n$tables = ['notifications', 'conversations', 'conversation_messages', 'reports'];\nforeach ($tables as $table) {\n    try {\n        $result = $db->query(\"SHOW TABLES LIKE '$table'\");\n        if ($result->rowCount() > 0) {\n            echo \"  ✓ $table exists\\n\";\n        } else {\n            echo \"  ✗ $table does NOT exist\\n\";\n        }\n    } catch (PDOException $e) {\n        echo \"  ✗ Error checking $table: \" . $e->getMessage() . \"\\n\";\n    }\n}\n","path":null,"size_bytes":1711,"size_tokens":null},"scripts/add_chat_attachments.php":{"content":"<?php\nrequire_once __DIR__ . '/../config/database.php';\n\ntry {\n    $db = getDB();\n    \n    $sql = \"ALTER TABLE conversation_messages \n            ADD COLUMN IF NOT EXISTS attachment_path VARCHAR(255) DEFAULT NULL,\n            ADD COLUMN IF NOT EXISTS attachment_name VARCHAR(255) DEFAULT NULL,\n            ADD COLUMN IF NOT EXISTS attachment_type VARCHAR(100) DEFAULT NULL\";\n    \n    $db->exec($sql);\n    \n    echo \"Successfully added attachment columns to conversation_messages table.\\n\";\n    \n} catch (PDOException $e) {\n    echo \"Error: \" . $e->getMessage() . \"\\n\";\n    exit(1);\n}\n","path":null,"size_bytes":584,"size_tokens":null}},"version":2}